/*! For license information please see 20230623-outreach-88c91510a5be72b1b71d.js.LICENSE.txt */
(globalThis.webpackChunkcare_ops_frontend=globalThis.webpackChunkcare_ops_frontend||[]).push([[585],{2909:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var i=n(7198),s=n(8088),o=n.n(s),r=n(7739),a=n.n(r),l=n(4737),u=n.n(l),h=n(8895);const c=u().extend({initialize(){this.cid=(0,i.uniqueId)("bber")},route(){const t=u().prototype.route.apply(this,arguments);return o().history.handlers[0].cid=this.cid,t},destroy(){return o().history.handlers=(0,i.reject)(o().history.handlers,{cid:this.cid}),this.stopListening(),this.trigger("destroy",this),this},_isTriggeredFromRoute(){const t=this._getCurrentRouteTrigger();return arguments.length===t.length&&arguments.length===(0,i.union)(arguments,t).length}}),d=h.Z.extend({routerAppName:"",constructor:function(){this.initRouter(),this.listenTo(this.router,"noMatch",this.onNoMatch),this.on("before:stop",this.stopCurrent),h.Z.apply(this,arguments)},initRouter(){this._routes=(0,i.result)(this,"eventRoutes");const t=this.getRouteTriggers();this.router=new c({routeTriggers:t}),this.on("before:destroy",(()=>this.router.destroy())),this.bindRouteEvents()},onNoMatch(){this.stop(),this._currentRoute=null},getRouteTriggers(){const t=a().request("bootstrap","currentWorkspace");return(0,i.reduce)(this._routes,(function(e,n,i){let{route:s,root:o}=n;if(o)return e[i]=s,e;const r=t.get("slug");return e[i]=s?`${r}/${s}`:r,e}),{})},getEventActions:(t,e)=>(0,i.reduce)(t,(function(t,n,s){let{action:o}=n;return t[s]=(0,i.partial)(e,s,o),t}),{}),bindRouteEvents(){const t=this.getEventActions(this._routes,this.routeAction);this.listenTo(this.router.getChannel(),t)},routeAction(t,e){this.isRunning()||this.start();for(var n=arguments.length,s=new Array(n>2?n-2:0),o=2;o<n;o++)s[o-2]=arguments[o];this.triggerMethod("before:appRoute",t,...s),a().request("nav","select",this.routerAppName,t,s),a().request("sidebar","close"),this.setLatestList(t,s),this._currentRoute={event:t,eventArgs:s},(0,i.isFunction)(e)||(e=this[e]),e.apply(this,s),this.triggerMethod("appRoute",t,...s)},setLatestList(t,e){this._routes[t].isList?a().request("history","set:latestList",t,e):this._routes[t].clearLatestList&&a().request("history","set:latestList",!1)},startCurrent(t,e){this.stopCurrent(),this._currentAppName=t,this._currentAppOptions=e,e=(0,i.extend)({currentRoute:this._currentRoute},e);const n=this.startChildApp(t,e);return this._current=n,n},startRoute(t,e){return this.isCurrent(t,e)?this.getCurrent().startRoute(this.getCurrentRoute()):this.startCurrent(t,e)},getCurrent(){return this._current},isCurrent(t,e){return t===this._currentAppName&&(0,i.isEqual)(e,this._currentAppOptions)},getCurrentRoute(){return this._currentRoute},stopCurrent(){this._current&&(this._current.stop(),this._current=null,this._currentAppName=null,this._currentAppOptions=null)},translateEvent(t){const e=this.router.getDefaultRoute(t);return this.router.translateRoute(e,(0,i.rest)(arguments))},replaceRoute(){const t=this.translateEvent.apply(this,arguments);this.replaceUrl(t)},navigateRoute(){const t=this.translateEvent.apply(this,arguments);o().history.navigate(t,{trigger:!1})},replaceUrl(t){o().history.navigate(t,{trigger:!1,replace:!0})}})},7885:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var i=n(5291),s=n.n(i),o=n(7198),r=n(7739),a=n.n(r);const l=n(6718).Behavior.extend({ui:{iframe:"iframe"},onInitialize(){this.channel=a().channel(`form${this.view.model.id}`)},replies:{send(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.ui.iframe[0].contentWindow.postMessage({message:t,args:e},window.origin)},focus(){a().trigger("user-activity","iframe:focus",this.ui.iframe[0])}},onAttach(){this.channel.reply(this.replies,this),s()(window).on("message",(t=>{let{originalEvent:e}=t;const{data:n,origin:i}=e;i===window.origin&&n&&n.message&&this.channel.request(n.message,n.args)}))},onBeforeDetach(){s()(window).off("message"),this.channel.stopReplying((0,o.keys)(this.replies).join(" "))}})},6808:(t,e,n)=>{"use strict";n.r(e),n.d(e,{startOutreachApp:()=>I});var i=n(5291),s=n.n(i),o=(n(9306),n(8088)),r=n.n(o),a=(n(4615),n(8380),n(2909)),l=n(8895),u=n(7739),h=n.n(u),c=n(2814),d=n(1766);function p(t,e){return{data:{type:e,id:t}}}let m;h().reply("auth",{setToken(t){m=t},getToken:()=>m});var f=n(9230),g=n.n(f),b=n(6718);const v=b.View.extend({ui:{date:".js-date",submit:".js-submit"},triggers:{"change @ui.date":"change:date","blur @ui.date":"blur:date","click @ui.submit":"click:submit"},modelEvents:{"change:hasError":"render"},template:g().template({1:function(t,e,n,i,s){return" has-error"},3:function(t,e,n,i,s){return'<div class="dialog__error">That date of birth does not match our records. Please try again.</div>'},5:function(t,e,n,i,s){return"disabled"},compiler:[8,">= 4.3.0"],main:function(t,e,n,i,s){var o,r,a=null!=e?e:t.nullContext||{},l=t.hooks.helperMissing,u=t.escapeExpression,h=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n    <div class="dialog__icon">'+u((h(n,"far")||e&&h(e,"far")||l).call(a,"lock-keyhole",{name:"far",hash:{},data:s,loc:{start:{line:2,column:30},end:{line:2,column:52}}}))+'</div>\n    <div>Enter your date of birth to access this form.</div>\n    <div><input type="date" class="js-date dialog__input'+(null!=(o=h(n,"if").call(a,null!=e?h(e,"hasError"):e,{name:"if",hash:{},fn:t.program(1,s,0),inverse:t.noop,data:s,loc:{start:{line:4,column:56},end:{line:4,column:89}}}))?o:"")+'" required pattern="d{4}-d{2}-d{2}" placeholder="Your Date of Birth" value="'+u("function"==typeof(r=null!=(r=h(n,"dob")||(null!=e?h(e,"dob"):e))?r:l)?r.call(a,{name:"dob",hash:{},data:s,loc:{start:{line:4,column:165},end:{line:4,column:174}}}):r)+'"></div>\n    '+(null!=(o=h(n,"if").call(a,null!=e?h(e,"hasError"):e,{name:"if",hash:{},fn:t.program(3,s,0),inverse:t.noop,data:s,loc:{start:{line:5,column:4},end:{line:5,column:124}}}))?o:"")+'\n    <div><button class="button--green dialog__button js-submit" '+(null!=(o=h(n,"unless").call(a,null!=e?h(e,"dob"):e,{name:"unless",hash:{},fn:t.program(5,s,0),inverse:t.noop,data:s,loc:{start:{line:6,column:64},end:{line:6,column:98}}}))?o:"")+">Continue to Form "+u((h(n,"fas")||e&&h(e,"fas")||l).call(a,"right-to-bracket",{name:"fas",hash:{},data:s,loc:{start:{line:6,column:116},end:{line:6,column:142}}}))+"</button></div>\n  "},useData:!0}),onChangeDate(){const t=this.ui.date.val();this.model.set({dob:t}),this.ui.submit.prop("disabled",!t)},onBlurDate(){this.model.set({hasError:!1})}}),_=b.View.extend({template:g().template({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,s){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n    <div class="dialog__icon--success">'+t.escapeExpression((o(n,"fas")||e&&o(e,"fas")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},"circle-check",{name:"fas",hash:{},data:s,loc:{start:{line:2,column:39},end:{line:2,column:61}}}))+"</div>\n    <div>This form has already been submitted.</div>\n  "},useData:!0})}),w=b.View.extend({template:g().template({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,s){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n    <div class="dialog__icon--warn">'+t.escapeExpression((o(n,"far")||e&&o(e,"far")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},"octagon-minus",{name:"far",hash:{},data:s,loc:{start:{line:2,column:36},end:{line:2,column:59}}}))+"</div>\n    <div>This form is no longer shared. Nothing else to do here.</div>\n  "},useData:!0})});var y=n(2182);const x=b.View.extend({template:g().template({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,s){var o,r=null!=e?e:t.nullContext||{},a=t.hooks.helperMissing,l=t.escapeExpression,u=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n    <div><h1 class="site-title">'+l("function"==typeof(o=null!=(o=u(n,"name")||(null!=e?u(e,"name"):e))?o:a)?o.call(r,{name:"name",hash:{},data:s,loc:{start:{line:2,column:32},end:{line:2,column:42}}}):o)+'</h1></div>\n    <div class="dialog" data-content-region>\n      <div class="dialog__icon--success">'+l((u(n,"fas")||e&&u(e,"fas")||a).call(r,"circle-check",{name:"fas",hash:{},data:s,loc:{start:{line:4,column:41},end:{line:4,column:63}}}))+"</div>\n      <div>Youâ€™ve submitted the form. Nice job.</div>\n    </div>\n  "},useData:!0}),templateContext:()=>({name:y.eG.name}),regions:{content:"[data-content-region]"}}),R=b.View.extend({template:g().template({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,s){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n    <div class="dialog__icon--error">'+t.escapeExpression((o(n,"far")||e&&o(e,"far")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},"circle-exclamation",{name:"far",hash:{},data:s,loc:{start:{line:2,column:37},end:{line:2,column:65}}}))+"</div>\n    <div>Uh-oh, there was an error. Try reloading the page.</div>\n  "},useData:!0})}),k=l.Z.extend({onStart(t){let{actionId:e}=t;const n=new x;this.showLogin(e,n.getRegion("content")),this.showView(n)},showLogin(t,e){const n=new v({model:this.getState()});this.listenTo(n,"click:submit",(()=>{(function(t){let{dob:e,actionId:n}=t;const i={type:"patient-tokens",id:(0,d.Z)(),attributes:{reason:"outreach",birth_date:e},relationships:{action:p(n,"patient-actions")}};return(0,c.ZP)("/api/patient-tokens",{method:"POST",data:JSON.stringify({data:i})}).then(c.sx).then((t=>{let{data:{attributes:e}}=t;return h().request("auth","setToken",e.token),Promise.resolve(e.token)}))})({actionId:t,dob:this.getState("dob")}).then((()=>{this.stop({isAuthed:!0})})).catch((t=>{switch(t.status){case 400:this.setState({hasError:!0});break;case 409:e.show(new _);break;case 404:case 403:case 401:e.show(new w);break;default:e.show(new R)}}))})),e.show(n)}});var S=n(7198),C=n(7885);const T=b.View.extend({behaviors:[C.Z],regions:{formAction:"[data-action-region]"},template:g().template({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,s){var o,r=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n  <div class="form__header">\n    <div class="form__title">'+t.escapeExpression("function"==typeof(o=null!=(o=r(n,"name")||(null!=e?r(e,"name"):e))?o:t.hooks.helperMissing)?o.call(null!=e?e:t.nullContext||{},{name:"name",hash:{},data:s,loc:{start:{line:3,column:29},end:{line:3,column:39}}}):o)+'</div>\n    <div data-action-region></div>\n  </div>\n  <div class="form__content">\n    <iframe src="/formapp/"></iframe>\n  </div>\n  '},useData:!0})}),N=b.View.extend({isDisabled:!1,tagName:"button",className:"button--green",attributes(){return{disabled:this.getOption("isDisabled")}},template:g().template({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,s){return"Save"},useData:!0}),triggers:{click:"click"},onClick(){this.$el.prop("disabled",!0)}}),E=l.Z.extend({beforeStart(t){let{actionId:e}=t;return[h().request("entities","fetch:forms:byAction",e),h().request("entities","fetch:forms:definition:byAction",e),h().request("entities","fetch:forms:fields",e)]},onFail(){const t=new x;t.showChildView("content",new R),this.showView(t)},onStart(t,e,n,i){let{actionId:s}=t;this.actionId=s,this.form=e,this.definition=n,this.fields=i,this.setView(new T({model:this.form})),this.startService(),this.showFormSaveDisabled(),this.showView()},startService(){this.channel=h().channel(`form${this.form.id}`),this.channel.reply({"ready:form":this.showFormSave,"submit:form":this.submitForm,"fetch:form:data":this.getFormPrefill},this)},getFormPrefill(){this.channel.request("send","fetch:form:data",{definition:this.definition,formData:(0,S.get)(this.fields,"data.attributes".split("."),{}),formSubmission:{},...this.form.getContext()})},showFormSaveDisabled(){this.form.isReadOnly()||this.showChildView("formAction",new N({isDisabled:!0}))},showFormSave(){if(this.form.isReadOnly())return;const t=this.showChildView("formAction",new N);this.listenTo(t,"click",(()=>{this.channel.request("send","form:submit")}))},submitForm(t){let{response:e}=t;(function(t){let{formId:e,actionId:n,response:i}=t;const s={type:"form-responses",id:(0,d.Z)(),attributes:{response:i},relationships:{action:p(n,"patient-actions"),form:p(e,"forms")}};return(0,c.ZP)(`/api/actions/${n}/relationships/form-responses`,{method:"POST",data:JSON.stringify({data:s})}).then(c.sx)})({formId:this.form.id,actionId:this.actionId,response:e}).then((()=>{this.showView(new x)})).catch((async t=>{const e=await t.json();if(this.showFormSave(),!e)return;const n=(0,S.map)(e.errors,"detail");this.channel.request("send","form:errors",n)}))}}),O=b.View.extend({template:g().template({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,s){var o,r=null!=e?e:t.nullContext||{},a=t.hooks.helperMissing,l=t.escapeExpression,u="function",h=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n    <div class="opt-in__icon opt-in__icon--warn">'+l((h(n,"fat")||e&&h(e,"fat")||a).call(r,"hand-wave",{name:"fat",hash:{},data:s,loc:{start:{line:2,column:49},end:{line:2,column:68}}}))+'</div>\n    <h2 class="opt-in__heading-text">Hi, we need to confirm your contact info. Please enter your information below, so that we can share health resources with you.</h2>\n    <div class="opt-in__field">\n      <label class="opt-in__field-label">Your first name</label>\n      <input\n        type="text"\n        class="input-primary opt-in__field-input js-first-name"\n        placeholder="Enter your first name"\n        value="'+l(typeof(o=null!=(o=h(n,"firstName")||(null!=e?h(e,"firstName"):e))?o:a)===u?o.call(r,{name:"firstName",hash:{},data:s,loc:{start:{line:10,column:15},end:{line:10,column:30}}}):o)+'"\n      />\n    </div>\n    <div class="opt-in__field">\n      <label class="opt-in__field-label">Your last name</label>\n      <input\n        type="text"\n        class="input-primary opt-in__field-input js-last-name"\n        placeholder="Enter your last name"\n        value="'+l(typeof(o=null!=(o=h(n,"lastName")||(null!=e?h(e,"lastName"):e))?o:a)===u?o.call(r,{name:"lastName",hash:{},data:s,loc:{start:{line:19,column:15},end:{line:19,column:29}}}):o)+'"\n      />\n    </div>\n    <div class="opt-in__field">\n      <label class="opt-in__field-label">Your date of birth</label>\n      <input\n        type="date"\n        class="input-primary opt-in__field-input js-dob"\n        placeholder="Enter your date of birth"\n        value="'+l(typeof(o=null!=(o=h(n,"dob")||(null!=e?h(e,"dob"):e))?o:a)===u?o.call(r,{name:"dob",hash:{},data:s,loc:{start:{line:28,column:15},end:{line:28,column:24}}}):o)+'"\n      />\n    </div>\n    <h3 class="opt-in__heading-text u-margin--t-32 u-margin--b-16">How may we share health resources with you?</h3>\n    <div class="opt-in__field">\n      <label class="opt-in__field-label">Your mobile phone number</label>\n      <input\n        type="text"\n        class="input-primary opt-in__field-input js-phone"\n        placeholder="Enter mobile phone number"\n        value="'+l(typeof(o=null!=(o=h(n,"phone")||(null!=e?h(e,"phone"):e))?o:a)===u?o.call(r,{name:"phone",hash:{},data:s,loc:{start:{line:38,column:15},end:{line:38,column:26}}}):o)+'"\n      />\n    </div>\n    <div class="opt-in__field">\n      <label class="opt-in__field-label">Your email address</label>\n      <input\n        type="text"\n        class="input-primary opt-in__field-input js-email"\n        placeholder="Enter email address"\n        value="'+l(typeof(o=null!=(o=h(n,"email")||(null!=e?h(e,"email"):e))?o:a)===u?o.call(r,{name:"email",hash:{},data:s,loc:{start:{line:47,column:15},end:{line:47,column:26}}}):o)+'"\n      />\n    </div>\n    <p class="opt-in__disclaimer">By clicking Submit you agree to receive SMS text message notifications. You may opt out at any time.</p>\n    <button class="opt-in__submit button--green w-100 js-submit" disabled>Submit</button>\n  '},useData:!0}),ui:{firstName:".js-first-name",lastName:".js-last-name",dob:".js-dob",phone:".js-phone",email:".js-email",submit:".js-submit"},triggers:{"input @ui.firstName":"change:first:name","input @ui.lastName":"change:last:name","input @ui.dob":"change:dob","input @ui.phone":"change:phone","input @ui.email":"change:email","click @ui.submit":"click:submit"},onRender(){this.setSubmitButtonState()},onChangeFirstName(){this.model.set({firstName:this.ui.firstName.val()}),this.setSubmitButtonState()},onChangeLastName(){this.model.set({lastName:this.ui.lastName.val()}),this.setSubmitButtonState()},onChangeDob(){this.model.set({dob:this.ui.dob.val()}),this.setSubmitButtonState()},onChangePhone(){this.model.set({phone:this.ui.phone.val()}),this.setSubmitButtonState()},onChangeEmail(){this.model.set({email:this.ui.email.val()}),this.setSubmitButtonState()},disableSubmitButton(){this.ui.submit.prop("disabled",!0)},enableSubmitButton(){this.ui.submit.prop("disabled",!1)},setSubmitButtonState(){const t=this.ui.firstName.val(),e=this.ui.lastName.val(),n=this.ui.dob.val(),i=this.ui.phone.val(),s=this.ui.email.val();t&&e&&n&&(i||s)?this.enableSubmitButton():this.disableSubmitButton()},onClickSubmit(){this.disableSubmitButton()}}),A=b.View.extend({template:g().template({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,s){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n    <div class="opt-in__icon opt-in__icon--success">'+t.escapeExpression((o(n,"fat")||e&&o(e,"fat")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},"thumbs-up",{name:"fat",hash:{},data:s,loc:{start:{line:2,column:52},end:{line:2,column:71}}}))+'</div>\n    <div class="opt-in__heading-text">Your contact info is confirmed. Thanks for doing that. Weâ€™ll notify you when we have a health resource to share with you.</div>\n  '},useData:!0})}),P=b.View.extend({template:g().template({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,s){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n    <div class="opt-in__icon opt-in__icon--error">'+t.escapeExpression((o(n,"fat")||e&&o(e,"fat")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},"octagon-exclamation",{name:"fat",hash:{},data:s,loc:{start:{line:2,column:50},end:{line:2,column:79}}}))+'</div>\n    <div class="opt-in__heading-text">We were not able to confirm your contact info. Sorry about that. Please contact your care team.</div>\n    <div class="opt-in__heading-text u-text-link js-try-again">Try again</div>\n  '},useData:!0}),triggers:{"click .js-try-again":"click:tryAgain"}}),j=r().Model.extend({defaults:{firstName:"",lastName:"",dob:"",phone:"",email:""}}),V=l.Z.extend({StateModel:j,onStart(){const t=new x;this.showView(t),this.showOptInView()},showOptInView(){const t=new O({model:this.getState()});this.listenTo(t,"click:submit",(()=>{(function(t){let{inputData:e}=t;const n={first_name:e.get("firstName"),last_name:e.get("lastName"),birth_date:e.get("dob"),phone:e.get("phone"),email:e.get("email")};return(0,c.ZP)("/api/outreach/opt-in",{method:"POST",data:JSON.stringify({data:n})}).then(c.sx)})({inputData:this.getState()}).then((()=>{this.showResponseSuccessView()})).catch((()=>{this.showResponseErrorView()}))})),this.showChildView("content",t)},showResponseSuccessView(){const t=new A;this.showChildView("content",t)},showResponseErrorView(){const t=new P;this.listenTo(t,"click:tryAgain",(()=>{this.showOptInView()})),this.showChildView("content",t)}}),D=a.Z.extend({childApps:{login:k,form:E,optIn:V},routerAppName:"PatientsApp",eventRoutes:{outreach:{action:"show",route:"outreach/:id",root:!0},"outreach:opt:in":{action:"showOptIn",route:"outreach/opt-in",root:!0}},showOptIn(){this.startCurrent("optIn")},show(t){this.actionId=t,this.startLogin()},startLogin(){const t=this.startCurrent("login",{actionId:this.actionId});this.listenTo(t,"stop",(()=>{this.startForm()}))},startForm(){this.startCurrent("form",{actionId:this.actionId})}});function I(){s()("meta[name=viewport]").attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0"),new D({region:{el:document.getElementById("root")}}),r().history.start({pushState:!0})}},4737:function(t,e,n){t.exports=function(t,e,n){"use strict";t="default"in t?t.default:t,e="default"in e?e.default:e;var i=/(\(\?)?:\w+/,s=e.EventRouter=e.Router.extend({constructor:function(n){t.extend(this,t.pick(n,["channelName","routeTriggers"])),this._ch=e.Radio.channel(t.result(this,"channelName")),this.listenTo(this._ch,"all",this.navigateFromEvent),e.Router.apply(this,arguments),this._initRoutes()},channelName:"event-router",getChannel:function(){return this._ch},_initRoutes:function(){this._routeTriggers=t.result(this,"routeTriggers",{}),t.each(this._routeTriggers,this._addRouteTrigger,this)},_addRouteTrigger:function(e,n){e=t.isArray(e)?e:[e],t.each(e,(function(e){this.route(e,n,t.bind(this._ch.trigger,this._ch,n))}),this)},addRouteTrigger:function(t,e){return this._routeTriggers[e]=t,this._addRouteTrigger(t,e),this},route:function(n,i,s){var o=e.Router.prototype.route;if(t.isFunction(i)||!s)return o.call(this,n,i,s);var r=t.bind((function(){var e=t.drop(arguments,0);this.trigger("before:route",i,e),this.trigger.apply(this,["before:route:"+i].concat(e)),this._storeRouteTrigger([i].concat(e)),s.apply(this,e),this._clearRouteTrigger()}),this);return o.call(this,n,i,r)},_storeRouteTrigger:function(t){this._routeArgs=this._routeArgs||[],this._routeArgs.push(t)},_getCurrentRouteTrigger:function(){return t.last(this._routeArgs)||[]},_clearRouteTrigger:function(){this._routeArgs.pop()},_isTriggeredFromRoute:function(){var e=this._getCurrentRouteTrigger();return arguments.length===e.length&&arguments.length===t.union(arguments,this.currentRoute).length},navigateFromEvent:function(e){var n=this.getDefaultRoute(e);if(!n){var i=t.drop(arguments,0);return this.trigger.apply(this,["noMatch"].concat(i)),this}if(this._isTriggeredFromRoute.apply(this,arguments))return this;var s=t.drop(arguments,1),o=this.translateRoute(n,s);return this.navigate(o,{trigger:!1})},getDefaultRoute:function(e){var n=this._routeTriggers[e];return t.isArray(n)?n[0]:n},_replaceParam:function(t,e){return t.replace(i,e)},translateRoute:function(e,n){return t.reduce(n,this._replaceParam,e)}});return s}(n(7198),n(8088),n(7739))}}]);