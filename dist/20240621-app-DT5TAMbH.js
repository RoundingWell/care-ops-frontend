const __vite__fileDeps=["20240621-app-frame_app-JglqrLX1.js","20240621-index-fHu2ca4c.js","20240621-runtime-zr3RRXyd.js","20240621-app-BRZg-08o.js","20240621-parsePhoneNumber-x3EBWm_C.js","assets/app-B79XuN-N.css","20240621-index-DMzP-kuW.js","20240621-workspaces-ziQERb0A.js","20240621-prelogin_views-D7swlbm2.js","assets/prelogin_views-D_NB3Jdp.css","assets/loader-CdTtOIxO.css","20240621-iframe-form-CExI3WLb.js","assets/iframe-form-Dt2lfO_2.css","assets/app-frame_app-B8bIgcXd.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{t as times,j as flatten,m as map$1,k as range,e as extend,l as result,n as every,o as throttle,s as some,p as isArray,b as bind$2,q as noop,w as pick,d as debounce,g as each$8,x as size,y as delay,z as omit,A as commonjsGlobal,B as getDefaultExportFromCjs,C as getRootRoute,D as get,E as invoke,F as compact,G as reject,H as contains,f as versions,I as partial,a as appConfig,_ as __vitePreload,c as addError}from"./20240621-index-fHu2ca4c.js";import{C as Component,b as buildMatcher,w as words,A as App}from"./20240621-app-BRZg-08o.js";import{i as intl}from"./20240621-index-DMzP-kuW.js";import{V as View,a as Region,_ as _Handlebars2,C as CollectionView,B as Backbone,b as Behavior,R as Radio,$}from"./20240621-runtime-zr3RRXyd.js";import{a as anime,P as PreloadRegion,b as PreloaderView}from"./20240621-prelogin_views-D7swlbm2.js";import{d as dayjs}from"./20240621-parsePhoneNumber-x3EBWm_C.js";import{k as keyCodes,I as IframeFormBehavior,R as RouterApp}from"./20240621-iframe-form-CExI3WLb.js";import{F as FORM_RESPONSE_STATUS}from"./20240621-workspaces-ziQERb0A.js";function initPlatform(){const e=document.documentElement;e.setAttribute("data-useragent",navigator.userAgent),e.setAttribute("data-platform",navigator.platform)}const LayoutView=View.extend({className:"datepicker",regionClass:Region.extend({replaceElement:!0}),regions:{calendar:"[data-calendar-region]",monthPicker:"[data-month-picker-region]",actions:"[data-actions-region]"},template:_Handlebars2.template({1:function(e,t,i,r,o){var n=e.lookupProperty||function(s,l){if(Object.prototype.hasOwnProperty.call(s,l))return s[l]};return'<div class="datepicker__day">'+e.escapeExpression((n(i,"formatDateTime")||t&&n(t,"formatDateTime")||e.hooks.helperMissing).call(t??(e.nullContext||{}),t,"dd",{name:"formatDateTime",hash:{},data:o,loc:{start:{line:4,column:54},end:{line:4,column:82}}}))+"</div>"},compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return`
    <div data-month-picker-region></div>
    <div class="datepicker__body">
      `+((n=s(i,"each").call(t??(e.nullContext||{}),t!=null?s(t,"dayOfWeek"):t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:4,column:6},end:{line:4,column:97}}}))!=null?n:"")+`
      <div data-calendar-region></div>
    </div>
    <div data-actions-region></div>
  `},useData:!0}),templateContext(){return{dayOfWeek:times(7,t=>dayjs().weekday(t))}}}),ActionsView=View.extend({template:_Handlebars2.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s,l=e.lambda,a=e.escapeExpression,c=t??(e.nullContext||{}),h=e.hooks.helperMissing,u="function",d=e.lookupProperty||function(g,m){if(Object.prototype.hasOwnProperty.call(g,m))return g[m]};return`
    <button class="datepicker__button js-today">`+a(l((n=(n=(n=o&&d(o,"intl"))&&d(n,"components"))&&d(n,"datepicker"))&&d(n,"today"),t))+"</button>"+a((s=(s=d(i,"remove_whitespace")||(t!=null?d(t,"remove_whitespace"):t))!=null?s:h,typeof s===u?s.call(c,{name:"remove_whitespace",hash:{},data:o,loc:{start:{line:2,column:96},end:{line:2,column:121}}}):s))+'<button class="datepicker__button js-tomorrow">'+a(l((n=(n=(n=o&&d(o,"intl"))&&d(n,"components"))&&d(n,"datepicker"))&&d(n,"tomorrow"),t))+"</button>"+a((s=(s=d(i,"remove_whitespace")||(t!=null?d(t,"remove_whitespace"):t))!=null?s:h,typeof s===u?s.call(c,{name:"remove_whitespace",hash:{},data:o,loc:{start:{line:3,column:102},end:{line:3,column:127}}}):s))+'<button class="datepicker__button js-clear">'+a(l((n=(n=(n=o&&d(o,"intl"))&&d(n,"components"))&&d(n,"datepicker"))&&d(n,"clear"),t))+`</button>
  `},useData:!0}),triggers:{"click .js-today":"click:today","click .js-tomorrow":"click:tomorrow","click .js-clear":"click:clear"}}),MonthPickerView=View.extend({className:"datepicker__header",triggers:{"click .js-next":"click:nextMonth","click .js-prev":"click:prevMonth","click .js-month":"click:month"},template:_Handlebars2.template({1:function(e,t,i,r,o){return'class="datepicker__month js-month"'},compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s=t??(e.nullContext||{}),l=e.hooks.helperMissing,a=e.escapeExpression,c=e.lookupProperty||function(h,u){if(Object.prototype.hasOwnProperty.call(h,u))return h[u]};return`
    <div class="datepicker__nav flex">
      <button class="js-prev">`+a((c(i,"fas")||t&&c(t,"fas")||l).call(s,"caret-left",{name:"fas",hash:{},data:o,loc:{start:{line:3,column:30},end:{line:3,column:50}}}))+" "+a((c(i,"formatDateTime")||t&&c(t,"formatDateTime")||l).call(s,t!=null?c(t,"prevMonth"):t,"MMM",{name:"formatDateTime",hash:{},data:o,loc:{start:{line:3,column:51},end:{line:3,column:85}}}))+`</button>
      <span `+((n=c(i,"if").call(s,t!=null?c(t,"canSelectMonth"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:4,column:12},end:{line:4,column:75}}}))!=null?n:"")+">"+a((c(i,"formatDateTime")||t&&c(t,"formatDateTime")||l).call(s,t!=null?c(t,"currentMonth"):t,"MMM YYYY",{name:"formatDateTime",hash:{},data:o,loc:{start:{line:4,column:76},end:{line:4,column:118}}}))+`</span>
      <button class="js-next">`+a((c(i,"formatDateTime")||t&&c(t,"formatDateTime")||l).call(s,t!=null?c(t,"nextMonth"):t,"MMM",{name:"formatDateTime",hash:{},data:o,loc:{start:{line:5,column:30},end:{line:5,column:64}}}))+" "+a((c(i,"fas")||t&&c(t,"fas")||l).call(s,"caret-right",{name:"fas",hash:{},data:o,loc:{start:{line:5,column:65},end:{line:5,column:86}}}))+`</button>
    </div>
  `},useData:!0}),templateContext(){return{nextMonth:this.model.getNextMonth(),prevMonth:this.model.getPrevMonth(),canSelectMonth:this.getOption("canSelectMonth")}}}),CellView=View.extend({className(){if(this.model.get("isOtherMonth"))return"is-other-month";if(this.model.get("isDisabled"))return"is-disabled"},tagName:"li",getTemplate(){return this.model.get("isOtherMonth")||this.model.get("isDisabled")?_Handlebars2.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return e.escapeExpression((n=(n=s(i,"date")||(t!=null?s(t,"date"):t))!=null?n:e.hooks.helperMissing,typeof n=="function"?n.call(t??(e.nullContext||{}),{name:"date",hash:{},data:o,loc:{start:{line:1,column:0},end:{line:1,column:10}}}):n))},useData:!0}):_Handlebars2.template({1:function(e,t,i,r,o){return"is-selected"},3:function(e,t,i,r,o){return" is-today"},compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s,l=t??(e.nullContext||{}),a=e.lookupProperty||function(c,h){if(Object.prototype.hasOwnProperty.call(c,h))return c[h]};return'<a class="'+((n=a(i,"if").call(l,t!=null?a(t,"isSelected"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:10},end:{line:1,column:46}}}))!=null?n:"")+((n=a(i,"if").call(l,t!=null?a(t,"isToday"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:46},end:{line:1,column:77}}}))!=null?n:"")+'">'+e.escapeExpression((s=(s=a(i,"date")||(t!=null?a(t,"date"):t))!=null?s:e.hooks.helperMissing,typeof s=="function"?s.call(l,{name:"date",hash:{},data:o,loc:{start:{line:1,column:79},end:{line:1,column:89}}}):s))+"</a>"},useData:!0})},triggers:{"click a":"select"}}),CalendarView=CollectionView.extend({className:"datepicker__days",tagName:"ul",childView:CellView,childViewTriggers:{select:"select:date"}}),StateModel$1=Backbone.Model.extend({initialize({currentMonth:e,selectedDate:t,selectedMonth:i}){this.setCurrentMonth(e),this.setSelectedDate(t),this.setSelectedMonth(i)},setCurrentMonth(e){const t=e?dayjs(e):dayjs();this.set("currentMonth",t.startOf("month"))},setSelectedDate(e){if(!e){this.set({selectedDate:null});return}e=dayjs(e),this.set({selectedDate:e.startOf("day"),currentMonth:e.startOf("month"),selectedMonth:null})},setSelectedMonth(e){if(!e){this.set({selectedMonth:null});return}const t=dayjs(e).startOf("month");this.set({selectedMonth:t,currentMonth:t,selectedDate:null})},getCurrentMonth(){return this.dayjs("currentMonth")},getNextMonth(){return this.dayjs("currentMonth").add(1,"months")},getPrevMonth(){return this.dayjs("currentMonth").subtract(1,"months")},getCalendar(){const e=flatten([this._getPreDates(),this._getDates(),this._getPostDates()]);return new Backbone.Collection(e)},_getPreDates(){const e=this.getCurrentMonth().weekday();if(!e)return[];const t=this.getPrevMonth().daysInMonth();return map$1(range(t-(e-1),t+1),i=>({date:String(i),isOtherMonth:!0}))},_getPostDates(){const e=this.getCurrentMonth().endOf("month").weekday();return e===6?[]:map$1(range(1,7-e),t=>({date:String(t),isOtherMonth:!0}))},_getDates(){const e=this.getCurrentMonth(),t=e.isSame(dayjs(),"month")&&dayjs().date();return map$1(range(1,e.daysInMonth()+1),i=>{const r=this._isBeforeBeginDate(i)||this._isAfterEndDate(i);return{date:String(i),isDisabled:r,isSelected:!r&&this._isSelectedDate(i),isToday:t===i}})},_isBeforeBeginDate(e){const t=this.dayjs("beginDate");return t?this.getCurrentMonth().date(e).isBefore(t,"day"):!1},_isAfterEndDate(e){const t=this.dayjs("endDate");return t?this.getCurrentMonth().date(e).isAfter(t,"day"):!1},_isSelectedDate(e){const t=this.dayjs("selectedDate");return!t||!this.getCurrentMonth().isSame(t,"month")?!1:t.date()===e}}),CLASS_OPTIONS$4=["position","uiView","ui"],Datepicker=Component.extend({StateModel:StateModel$1,stateEvents:{change:"show","change:selectedDate":"onChangeStateSelectedDate","change:selectedMonth":"onChangeStateSelectedMonth"},onChangeStateSelectedDate(e,t){this.triggerMethod("change:selectedDate",t)},onChangeStateSelectedMonth(e,t){this.triggerMethod("change:selectedMonth",t)},constructor:function(e){this.mergeOptions(e,CLASS_OPTIONS$4),this.listenTo(this.uiView,"render destroy",this.destroy),Component.apply(this,arguments)},ViewClass:LayoutView,onSelectToday(){this.getState().setSelectedDate(dayjs())},onSelectTomorrow(){this.getState().setSelectedDate(dayjs().add(1,"days"))},onSelectClear(){const e=this.getState();e.setSelectedDate(null),e.setSelectedMonth(null)},onBeforeShow(e,t){t.showChildView("monthPicker",this.getMonthPickerView()),t.showChildView("actions",this.getActionsView()),t.showChildView("calendar",this.getCalendarView())},getMonthPickerView(){const e=this.getState(),t=new MonthPickerView({model:e,canSelectMonth:this.getOption("canSelectMonth")});return this.listenTo(t,{"click:nextMonth":this.onSelectNextMonth,"click:prevMonth":this.onSelectPrevMonth,"click:month":this.onSelectMonth}),t},getActionsView(){const e=new ActionsView;return this.listenTo(e,{"click:today":this.onSelectToday,"click:tomorrow":this.onSelectTomorrow,"click:clear":this.onSelectClear}),e},onSelectNextMonth(){const e=this.getState();e.setCurrentMonth(e.getNextMonth())},onSelectPrevMonth(){const e=this.getState();e.setCurrentMonth(e.getPrevMonth())},onSelectMonth(){const e=this.getState();e.setSelectedMonth(e.getCurrentMonth())},onSelectDate({model:e}){const t=this.getState(),i=e.get("date"),r=this.getState().getCurrentMonth();t.setSelectedDate(r.date(i))},getCalendarView(){const e=this.getState(),t=new CalendarView({model:e,collection:e.getCalendar()});return this.listenTo(t,{"select:date":this.onSelectDate}),t},position(){return this.uiView.getBounds(this.ui)},regionOptions(){return extend({popWidth:256},result(this,"position"))}}),hasAllText=(e,t)=>e?every(words(t),i=>{const r=buildMatcher(i);return!!String(e).match(r)}):!1,InputFocusBehavior=Behavior.extend({selector:"input",ui(){return{input:this.getOption("selector")}},onDomRefresh(){const e=this.ui.input[0];!e||!e.style||(e.style.transform="TranslateY(-10000px)",e.focus(),setTimeout(function(){!e||!e.style||(e.style.transform="none")},30))}}),{ENTER_KEY:ENTER_KEY$1}=keyCodes,InputWatcherBehavior=Behavior.extend({events:{"keydown @ui.input":"watchKeyDown","keyup @ui.input":"watchKeyUp","input @ui.input":"watchInput"},ui:{input:"input"},onDomRefresh(){this._currentText=this.getWatchText()},getWatchText(){return this.ui.input.val()},watchKeyDown(e){this.view.triggerMethod("watch:keydown",e),this._evt=e},watchInput(){this._evt&&(this._evt.isDefaultPrevented()||this.watchKeyUp(this._evt))},watchKeyUp:throttle(function(e){if(this.view.isRendered()){if(e.which===ENTER_KEY$1){e.preventDefault();return}this.view.triggerMethod("watch:keyup",e),this.triggerWatchChange()}},1),triggerWatchChange(){const e=this.getWatchText();e!==this._currentText&&(this._currentText=e,this.view.triggerMethod("watch:change",e))}}),KeyListenerBehavior=Behavior.extend({initialize(){this.listenTo(Radio.channel("user-activity"),"document:keydown",this.keydown)},keyEvents:{},triggerEvent(e,t,i){if(t.which===i)return this.view.triggerMethod(e,t),!0},keydown(e){some(this.getOption("keyEvents"),(t,i)=>{if(!isArray(t)){this.triggerEvent(i,e,t);return}return some(t,bind$2(this.triggerEvent,this,i,e))})}}),{ENTER_KEY,ESCAPE_KEY,DOWN_KEY,TAB_KEY,UP_KEY}=keyCodes,PicklistBehavior=Behavior.extend({behaviors:[{behaviorClass:KeyListenerBehavior,keyEvents:{"transport:down":DOWN_KEY,"transport:up":UP_KEY,select:ENTER_KEY,close:[ESCAPE_KEY,TAB_KEY]}}],options:{items:".js-picklist-item",scroll:".js-picklist-scroll"},events(){const e={};return e[`mouseenter ${this.getOption("items")}`]=this.onHoverItem,e},onAttach(){const e=this.getItems();this.scrollTo(e,e.filter(".is-selected"),"middle")},onHoverItem(e){this.updateTransport(this.getItems(),this.view.$(e.currentTarget))},onTransportDown(e){e.preventDefault();const t=this.getItems(),i=this._getNextHighlighted(t);this.updateTransport(t,i),this.scrollTo(t)},onTransportUp(e){e.preventDefault();const t=this.getItems(),i=this._getPrevHighlighted(t);this.updateTransport(t,i),this.scrollTo(t)},getItems(){return this.view.$(this.getOption("items"))},getHighlighted(e){return e.filter(".is-highlighted")},updateTransport(e,t){e.removeClass("is-highlighted"),t.addClass("is-highlighted")},_getPrevHighlighted(e){const t=this.getHighlighted(e);if(!t.length)return e.last();const i=e.index(t)-1;return i<0?t:e.eq(i)},_getNextHighlighted(e){const t=this.getHighlighted(e);if(!t.length)return e.first();const i=e.index(t)+1;return i===e.length?t:e.eq(i)},scrollTo(e,t,i){if(!e.length||((!t||!t.length)&&(t=this.getHighlighted(e)),!t.length))return;const r=this.view.$(this.getOption("scroll")),o=r.scrollTop(),n=r.outerHeight(),s=t.outerHeight(),l=t.position().top,a=l+s-n;let c=0;i==="middle"&&(c=n/2-s/2),l<0&&r.scrollTop(o+l+c),a>0&&r.scrollTop(o+a+c)},onSelect(e){e.preventDefault(),this.view.$(".is-highlighted").click()}}),CLASS_OPTIONS$3=["attr","canClear","childView","childViewEventPrefix","className","clearText","emptyView","emptyViewOptions","headingText","infoText","isSelectlist","lists","noResultsText","placeholderText","template"],CLASS_OPTIONS_ITEM=["attr","getItemSearchText","isCheckable","itemClassName","itemTemplate","itemTemplateContext"],attr$1="text",canClear=!1,isSelectList=!1,PicklistEmpty=View.extend({tagName:"li",className:"picklist--no-results",template:_Handlebars2.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return e.escapeExpression((n=(n=s(i,"noResultsText")||(t!=null?s(t,"noResultsText"):t))!=null?n:e.hooks.helperMissing,typeof n=="function"?n.call(t??(e.nullContext||{}),{name:"noResultsText",hash:{},data:o,loc:{start:{line:1,column:0},end:{line:1,column:19}}}):n))},useData:!0}),serializeData(){return this.options}}),PicklistItem=View.extend({tagName:"li",itemTemplate:_Handlebars2.template({1:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return e.escapeExpression((s(i,"fa")||t&&s(t,"fa")||e.hooks.helperMissing).call(t??(e.nullContext||{}),(n=t!=null?s(t,"icon"):t)!=null?s(n,"type"):n,(n=t!=null?s(t,"icon"):t)!=null?s(n,"icon"):n,{name:"fa",hash:{classes:(n=t!=null?s(t,"icon"):t)!=null?s(n,"classes"):n},data:o,loc:{start:{line:2,column:39},end:{line:2,column:86}}}))},3:function(e,t,i,r,o){var n=e.lookupProperty||function(s,l){if(Object.prototype.hasOwnProperty.call(s,l))return s[l]};return e.escapeExpression((n(i,"fas")||t&&n(t,"fas")||e.hooks.helperMissing).call(t??(e.nullContext||{}),"check",{name:"fas",hash:{classes:"u-icon--12 u-margin--l-16"},data:o,loc:{start:{line:3,column:21},end:{line:3,column:72}}}))},compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s=t??(e.nullContext||{}),l=e.lookupProperty||function(a,c){if(Object.prototype.hasOwnProperty.call(a,c))return a[c]};return`
    <div class="flex-grow">`+((n=l(i,"if").call(s,t!=null?l(t,"icon"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:2,column:27},end:{line:2,column:93}}}))!=null?n:"")+"<span>"+e.escapeExpression((l(i,"matchText")||t&&l(t,"matchText")||e.hooks.helperMissing).call(s,t!=null?l(t,"text"):t,t!=null?l(t,"query"):t,{name:"matchText",hash:{},data:o,loc:{start:{line:2,column:99},end:{line:2,column:123}}}))+`</span></div>
    `+((n=l(i,"if").call(s,t!=null?l(t,"isChecked"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:3,column:4},end:{line:3,column:79}}}))!=null?n:"")+`
  `},useData:!0}),itemClassName(){const e=[];return this.model.get("isDisabled")&&e.push("is-disabled"),this.model.get("hasDivider")&&e.push("has-divider"),e.join(" ")},className(){const e=["picklist__item","js-picklist-item",result(this,"itemClassName","")];return this.model===this.state.get("selected")&&e.push("is-selected"),e.join(" ")},triggers:{click:"select"},preinitialize(e){this.mergeOptions(e,["state",...CLASS_OPTIONS_ITEM])},onRender(){this.searchText=this.getItemSearchText(this.model)},getItemSearchText(e){return this.$el.text()},itemTemplateContext:noop,templateContext(){const e=this.getOption("isCheckable"),t=this.model===this.state.get("selected");return extend({text:this.model.get(this.attr),query:this.state.get("query"),isChecked:e&&t},result(this,"itemTemplateContext"))},getTemplate(){return this.itemTemplate}}),Picklist=CollectionView.extend({className:"picklist__group",tagName:"li",template:_Handlebars2.template({1:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return'<div class="picklist__heading">'+e.escapeExpression((n=(n=s(i,"headingText")||(t!=null?s(t,"headingText"):t))!=null?n:e.hooks.helperMissing,typeof n=="function"?n.call(t??(e.nullContext||{}),{name:"headingText",hash:{},data:o,loc:{start:{line:2,column:54},end:{line:2,column:71}}}):n))+"</div>"},3:function(e,t,i,r,o){var n,s=t??(e.nullContext||{}),l=e.hooks.helperMissing,a=e.escapeExpression,c=e.lookupProperty||function(h,u){if(Object.prototype.hasOwnProperty.call(h,u))return h[u]};return'<div class="picklist__info">'+a((c(i,"fas")||t&&c(t,"fas")||l).call(s,"circle-info",{name:"fas",hash:{},data:o,loc:{start:{line:4,column:48},end:{line:4,column:69}}}))+a((n=(n=c(i,"infoText")||(t!=null?c(t,"infoText"):t))!=null?n:l,typeof n=="function"?n.call(s,{name:"infoText",hash:{},data:o,loc:{start:{line:4,column:69},end:{line:4,column:83}}}):n))+"</div>"},compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s=t??(e.nullContext||{}),l=e.lookupProperty||function(a,c){if(Object.prototype.hasOwnProperty.call(a,c))return a[c]};return`
    `+((n=l(i,"if").call(s,t!=null?l(t,"headingText"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:2,column:4},end:{line:2,column:84}}}))!=null?n:"")+`
    <ul></ul>
    `+((n=l(i,"if").call(s,t!=null?l(t,"infoText"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:4,column:4},end:{line:4,column:96}}}))!=null?n:"")+`
  `},useData:!0}),serializeCollection:noop,childViewContainer:"ul",childViewEventPrefix:"item",modelEvents:{"change:query":"filter"},viewFilter(e){e.render();const t=this.model.get("query");return!t||!e.searchText||hasAllText(e.searchText,t)},initialize(e){this.mergeOptions(e,CLASS_OPTIONS_ITEM)},childViewOptions(){const e=pick(this,...CLASS_OPTIONS_ITEM);return extend({state:this.model},e)},templateContext(){return{headingText:this.getOption("headingText"),infoText:this.getOption("infoText")}}}),Picklists=CollectionView.extend({behaviors:[{behaviorClass:InputFocusBehavior,selector:".js-input"},InputWatcherBehavior,PicklistBehavior],template:_Handlebars2.template({1:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return'<div class="picklist__heading u-margin--b-8">'+e.escapeExpression((n=(n=s(i,"headingText")||(t!=null?s(t,"headingText"):t))!=null?n:e.hooks.helperMissing,typeof n=="function"?n.call(t??(e.nullContext||{}),{name:"headingText",hash:{},data:o,loc:{start:{line:3,column:70},end:{line:3,column:87}}}):n))+"</div>"},3:function(e,t,i,r,o){var n,s=t??(e.nullContext||{}),l=e.hooks.helperMissing,a="function",c=e.escapeExpression,h=e.lookupProperty||function(u,d){if(Object.prototype.hasOwnProperty.call(u,d))return u[d]};return'<input type="text" class="js-input picklist__input input-primary--small" placeholder="'+c((n=(n=h(i,"placeholderText")||(t!=null?h(t,"placeholderText"):t))!=null?n:l,typeof n===a?n.call(s,{name:"placeholderText",hash:{},data:o,loc:{start:{line:4,column:112},end:{line:4,column:133}}}):n))+'" value="'+c((n=(n=h(i,"query")||(t!=null?h(t,"query"):t))!=null?n:l,typeof n===a?n.call(s,{name:"query",hash:{},data:o,loc:{start:{line:4,column:142},end:{line:4,column:153}}}):n))+'">'},5:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return'<div><a class="picklist__item js-picklist-item js-clear">'+e.escapeExpression((n=(n=s(i,"clearText")||(t!=null?s(t,"clearText"):t))!=null?n:e.hooks.helperMissing,typeof n=="function"?n.call(t??(e.nullContext||{}),{name:"clearText",hash:{},data:o,loc:{start:{line:5,column:79},end:{line:5,column:94}}}):n))+"</a></div>"},7:function(e,t,i,r,o){var n,s=t??(e.nullContext||{}),l=e.hooks.helperMissing,a=e.escapeExpression,c=e.lookupProperty||function(h,u){if(Object.prototype.hasOwnProperty.call(h,u))return h[u]};return'<div class="picklist__info ">'+a((c(i,"fas")||t&&c(t,"fas")||l).call(s,"circle-info",{name:"fas",hash:{},data:o,loc:{start:{line:8,column:49},end:{line:8,column:70}}}))+a((n=(n=c(i,"infoText")||(t!=null?c(t,"infoText"):t))!=null?n:l,typeof n=="function"?n.call(s,{name:"infoText",hash:{},data:o,loc:{start:{line:8,column:70},end:{line:8,column:84}}}):n))+"</div>"},compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s=t??(e.nullContext||{}),l=e.lookupProperty||function(a,c){if(Object.prototype.hasOwnProperty.call(a,c))return a[c]};return`
    <div>
      `+((n=l(i,"if").call(s,t!=null?l(t,"headingText"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:3,column:6},end:{line:3,column:100}}}))!=null?n:"")+`
      `+((n=l(i,"if").call(s,t!=null?l(t,"isSelectlist"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:4,column:6},end:{line:4,column:162}}}))!=null?n:"")+`
      `+((n=l(i,"if").call(s,t!=null?l(t,"canClear"):t,{name:"if",hash:{},fn:e.program(5,o,0),inverse:e.noop,data:o,loc:{start:{line:5,column:6},end:{line:5,column:111}}}))!=null?n:"")+`
    </div>
    <ul class="flex-region picklist__scroll js-picklist-scroll"></ul>
    `+((n=l(i,"if").call(s,t!=null?l(t,"infoText"):t,{name:"if",hash:{},fn:e.program(7,o,0),inverse:e.noop,data:o,loc:{start:{line:8,column:4},end:{line:8,column:97}}}))!=null?n:"")+`
  `},useData:!0}),triggers:{"focus @ui.input":"focus","click @ui.clear":"clear"},ui:{input:".js-input",clear:".js-clear"},onClear(){this.triggerMethod("picklist:item:select",{model:null})},serializeCollection:noop,childViewContainer:"ul",emptyView:PicklistEmpty,initialize(e){this.mergeOptions(e,CLASS_OPTIONS$3),this.mergeOptions(e,CLASS_OPTIONS_ITEM),this.debouncedFilter=debounce(this.filter,1),each$8(this.lists,this.addList,this)},addList(e){const t=extend({model:this.model,childView:this.childView},pick(this,...CLASS_OPTIONS_ITEM),e),i=new Picklist(t);i.render(),this.addChildView(i)},viewFilter(e){return!!size(e.children)||e.shouldShow},childViewEvents:{"before:render:children"(){return this.debouncedFilter()}},onRenderChildren(){this.$(".js-picklist-item").removeClass("is-highlighted"),this.model.get("query")&&this.$(".js-picklist-item").first().addClass("is-highlighted")},emptyViewOptions(){return{noResultsText:this.noResultsText}},templateContext(){return{canClear:this.canClear,clearText:this.clearText,headingText:this.headingText,infoText:this.infoText,placeholderText:this.placeholderText,isSelectlist:this.isSelectlist}}}),Picklist$1=Component.extend({attr:attr$1,canClear,isSelectList,childView:PicklistItem,className:"picklist",childViewEventPrefix:"picklist",clearText:intl.components.picklist.clearText,headingText:"",infoText:"",noResultsText:intl.components.picklist.noResultsText,constructor:function(e){this.mergeOptions(e,CLASS_OPTIONS$3),this.mergeOptions(e,CLASS_OPTIONS_ITEM),Component.apply(this,arguments)},viewOptions(){const e=pick(this,...CLASS_OPTIONS$3,...CLASS_OPTIONS_ITEM);return extend({model:this.getState()},e)},ViewClass:Picklists,viewEvents:{"watch:change":"onWatchChange"},onWatchChange(e){this.setState("query",e)}}),CLASS_OPTIONS$2=["align","collection","lists","picklistEvents","picklistOptions","popRegion","popWidth","position","viewOptions"],picklistOptions={attr:"text",canClear:!1,headingText:null,infoText:null,isSelectlist:!1,placeholderText:null},popWidth$1=null,viewOptions={className:"button-secondary",template:_Handlebars2.template({1:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return e.escapeExpression((s(i,"fa")||t&&s(t,"fa")||e.hooks.helperMissing).call(t??(e.nullContext||{}),(n=t!=null?s(t,"icon"):t)!=null?s(n,"type"):n,(n=t!=null?s(t,"icon"):t)!=null?s(n,"icon"):n,{name:"fa",hash:{classes:(n=t!=null?s(t,"icon"):t)!=null?s(n,"classes"):n},data:o,loc:{start:{line:2,column:17},end:{line:2,column:64}}}))},3:function(e,t,i,r,o){var n=e.lookupProperty||function(s,l){if(Object.prototype.hasOwnProperty.call(s,l))return s[l]};return"<span>"+e.escapeExpression(n(i,"lookup").call(t??(e.nullContext||{}),t,t!=null?n(t,"attr"):t,{name:"lookup",hash:{},data:o,loc:{start:{line:3,column:37},end:{line:3,column:57}}}))+"</span>"},5:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return(n=s(i,"if").call(t??(e.nullContext||{}),t!=null?s(t,"defaultText"):t,{name:"if",hash:{},fn:e.program(6,o,0),inverse:e.noop,data:o,loc:{start:{line:4,column:6},end:{line:4,column:64}}}))!=null?n:""},6:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return"<span>"+e.escapeExpression((n=(n=s(i,"defaultText")||(t!=null?s(t,"defaultText"):t))!=null?n:e.hooks.helperMissing,typeof n=="function"?n.call(t??(e.nullContext||{}),{name:"defaultText",hash:{},data:o,loc:{start:{line:4,column:32},end:{line:4,column:49}}}):n))+"</span>"},compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s=t??(e.nullContext||{}),l=e.lookupProperty||function(a,c){if(Object.prototype.hasOwnProperty.call(a,c))return a[c]};return((n=l(i,"if").call(s,t!=null?l(t,"icon"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:2,column:4},end:{line:2,column:71}}}))!=null?n:"")+((n=l(i,"if").call(s,l(i,"lookup").call(s,t,t!=null?l(t,"attr"):t,{name:"lookup",hash:{},data:o,loc:{start:{line:3,column:11},end:{line:3,column:29}}}),{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.program(5,o,0),data:o,loc:{start:{line:3,column:4},end:{line:5,column:11}}}))!=null?n:"")},useData:!0}),templateContext(){return{attr:"text",defaultText:intl.components.droplist.defaultText}}},StateModel=Backbone.Model.extend({defaults:{isDisabled:!1,isActive:!1,selected:null}}),ViewClass=View.extend({initialize({state:e}){this.model=e.selected},attributes(){return{disabled:this.getOption("state").isDisabled}},tagName:"button",triggers:{click:"click",focus:"focus"}}),Droplist=Component.extend({picklistOptions,popWidth:popWidth$1,StateModel,ViewClass,constructor:function(e){this.mergeOptions(e,CLASS_OPTIONS$2),this.once("show",()=>{this.getState("isActive")&&this.showPicklist()}),Component.apply(this,arguments)},mixinViewOptions(e){return extend({state:this.getState().attributes},viewOptions,result(this,"viewOptions"),e)},viewEvents:{click:"onClick"},onClick(){this.toggleState("isActive")},stateEvents:{"change:isDisabled":"onChangeIsDisabled","change:isActive":"onChangeIsActive","change:selected":"onChangeStateSelected"},onChangeIsDisabled(){this.show()},onChangeIsActive(e,t){const i=this.getView();i.$el.toggleClass("is-active",t),t&&(i.$el.blur(),this.showPicklist())},onChangeStateSelected(e,t){this.show(),this.triggerMethod("change:selected",t)},showPicklist(){const e=new Picklist$1(extend({lists:this.lists||[{collection:this.collection}],state:{selected:this.getState("selected")}},result(this,"picklistOptions")));this.popRegion.show(e,this.popRegionOptions()),this.bindEvents(e.getView(),this._picklistEvents),this.bindEvents(e.getView(),result(this,"picklistEvents"))},position(){return this.getView().getBounds()},popRegionOptions(){return extend({ignoreEl:this.getView().el,popWidth:result(this,"popWidth"),align:this.align},result(this,"position"))},_picklistEvents:{close:"onPicklistClose","picklist:item:select":"onPicklistSelect",destroy:"onPicklistDestroy"},onPicklistClose(){this.popRegion.empty()},onPicklistSelect({model:e}){this.popRegion.empty(),this.setState("selected",e)},onPicklistDestroy(){this.toggleState("isActive",!1)}},{setPopRegion(e){this.prototype.popRegion=e}}),CLASS_OPTIONS$1=["align","ignoreEl","popWidth","position","uiView","ui"],attr="text",align="left",popWidth=null,Optionlist=Picklist$1.extend({attr,align,popWidth,constructor:function(e){this.mergeOptions(e,CLASS_OPTIONS$1),this.listenTo(this.uiView,"render destroy",this.destroy),Picklist$1.apply(this,arguments)},viewTriggers:{close:"close","picklist:item:select":"select"},position(){return this.uiView.getBounds(this.ui)},regionOptions(){return extend({ignoreEl:this.ignoreEl||this.ui[0],popWidth:this.popWidth,align:this.align},result(this,"position"))},onClose(){this.destroy()},onSelect({model:e}){if(e.get("isDisabled"))return;e.get("onSelect").call(this,e),this.destroy()}}),CLASS_OPTIONS=["className","delay","ignoreEl","message","messageHtml","orientation","position","uiView","ui"],TooltipView=View.extend({template:_Handlebars2.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s,l=t??(e.nullContext||{}),a=e.hooks.helperMissing,c="function",h=e.lookupProperty||function(u,d){if(Object.prototype.hasOwnProperty.call(u,d))return u[d]};return e.escapeExpression((s=(s=h(i,"message")||(t!=null?h(t,"message"):t))!=null?s:a,typeof s===c?s.call(l,{name:"message",hash:{},data:o,loc:{start:{line:1,column:0},end:{line:1,column:13}}}):s))+((n=(s=(s=h(i,"messageHtml")||(t!=null?h(t,"messageHtml"):t))!=null?s:a,typeof s===c?s.call(l,{name:"messageHtml",hash:{},data:o,loc:{start:{line:1,column:13},end:{line:1,column:32}}}):s))!=null?n:"")},useData:!0}),templateContext(){return{message:this.getOption("message"),messageHtml:this.getOption("messageHtml")}}}),Tooltip=Component.extend({ViewClass:TooltipView,className:"tooltip",delay:0,constructor:function(e){this.mergeOptions(e,CLASS_OPTIONS),this.setListeners(),this.listenTo(this.uiView,"render destroy",this.destroy),Component.apply(this,arguments)},setListeners(){this.ui&&(this.ui.on("pointerenter.tooltip",bind$2(this.showTooltip,this)),this.ui.on("mouseleave.tooltip",bind$2(this.hideTooltip,this)),this.ui.on("pointerdown.tooltip",bind$2(this.showTooltip,this)))},showTooltip(){clearTimeout(this.delayTimeout);const e=result(this,"delay");this.delayTimeout=delay(bind$2(this.show,this),e)},hideTooltip(){clearTimeout(this.delayTimeout),this.empty()},onBeforeDestroy(){clearTimeout(this.delayTimeout)},onShow(){anime({targets:this.getView().el,duration:1500,opacity:[0,1]})},viewOptions(){return{className:result(this,"className"),message:result(this,"message"),messageHtml:result(this,"messageHtml")}},position(){return this.uiView.getBounds(this.ui)},regionOptions(){const e=result(this,"orientation"),t=result(this,"ignoreEl");return extend({orientation:e,ignoreEl:t},result(this,"position"))}}),AlertTemplate=_Handlebars2.template({1:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return' <button class="alert-box__link js-undo" type="button">'+e.escapeExpression(e.lambda((n=(n=(n=(n=o&&s(o,"intl"))&&s(n,"globals"))&&s(n,"alertBox"))&&s(n,"alertBoxTemplate"))&&s(n,"undoBtn"),t))+"</button>"},compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s,l=t??(e.nullContext||{}),a=e.hooks.helperMissing,c="function",h=e.escapeExpression,u=e.lookupProperty||function(d,g){if(Object.prototype.hasOwnProperty.call(d,g))return d[g]};return'<div class="alert-box__icon '+h((s=(s=u(i,"alertType")||(t!=null?u(t,"alertType"):t))!=null?s:a,typeof s===c?s.call(l,{name:"alertType",hash:{},data:o,loc:{start:{line:1,column:28},end:{line:1,column:43}}}):s))+`">
  `+h((u(i,"far")||t&&u(t,"far")||a).call(l,t!=null?u(t,"iconType"):t,{name:"far",hash:{},data:o,loc:{start:{line:2,column:2},end:{line:2,column:18}}}))+`
</div>
<div class="alert-box__body">
  `+h((s=(s=u(i,"text")||(t!=null?u(t,"text"):t))!=null?s:a,typeof s===c?s.call(l,{name:"text",hash:{},data:o,loc:{start:{line:5,column:2},end:{line:5,column:12}}}):s))+((n=(s=(s=u(i,"html")||(t!=null?u(t,"html"):t))!=null?s:a,typeof s===c?s.call(l,{name:"html",hash:{},data:o,loc:{start:{line:5,column:12},end:{line:5,column:24}}}):s))!=null?n:"")+((n=u(i,"if").call(l,t!=null?u(t,"hasUndo"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:5,column:24},end:{line:5,column:163}}}))!=null?n:"")+`
</div>
<button class="alert-box__cancel js-dismiss" type="button">`+h(e.lambda((n=(n=(n=(n=o&&u(o,"intl"))&&u(n,"globals"))&&u(n,"alertBox"))&&u(n,"alertBoxTemplate"))&&u(n,"dismissBtn"),t))+`</button>
`},useData:!0}),OPTIONS=["alertType","text","html","hasUndo"],icons={success:"circle-check",info:"circle-info",error:"circle-xmark"},AlertView=View.extend({className:"alert-box",alertType:"info",template:AlertTemplate,triggers:{"click .js-dismiss":"click:dismiss","click .js-undo":"click:undo"},initialize(e){this.mergeOptions(e,OPTIONS)},onAttach(){anime({targets:this.el,duration:900,translateY:[-10,0],opacity:[0,1],easing:"easeInOutQuad"})},onClickDismiss(){this.dismiss()},onClickUndo(){this.isDismissed||(this._dismiss(),this.triggerMethod("undo",this))},_dismiss(){this.isDismissed=!0,anime({targets:this.el,opacity:[1,0],duration:800,easing:"easeInSine",complete:bind$2(this.destroy,this)})},dismiss(){this.isDismissed||(this._dismiss(),this.triggerMethod("dismiss",this))},templateContext(){return{alertType:this.alertType,text:this.text,html:this.html,hasUndo:this.hasUndo,iconType:icons[this.alertType]}}}),AlertsView=CollectionView.extend({className:"alert-box__container",onRemoveChild(){this.children.length||this.destroy()}}),ALERT_TIMEOUT=4e3,AlertService=App.extend({channelName:"alert",radioRequests:{show:"showAlert","show:success":"showSuccess","show:info":"showInfo","show:error":"showError","show:undo":"showUndo","show:apiError":"showApiError"},showAlert(e){const t=new AlertView(e);delay(function(){t.dismiss()},ALERT_TIMEOUT);let i=this.getView();return i||(i=this.showView(new AlertsView)),i.addChildView(t)},showSuccess(e){this.showAlert({text:e,alertType:"success"})},showInfo(e){this.showAlert({text:e,alertType:"info"})},showError(e){this.showAlert({text:e,alertType:"error"})},showUndo(e){e=extend({hasUndo:!0},e);const t=this.showAlert(omit(e,"onUndo","onComplete"));this.listenTo(t,{undo:e.onUndo,dismiss:e.onComplete})},showApiError(e){const t=e.errors;t.length&&each$8(t,i=>this.showAlert({text:i.detail,alertType:"error"}))}});var assign=make_assign(),create$1=make_create(),trim$1=make_trim(),Global$5=typeof window<"u"?window:commonjsGlobal,util$6={assign,create:create$1,trim:trim$1,bind:bind$1,slice:slice$1,each:each$7,map,pluck:pluck$1,isList:isList$1,isFunction:isFunction$1,isObject:isObject$1,Global:Global$5};function make_assign(){return Object.assign?Object.assign:function(t,i,r,o){for(var n=1;n<arguments.length;n++)each$7(Object(arguments[n]),function(s,l){t[l]=s});return t}}function make_create(){if(Object.create)return function(t,i,r,o){var n=slice$1(arguments,1);return assign.apply(this,[Object.create(t)].concat(n))};{let e=function(){};return function(i,r,o,n){var s=slice$1(arguments,1);return e.prototype=i,assign.apply(this,[new e].concat(s))}}}function make_trim(){return String.prototype.trim?function(t){return String.prototype.trim.call(t)}:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}function bind$1(e,t){return function(){return t.apply(e,Array.prototype.slice.call(arguments,0))}}function slice$1(e,t){return Array.prototype.slice.call(e,t||0)}function each$7(e,t){pluck$1(e,function(i,r){return t(i,r),!1})}function map(e,t){var i=isList$1(e)?[]:{};return pluck$1(e,function(r,o){return i[o]=t(r,o),!1}),i}function pluck$1(e,t){if(isList$1(e)){for(var i=0;i<e.length;i++)if(t(e[i],i))return e[i]}else for(var r in e)if(e.hasOwnProperty(r)&&t(e[r],r))return e[r]}function isList$1(e){return e!=null&&typeof e!="function"&&typeof e.length=="number"}function isFunction$1(e){return e&&{}.toString.call(e)==="[object Function]"}function isObject$1(e){return e&&{}.toString.call(e)==="[object Object]"}var util$5=util$6,slice=util$5.slice,pluck=util$5.pluck,each$6=util$5.each,bind=util$5.bind,create=util$5.create,isList=util$5.isList,isFunction=util$5.isFunction,isObject=util$5.isObject,storeEngine={createStore},storeAPI={version:"2.0.12",enabled:!1,get:function(e,t){var i=this.storage.read(this._namespacePrefix+e);return this._deserialize(i,t)},set:function(e,t){return t===void 0?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each(function(i,r){e.call(t,t._deserialize(i),(r||"").replace(t._namespaceRegexp,""))})},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return createStore.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return createStore(this.storage,this.plugins,e)}};function _warn(){var e=typeof console>"u"?null:console;if(e){var t=e.warn?e.warn:e.log;t.apply(e,arguments)}}function createStore(e,t,i){i||(i=""),e&&!isList(e)&&(e=[e]),t&&!isList(t)&&(t=[t]);var r=i?"__storejs_"+i+"_":"",o=i?new RegExp("^"+r):null,n=/^[a-zA-Z0-9_\-]*$/;if(!n.test(i))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var s={_namespacePrefix:r,_namespaceRegexp:o,_testStorage:function(a){try{var c="__storejs__test__";a.write(c,c);var h=a.read(c)===c;return a.remove(c),h}catch{return!1}},_assignPluginFnProp:function(a,c){var h=this[c];this[c]=function(){var d=slice(arguments,0),g=this;function m(){if(h)return each$6(arguments,function(v,w){d[w]=v}),h.apply(g,d)}var p=[m].concat(d);return a.apply(g,p)}},_serialize:function(a){return JSON.stringify(a)},_deserialize:function(a,c){if(!a)return c;var h="";try{h=JSON.parse(a)}catch{h=a}return h!==void 0?h:c},_addStorage:function(a){this.enabled||this._testStorage(a)&&(this.storage=a,this.enabled=!0)},_addPlugin:function(a){var c=this;if(isList(a)){each$6(a,function(d){c._addPlugin(d)});return}var h=pluck(this.plugins,function(d){return a===d});if(!h){if(this.plugins.push(a),!isFunction(a))throw new Error("Plugins must be function values that return objects");var u=a.call(this);if(!isObject(u))throw new Error("Plugins must return an object of function properties");each$6(u,function(d,g){if(!isFunction(d))throw new Error("Bad plugin property: "+g+" from plugin "+a.name+". Plugins should only return functions.");c._assignPluginFnProp(d,g)})}},addStorage:function(a){_warn("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(a)}},l=create(s,storeAPI,{plugins:[]});return l.raw={},each$6(l,function(a,c){isFunction(a)&&(l.raw[c]=bind(l,a))}),each$6(e,function(a){l._addStorage(a)}),each$6(t,function(a){l._addPlugin(a)}),l}var util$4=util$6,Global$4=util$4.Global,localStorage_1={name:"localStorage",read:read$5,write:write$5,each:each$5,remove:remove$5,clearAll:clearAll$5};function localStorage(){return Global$4.localStorage}function read$5(e){return localStorage().getItem(e)}function write$5(e,t){return localStorage().setItem(e,t)}function each$5(e){for(var t=localStorage().length-1;t>=0;t--){var i=localStorage().key(t);e(read$5(i),i)}}function remove$5(e){return localStorage().removeItem(e)}function clearAll$5(){return localStorage().clear()}var util$3=util$6,Global$3=util$3.Global,oldFFGlobalStorage={name:"oldFF-globalStorage",read:read$4,write:write$4,each:each$4,remove:remove$4,clearAll:clearAll$4},globalStorage=Global$3.globalStorage;function read$4(e){return globalStorage[e]}function write$4(e,t){globalStorage[e]=t}function each$4(e){for(var t=globalStorage.length-1;t>=0;t--){var i=globalStorage.key(t);e(globalStorage[i],i)}}function remove$4(e){return globalStorage.removeItem(e)}function clearAll$4(){each$4(function(e,t){delete globalStorage[e]})}var util$2=util$6,Global$2=util$2.Global,oldIEUserDataStorage={name:"oldIE-userDataStorage",write:write$3,read:read$3,each:each$3,remove:remove$3,clearAll:clearAll$3},storageName="storejs",doc$1=Global$2.document,_withStorageEl=_makeIEStorageElFunction(),disable=(Global$2.navigator?Global$2.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);function write$3(e,t){if(!disable){var i=fixKey(e);_withStorageEl(function(r){r.setAttribute(i,t),r.save(storageName)})}}function read$3(e){if(!disable){var t=fixKey(e),i=null;return _withStorageEl(function(r){i=r.getAttribute(t)}),i}}function each$3(e){_withStorageEl(function(t){for(var i=t.XMLDocument.documentElement.attributes,r=i.length-1;r>=0;r--){var o=i[r];e(t.getAttribute(o.name),o.name)}})}function remove$3(e){var t=fixKey(e);_withStorageEl(function(i){i.removeAttribute(t),i.save(storageName)})}function clearAll$3(){_withStorageEl(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(storageName);for(var i=t.length-1;i>=0;i--)e.removeAttribute(t[i].name);e.save(storageName)})}var forbiddenCharsRegex=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function fixKey(e){return e.replace(/^\d/,"___$&").replace(forbiddenCharsRegex,"___")}function _makeIEStorageElFunction(){if(!doc$1||!doc$1.documentElement||!doc$1.documentElement.addBehavior)return null;var e="script",t,i,r;try{i=new ActiveXObject("htmlfile"),i.open(),i.write("<"+e+">document.w=window</"+e+'><iframe src="/favicon.ico"></iframe>'),i.close(),t=i.w.frames[0].document,r=t.createElement("div")}catch{r=doc$1.createElement("div"),t=doc$1.body}return function(o){var n=[].slice.call(arguments,0);n.unshift(r),t.appendChild(r),r.addBehavior("#default#userData"),r.load(storageName),o.apply(this,n),t.removeChild(r)}}var util$1=util$6,Global$1=util$1.Global,trim=util$1.trim,cookieStorage={name:"cookieStorage",read:read$2,write:write$2,each:each$2,remove:remove$2,clearAll:clearAll$2},doc=Global$1.document;function read$2(e){if(!e||!_has(e))return null;var t="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(doc.cookie.replace(new RegExp(t),"$1"))}function each$2(e){for(var t=doc.cookie.split(/; ?/g),i=t.length-1;i>=0;i--)if(trim(t[i])){var r=t[i].split("="),o=unescape(r[0]),n=unescape(r[1]);e(n,o)}}function write$2(e,t){e&&(doc.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")}function remove$2(e){!e||!_has(e)||(doc.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function clearAll$2(){each$2(function(e,t){remove$2(t)})}function _has(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(doc.cookie)}var util=util$6,Global=util.Global,sessionStorage_1={name:"sessionStorage",read:read$1,write:write$1,each:each$1,remove:remove$1,clearAll:clearAll$1};function sessionStorage(){return Global.sessionStorage}function read$1(e){return sessionStorage().getItem(e)}function write$1(e,t){return sessionStorage().setItem(e,t)}function each$1(e){for(var t=sessionStorage().length-1;t>=0;t--){var i=sessionStorage().key(t);e(read$1(i),i)}}function remove$1(e){return sessionStorage().removeItem(e)}function clearAll$1(){return sessionStorage().clear()}var memoryStorage_1={name:"memoryStorage",read,write,each,remove,clearAll},memoryStorage={};function read(e){return memoryStorage[e]}function write(e,t){memoryStorage[e]=t}function each(e){for(var t in memoryStorage)memoryStorage.hasOwnProperty(t)&&e(memoryStorage[t],t)}function remove(e){delete memoryStorage[e]}function clearAll(e){memoryStorage={}}var all=[localStorage_1,oldFFGlobalStorage,oldIEUserDataStorage,cookieStorage,sessionStorage_1,memoryStorage_1],json2$1={},hasRequiredJson2;function requireJson2(){return hasRequiredJson2||(hasRequiredJson2=1,typeof JSON!="object"&&(JSON={}),function(){var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(t){var i=meta[t];return typeof i=="string"?i:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,r,o,n,s=gap,l,a=t[e];switch(a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a)),typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";if(gap+=indent,l=[],Object.prototype.toString.apply(a)==="[object Array]"){for(n=a.length,i=0;i<n;i+=1)l[i]=str(i,a)||"null";return o=l.length===0?"[]":gap?`[
`+gap+l.join(`,
`+gap)+`
`+s+"]":"["+l.join(",")+"]",gap=s,o}if(rep&&typeof rep=="object")for(n=rep.length,i=0;i<n;i+=1)typeof rep[i]=="string"&&(r=rep[i],o=str(r,a),o&&l.push(quote(r)+(gap?": ":":")+o));else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(o=str(r,a),o&&l.push(quote(r)+(gap?": ":":")+o));return o=l.length===0?"{}":gap?`{
`+gap+l.join(`,
`+gap)+`
`+s+"}":"{"+l.join(",")+"}",gap=s,o}}typeof JSON.stringify!="function"&&(meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,i){var r;if(gap="",indent="",typeof i=="number")for(r=0;r<i;r+=1)indent+=" ";else typeof i=="string"&&(indent=i);if(rep=t,t&&typeof t!="function"&&(typeof t!="object"||typeof t.length!="number"))throw new Error("JSON.stringify");return str("",{"":e})}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){var j;function walk(e,t){var i,r,o=e[t];if(o&&typeof o=="object")for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r=walk(o,i),r!==void 0?o[i]=r:delete o[i]);return reviver.call(e,t,o)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()),json2$1}var json2=json2Plugin;function json2Plugin(){return requireJson2(),{}}var engine=storeEngine,storages=all,plugins=[json2],store_legacy=engine.createStore(storages,plugins);const store=getDefaultExportFromCjs(store_legacy);let activeRolesCache;function getActiveRoles(e,t){const i=e.reject({name:"patient"});return t?i:reject(i,r=>contains(r.get("permissions"),"clinicians:admin"))}const BootstrapService=App.extend({channelName:"bootstrap",radioRequests:{currentUser:"getCurrentUser",currentWorkspace:"getCurrentWorkspace",setCurrentWorkspace:"setCurrentWorkspace",workspaces:"getWorkspaces",organization:"getOrganization",directories:"getDirectories",setDirectories:"setDirectories",setting:"getSetting",roles:"getActiveRoles",teams:"getTeams",sidebarWidgets:"getSidebarWidgets","sidebarWidgets:fields":"getSidebarWidgetFields",widgets:"getWidgets",fetch:"fetchBootstrap"},getCurrentUser(){return this.currentUser},_getWorkspace(e){const t=this.currentUser.getWorkspaces();if(!t.length)throw"No workspaces found";return t.find({slug:e})||t.find({id:store.get("currentWorkspace")})||t.at(0)},getCurrentWorkspace(){return this.currentWorkspace},setCurrentWorkspace(e){const t=e||getRootRoute();if(this.currentWorkspace&&!t)return this.currentWorkspace;const i=this._getWorkspace(t);return i.id!==get(this.currentWorkspace,"id")&&(store.set("currentWorkspace",i.id),this.currentWorkspace=i,this.getChannel().trigger("change:workspace",i)),i},getOrganization(){return this.organization},getDirectories(){return this.directories.clone()},setDirectories(e){this.directories=e},getWorkspaces(){return this.workspaces.clone()},getSetting(e){if(!this.isRunning())return;const t=this.currentWorkspace.get("settings"),i=get(t,e);if(i)return i;const r=this.settings.get(e);if(r)return r.get("value")},getActiveRoles(){if(activeRolesCache)return activeRolesCache;const e=this.currentUser.can("clinicians:admin"),t=getActiveRoles(this.roles,e);return activeRolesCache=Radio.request("entities","roles:collection",t),activeRolesCache},getTeams(){return this.teams.clone()},getWidgets(){return this.widgets.clone()},getSidebarWidgets(){const e=get(this.getSetting("widgets_patient_sidebar"),"widgets"),t=map$1(e,i=>this.widgets.find({slug:i}));return Radio.request("entities","widgets:collection",invoke(compact(t),"omit","id"))},getSidebarWidgetFields(){return get(this.getSetting("widgets_patient_sidebar"),"fields")},initialize({name:e}){this.bootstrapPromise=new Promise((t,i)=>{this.resolveBootstrap=t,this.rejectBootstrap=i}),this.organization=new Backbone.Model({name:e})},beforeStart(){return[Radio.request("entities","fetch:clinicians:current"),Radio.request("entities","fetch:roles:collection"),Radio.request("entities","fetch:teams:collection"),Radio.request("entities","fetch:settings:collection"),Radio.request("entities","fetch:workspaces:collection"),Radio.request("entities","fetch:widgets:collection")]},onStart(e,t,i,r,o,n,s){this.currentUser=t,this.roles=i,this.teams=r,this.settings=o,this.workspaces=n,this.widgets=s,this.setCurrentWorkspace(),this.resolveBootstrap(t)},onFail(e,...t){this.rejectBootstrap(...t)},fetchBootstrap(){return this.start(),this.bootstrapPromise}}),HistoryService=App.extend({channelName:"history",radioRequests:{"go:back":"goBack"},initialize(){const e=Backbone.history.navigate;this._prevHistory=[Backbone.history.getFragment()],Backbone.history.navigate=(t,i)=>{const r=e.call(Backbone.history,t,i);return r===!1?!1:(this.setPrevious(t,i),this.triggerChange(),r)},window.addEventListener("popstate",()=>{const t=Backbone.history.getFragment();t===this._prevHistory.at(1)?this._prevHistory.shift():this._prevHistory.unshift(t),this.triggerChange()})},setPrevious(e,{replace:t}){if(t){this._prevHistory[0]=e;return}this._prevHistory.unshift(e)},triggerChange(){this.getChannel().trigger("change:route",this._prevHistory[0])},goBack(e){if(e&&this._prevHistory.length<2){e();return}this._prevHistory.shift(),Backbone.history.navigate(this._prevHistory.shift(),{trigger:!0})}}),LastestListService=App.extend({channelName:"history",radioRequests:{"set:latestList":"setLatestList","has:latestList":"hasLatestList","go:latestList":"goLatestList"},setLatestList(e,t=[]){this._latestList=e,this._latestListArgs=t},hasLatestList(){return!!this._latestList},goLatestList(){this.hasLatestList()&&Radio.trigger("event-router",this._latestList,...this._latestListArgs)}});function getClinicians(e){return e?Radio.request("entities","teams:model",e).getAssignableClinicians():Radio.request("bootstrap","currentWorkspace").getAssignableClinicians()}const FormsService=App.extend({startAfterInitialized:!0,channelName(){return`form${this.getOption("form").id}`},channelRequest(){return this.isDestroyed()?void 0:this.getChannel().request(...arguments)},initialize(e){this.updateDraft=debounce(this.updateDraft,15e3),this.refreshForm=debounce(this.refreshForm,18e5),this.mergeOptions(e,["action","form","patient","responses","latestResponse"]),this.currentUser=Radio.request("bootstrap","currentUser")},onBeforeDestroy(){this.updateDraft.cancel(),this.refreshForm.cancel()},radioRequests:{"ready:form":"readyForm","submit:form":"submitForm","fetch:clinicians":"fetchClinicians","fetch:directory":"fetchDirectory","fetch:form":"fetchForm","fetch:form:data":"fetchFormPrefill","fetch:form:response":"fetchFormResponse","update:storedSubmission":"updateStoredSubmission","get:storedSubmission":"getStoredSubmission","clear:storedSubmission":"clearStoredSubmission","fetch:field":"fetchField","update:field":"updateField","fetch:icd":"fetchIcd",version:"checkVersion"},readyForm(){this.trigger("ready"),this.refreshForm()},checkVersion(e){e!==versions.frontend&&window.location.reload()},isReadOnly(){const e=this.action&&this.action.isLocked(),t=this.action&&!this.action.canSubmit();return this.form.isReadOnly()||e||t},getStoreId(){const e=get(this.action,"id"),t=[this.currentUser.id,this.patient.id,this.form.id];return e&&t.push(e),`form-subm-${t.join("-")}`},getLatestDraft(){return this.responses&&this.responses.first()!==this.latestResponse?{}:this.latestResponse&&this.latestResponse.getDraft()||{}},getStoredSubmission(){const e=this.getLatestDraft(),t=store.get(this.getStoreId())||{};return e.updated&&(!t.updated||dayjs(e.updated).isAfter(t.updated))?(this.trigger("update:submission",e.updated),e):(t.updated&&this.trigger("update:submission",t.updated),t)},updateStoredSubmission(e){if(this.isReadOnly())return;const t=dayjs().format();this._draft=e;try{store.set(this.getStoreId(),{submission:e,updated:t}),this.trigger("update:submission",t)}catch{store.each((i,r)=>{String(r).startsWith("form-subm-")&&store.remove(r)}),store.set(this.getStoreId(),{submission:e,updated:t})}this.updateDraft(),this.refreshForm()},clearStoredSubmission(){this.latestResponse=null,store.remove(this.getStoreId()),this.trigger("update:submission")},fetchField({fieldName:e,requestId:t}){const i=Radio.request("entities","patientFields:model",{name:e,_patient:this.patient.id});return i.fetch().then(()=>{this.channelRequest("send","fetch:field",{value:i.getValue(),requestId:t})}).catch(({responseData:r})=>{this.channelRequest("send","fetch:field",{error:r,requestId:t})})},updateField({fieldName:e,value:t,requestId:i}){const r=Radio.request("entities","patientFields:model",{name:e,value:t,_patient:this.patient.id});return r.saveAll().then(()=>{this.channelRequest("send","update:field",{value:r.getValue(),requestId:i})}).catch(({responseData:o})=>{this.channelRequest("send","update:field",{error:o,requestId:i})})},fetchClinicians({teamId:e,requestId:t}){const i=getClinicians(e);this.channelRequest("send","fetch:directory",{value:i.toJSON(),requestId:t})},fetchDirectory({directoryName:e,query:t,requestId:i}){return Promise.resolve(Radio.request("entities","fetch:directories:model",e,t)).then(r=>{this.channelRequest("send","fetch:directory",{value:r.get("value"),requestId:i})}).catch(({responseData:r})=>{this.channelRequest("send","fetch:directory",{error:r,requestId:i})})},fetchIcd({term:e,requestId:t}){return Promise.resolve(Radio.request("entities","fetch:icd:byTerm",e)).then(i=>{this.channelRequest("send","fetch:icd",{value:get(i,["data","icdCodes"]),requestId:t})}).catch(({responseData:i})=>{this.channelRequest("send","fetch:icd",{error:i,requestId:t})})},fetchForm(){return Promise.resolve(Radio.request("entities","fetch:forms:definition",this.form.id)).then(e=>{this.channelRequest("send","fetch:form",{definition:e,contextScripts:this.form.getContextScripts()})})},fetchFormStoreSubmission({submission:e}){return Promise.all([Radio.request("entities","fetch:forms:definition",this.form.id)]).then(([t])=>{this.channelRequest("send","fetch:form:data",{definition:t,storedSubmission:e,...omit(this.form.getContext(),"loaderReducers")})})},_getPrefillFilters({flowId:e,patientId:t},i){const r={status:FORM_RESPONSE_STATUS.SUBMITTED,flow:e,patient:t};i.isReport()&&(r.created=`<=${this.action.get("created_at")}`);const n=i.getPrefillActionTag();return n?(r["action.tags"]=n,r):(r.form=i.getPrefillFormId(),r)},fetchLatestFormSubmission(e){const t=this.isReadOnly(),i=get(this.action,"id"),r=this.patient.id,o=this._getPrefillFilters({flowId:e,patientId:r},this.form);return Promise.all([Radio.request("entities","fetch:forms:definition",this.form.id),Radio.request("entities","fetch:forms:data",i,r,this.form.id),Radio.request("entities","fetch:formResponses:latest",o)]).then(([n,s,l])=>{this.channelRequest("send","fetch:form:data",{definition:n,isReadOnly:t,formData:s.attributes,responseData:l.getFormData(),formSubmission:l.getResponse(),...this.form.getContext()})})},fetchFormPrefill(){const e=this.getStoredSubmission(),t=this.isReadOnly();if(!t&&e.updated)return this.fetchFormStoreSubmission(e);const i=this.responses&&this.responses.getFirstSubmission();if(!i&&this.action){if(this.action.hasTag("prefill-latest-response"))return this.fetchLatestFormSubmission();if(this.action.hasTag("prefill-flow-response"))return this.fetchLatestFormSubmission(this.action.get("_flow"))}return Promise.all([Radio.request("entities","fetch:forms:definition",this.form.id),Radio.request("entities","fetch:forms:data",get(this.action,"id"),this.patient.id,this.form.id),Radio.request("entities","fetch:formResponses:model",get(i,"id"))]).then(([r,o,n])=>{this.channelRequest("send","fetch:form:data",{definition:r,isReadOnly:t,formData:o.attributes,responseData:n.getFormData(),formSubmission:n.getResponse(),...this.form.getContext()})})},fetchFormResponse({responseId:e}){return Promise.all([Radio.request("entities","fetch:forms:definition",this.form.id),Radio.request("entities","fetch:formResponses:model",e)]).then(([t,i])=>{this.channelRequest("send","fetch:form:response",{definition:t,responseData:i.getFormData(),formSubmission:i.getResponse(),contextScripts:this.form.getContextScripts()})})},useLatestDraft(e){return!this.latestResponse||this.latestResponse.get("status")!==FORM_RESPONSE_STATUS.DRAFT?e:{...e,id:this.latestResponse.id}},updateDraft(){const e=this.useLatestDraft({response:{data:this._draft},status:FORM_RESPONSE_STATUS.DRAFT,_form:this.form,_patient:this.patient,_action:this.action}),t=Radio.request("entities","formResponses:model",e);return this.latestResponse=t,t.saveAll().catch(({responseData:i})=>{i&&this.trigger("error",i.errors)})},refreshForm(){this.trigger("refresh")},submitForm({response:e}){this.updateDraft.cancel(),this.refreshForm.cancel();const t=this.useLatestDraft({response:e,status:FORM_RESPONSE_STATUS.SUBMITTED,_form:this.form,_patient:this.patient,_action:this.action}),i=Radio.request("entities","formResponses:model",t);return this.trigger("submit"),i.saveAll().then(()=>{this.updateDraft.cancel(),this.refreshForm.cancel(),this.clearStoredSubmission(),this.trigger("success",i)}).catch(({responseData:r})=>{if(!r)return;this.trigger("error",r.errors);const o=map$1(r.errors,"detail");this.channelRequest("send","form:errors",o)})}});function animSidebar(e){return anime({targets:e,translateX:[{value:20,duration:0},{value:0,duration:200}],opacity:[{value:0,duration:0},{value:1,duration:300}],easing:"easeInOutQuad"})}const ModalTemplate=_Handlebars2.template({1:function(e,t,i,r,o){var n=e.lookupProperty||function(s,l){if(Object.prototype.hasOwnProperty.call(s,l))return s[l]};return'<span class="modal__header-icon">'+e.escapeExpression((n(i,"fa")||t&&n(t,"fa")||e.hooks.helperMissing).call(t??(e.nullContext||{}),t!=null?n(t,"headerIconType"):t,t!=null?n(t,"headerIcon"):t,{name:"fa",hash:{},data:o,loc:{start:{line:2,column:53},end:{line:2,column:85}}}))+"</span>"},3:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return'<button class="button--text js-close">'+e.escapeExpression((n=(n=s(i,"cancelText")||(t!=null?s(t,"cancelText"):t))!=null?n:e.hooks.helperMissing,typeof n=="function"?n.call(t??(e.nullContext||{}),{name:"cancelText",hash:{},data:o,loc:{start:{line:14,column:60},end:{line:14,column:76}}}):n))+"</button>"},compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s,l=t??(e.nullContext||{}),a=e.hooks.helperMissing,c="function",h=e.escapeExpression,u=e.lookupProperty||function(d,g){if(Object.prototype.hasOwnProperty.call(d,g))return d[g]};return'<div class="modal__header '+h((s=(s=u(i,"headerClass")||(t!=null?u(t,"headerClass"):t))!=null?s:a,typeof s===c?s.call(l,{name:"headerClass",hash:{},data:o,loc:{start:{line:1,column:26},end:{line:1,column:43}}}):s))+`" data-header-region>
  `+((n=u(i,"if").call(l,t!=null?u(t,"headerIcon"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:2,column:2},end:{line:2,column:99}}}))!=null?n:"")+`
  <div class="flex-grow">`+h((s=(s=u(i,"headingText")||(t!=null?u(t,"headingText"):t))!=null?s:a,typeof s===c?s.call(l,{name:"headingText",hash:{},data:o,loc:{start:{line:3,column:25},end:{line:3,column:42}}}):s))+`</div>
  <button class="button--icon js-close">`+h((u(i,"far")||t&&u(t,"far")||a).call(l,"xmark",{name:"far",hash:{},data:o,loc:{start:{line:4,column:40},end:{line:4,column:55}}}))+`</button>
</div>

<div class="modal__body" data-body-region>
  <div class="`+h((s=(s=u(i,"bodyClass")||(t!=null?u(t,"bodyClass"):t))!=null?s:a,typeof s===c?s.call(l,{name:"bodyClass",hash:{},data:o,loc:{start:{line:8,column:14},end:{line:8,column:29}}}):s))+'">'+h((s=(s=u(i,"bodyText")||(t!=null?u(t,"bodyText"):t))!=null?s:a,typeof s===c?s.call(l,{name:"bodyText",hash:{},data:o,loc:{start:{line:8,column:31},end:{line:8,column:45}}}):s))+((n=(s=(s=u(i,"bodyHTML")||(t!=null?u(t,"bodyHTML"):t))!=null?s:a,typeof s===c?s.call(l,{name:"bodyHTML",hash:{},data:o,loc:{start:{line:8,column:45},end:{line:8,column:61}}}):s))!=null?n:"")+`</div>
</div>

<div class="modal__footer" data-footer-region>
  <div class="modal__footer-actions">
    <button type="submit" class="`+h((s=(s=u(i,"buttonClass")||(t!=null?u(t,"buttonClass"):t))!=null?s:a,typeof s===c?s.call(l,{name:"buttonClass",hash:{},data:o,loc:{start:{line:13,column:33},end:{line:13,column:50}}}):s))+' js-submit">'+h((s=(s=u(i,"submitText")||(t!=null?u(t,"submitText"):t))!=null?s:a,typeof s===c?s.call(l,{name:"submitText",hash:{},data:o,loc:{start:{line:13,column:62},end:{line:13,column:78}}}):s))+`</button>
    `+((n=u(i,"if").call(l,t!=null?u(t,"cancelText"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:14,column:4},end:{line:14,column:92}}}))!=null?n:"")+`
  </div>
  <div data-info-region class="modal__footer-info">`+h((s=(s=u(i,"infoText")||(t!=null?u(t,"infoText"):t))!=null?s:a,typeof s===c?s.call(l,{name:"infoText",hash:{},data:o,loc:{start:{line:16,column:51},end:{line:16,column:65}}}):s))+`</div>
</div>
`},useData:!0}),LoadingModalTemplate=_Handlebars2.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s=e.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return`<div class="loading-modal__content is-animated">
  <div>`+e.escapeExpression(e.lambda((n=(n=(n=(n=(n=o&&s(o,"intl"))&&s(n,"globals"))&&s(n,"modal"))&&s(n,"loading"))&&s(n,"loadingModal"))&&s(n,"headerText"),t))+`</div>
  <div class="loading-modal__bar">
    <div class="loading-modal__bar-progress"></div>
  </div>
</div>
`},useData:!0}),i18n=intl.globals.modal.modalViews,ReplaceElRegion=Region.extend({replaceElement:!0,timeout:0}),ModalView=View.extend({className:"modal",buttonClass:"button--green",bodyClass:"modal__content",headerIconType:"far",cancelText:i18n.modalView.cancelText,submitText:i18n.modalView.submitText,regionClass:ReplaceElRegion,regions:{header:"[data-header-region]",body:{el:"[data-body-region]",regionClass:PreloadRegion.extend({timeout:0})},footer:"[data-footer-region]",info:"[data-info-region]"},childViewTriggers:{cancel:"cancel",submit:"submit"},triggers:{"click @ui.close":"cancel","click @ui.submit":"submit"},ui:{close:".js-close",submit:".js-submit"},serializeData(){return extend({},this)},template:ModalTemplate,initialize(){this.headerView&&this.showChildView("header",this.headerView),this.bodyView&&this.showChildView("body",this.bodyView),this.footerView&&this.showChildView("footer",this.footerView)},onSubmit(){this.destroy()},onCancel(){this.destroy()},disableSubmit(e=!0){this.ui.submit.prop("disabled",e)},startPreloader(){this.getRegion("body").startPreloader()}}),SidebarModalView=ModalView.extend({className:"modal--sidebar",bodyClass:"modal__content--sidebar",headerClass:"modal__header--sidebar",onAttach(){animSidebar(this.el)}}),SmallModalView=ModalView.extend({className:"modal--small",bodyClass:"modal__content--small",headerClass:"modal__header--small"}),IframeFormView=View.extend({behaviors:[IframeFormBehavior],className(){const e=this.getOption("size");return e==="small"?"modal__form-iframe--small":e==="large"?"modal__form-iframe--large":"modal__form-iframe"},template:_Handlebars2.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){return'<iframe src="/formapp/"></iframe>'},useData:!0})}),LoadingModalView=View.extend({className:"pos--absolute",template:LoadingModalTemplate,onAttach(){delay(()=>{this.destroy()},5e3)}}),ModalService=App.extend({channelName:"modal",radioRequests:{show:"showModal","show:small":"showSmall","show:custom":"showCustom","show:sidebar":"showSidebar","show:form":"showForm","show:loading":"showLoading"},initialize({modalRegion:e,modalSmallRegion:t,modalSidebarRegion:i,modalLoadingRegion:r}){this.modalRegion=e,this.modalSmallRegion=t,this.modalSidebarRegion=i,this.modalLoadingRegion=r},showModal(e){const t=ModalView.extend(e),i=new t;return this.modalRegion.show(i),i},showSmall(e){const t=SmallModalView.extend(e),i=new t;return this.modalSmallRegion.show(i),i},showCustom(e){return this.modalRegion.show(e),e},showSidebar(e){const t=SidebarModalView.extend(e),i=new t;return this.modalSidebarRegion.show(i),i},showForm(e,t,i,r){const o=new FormsService({patient:e,form:i}),n=this.showModal({headingText:t,headerIcon:"square-poll-horizontal",bodyView:new IframeFormView({model:i,size:r}),onBeforeDestroy(){o.destroy()},onSubmit(){n.disableSubmit(),Radio.request(`form${i.id}`,"send","form:submit")}});return n.disableSubmit(),this.listenTo(o,{success(){n.destroy()},ready(){n.disableSubmit(!1)},error(){n.disableSubmit(!1)}}),n},showLoading(e){const t=new LoadingModalView(e);return this.modalLoadingRegion.show(t),t}}),ErrorTemplate=_Handlebars2.template({1:function(e,t,i,r,o){var n,s=e.lambda,l=e.escapeExpression,a=e.lookupProperty||function(c,h){if(Object.prototype.hasOwnProperty.call(c,h))return c[h]};return"            "+l(s((n=(n=(n=(n=o&&a(o,"intl"))&&a(n,"globals"))&&a(n,"error"))&&a(n,"errorTemplate"))&&a(n,"notFoundMessage"),t))+`<br>
            `+l(s((n=(n=(n=(n=o&&a(o,"intl"))&&a(n,"globals"))&&a(n,"error"))&&a(n,"errorTemplate"))&&a(n,"notFoundInfo"),t))+`
`},3:function(e,t,i,r,o){var n,s=e.escapeExpression,l=t??(e.nullContext||{}),a=e.hooks.helperMissing,c=e.lookupProperty||function(h,u){if(Object.prototype.hasOwnProperty.call(h,u))return h[u]};return"            "+s(e.lambda((n=(n=(n=(n=o&&c(o,"intl"))&&c(n,"globals"))&&c(n,"error"))&&c(n,"errorTemplate"))&&c(n,"errorMessage"),t))+`<br>
            `+s((c(i,"formatMessage")||t&&c(t,"formatMessage")||a).call(l,(c(i,"intlGet")||t&&c(t,"intlGet")||a).call(l,"globals.error.errorTemplate.errorInfo",{name:"intlGet",hash:{},data:o,loc:{start:{line:20,column:28},end:{line:20,column:77}}}),{name:"formatMessage",hash:{status:t!=null?c(t,"status"):t},data:o,loc:{start:{line:20,column:12},end:{line:20,column:93}}}))+`
`},compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){var n,s=e.lambda,l=e.escapeExpression,a=t??(e.nullContext||{}),c=e.lookupProperty||function(h,u){if(Object.prototype.hasOwnProperty.call(h,u))return h[u]};return`<div class="error-page__contains">
  <div class="error-page__wrap">
    <div class="error-page__dialog">
      <div class="error-page__section">
        <svg class="svg needs-attention u-margin--b-4" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32">
          <g></g>
          <path d="M14.983 6.713c0.562-0.951 1.472-0.951 2.034 0l12.738 17.565c0.562 0.951 0.123 1.722-0.982 1.722h-25.548c-1.104 0-1.544-0.771-0.982-1.722l12.738-17.565z" fill="#E65140" />
        </svg>

        <h2 class="error-page__heading">`+l(s((n=(n=(n=(n=o&&c(o,"intl"))&&c(n,"globals"))&&c(n,"error"))&&c(n,"errorTemplate"))&&c(n,"errorHeader"),t))+`</h2>
      </div>
      <div class="error-page__section">
        <p>
`+((n=c(i,"if").call(a,t!=null?c(t,"is404"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:14,column:10},end:{line:17,column:17}}}))!=null?n:"")+((n=c(i,"if").call(a,t!=null?c(t,"status"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:18,column:10},end:{line:21,column:17}}}))!=null?n:"")+`        </p>
        <a class="js-back button--blue u-margin--t-16">`+l(s((n=(n=(n=(n=o&&c(o,"intl"))&&c(n,"globals"))&&c(n,"error"))&&c(n,"errorTemplate"))&&c(n,"backBtn"),t))+`</a>
      </div>
    </div>
    <svg class="svg roundingwell-logo u-margin--t-16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="116" height="21" viewBox="0 0 185 32">
      <g></g>
      <path d="M40.975 11.456c-1.339 0.082-2.624 0.683-3.499 1.995v8.501c0 0.547-0.465 1.011-1.039 1.011h-0.027c-0.547-0.027-0.984-0.465-0.984-1.011v-11.535c0-0.519 0.465-0.984 1.066-0.984 0.519 0 0.984 0.465 0.984 0.984v1.312c0.793-1.039 2.105-2.351 3.635-2.351 0.492 0 0.929 0.41 0.929 0.957 0 0.602-0.465 1.093-1.066 1.121z" fill="#cccccc" />
      <path d="M49.53 23.128c-4.018 0-6.533-3.116-6.533-6.943 0-3.827 2.515-6.916 6.533-6.916s6.533 3.089 6.533 6.916c0 3.826-2.514 6.943-6.533 6.943zM49.53 11.101c-2.815 0-4.401 2.406-4.401 5.084 0 2.706 1.585 5.111 4.401 5.111 2.815 0 4.373-2.406 4.373-5.111 0-2.679-1.558-5.084-4.373-5.084z" fill="#cccccc" />
      <path d="M68.636 22.964c-0.547 0-1.011-0.465-1.011-1.011v-1.011c-1.011 1.148-2.733 2.187-4.701 2.187-2.761 0-4.209-1.34-4.209-4.21v-8.501c0-0.519 0.465-0.984 1.066-0.984 0.519 0 0.984 0.465 0.984 0.984v7.872c0 2.323 1.175 3.007 2.952 3.007 1.613 0 3.143-0.929 3.909-1.995v-8.883c0-0.519 0.465-0.984 1.066-0.984 0.519 0 0.984 0.465 0.984 0.984v11.535c0 0.546-0.465 1.011-1.039 1.011z" fill="#cccccc" />
      <path d="M83.013 22.964c-0.547 0-1.011-0.465-1.011-1.011v-7.79c0-2.323-1.175-3.062-2.952-3.062-1.613 0-3.143 0.984-3.909 2.050v8.801c0 0.547-0.465 1.011-1.039 1.011-0.547 0-1.011-0.465-1.011-1.011v-11.535c0-0.519 0.465-0.984 1.066-0.984 0.519 0 0.984 0.465 0.984 0.984v1.093c0.929-1.093 2.733-2.242 4.701-2.242 2.761 0 4.21 1.394 4.21 4.264v8.419c-0 0.547-0.465 1.012-1.039 1.012z" fill="#cccccc" />
      <path d="M98.046 22.964c-0.547 0-1.011-0.465-1.011-1.011v-1.121c-0.984 1.34-2.597 2.296-4.455 2.296-3.444 0-5.877-2.624-5.877-6.915 0-4.21 2.405-6.943 5.877-6.943 1.777 0 3.389 0.875 4.455 2.324v-6.205c0-0.519 0.465-0.984 1.066-0.984 0.519 0 0.984 0.465 0.984 0.984v16.564c0 0.547-0.464 1.012-1.038 1.012zM97.035 13.233c-0.738-1.148-2.324-2.132-3.964-2.132-2.651 0-4.237 2.187-4.237 5.112 0 2.924 1.585 5.084 4.237 5.084 1.64 0 3.226-0.929 3.964-2.077v-5.986z" fill="#cccccc" />
      <path d="M103.512 22.964c-0.546 0-1.011-0.465-1.011-1.011v-11.535c0-0.519 0.465-0.984 1.066-0.984 0.52 0 0.984 0.465 0.984 0.984v11.535c0 0.547-0.465 1.012-1.039 1.012z" fill="#cccccc" />
      <path d="M117.89 22.964c-0.547 0-1.012-0.465-1.012-1.011v-7.79c0-2.323-1.175-3.062-2.952-3.062-1.613 0-3.143 0.984-3.909 2.050v8.801c0 0.547-0.464 1.011-1.038 1.011-0.547 0-1.011-0.465-1.011-1.011v-11.535c0-0.519 0.464-0.984 1.066-0.984 0.52 0 0.984 0.465 0.984 0.984v1.093c0.93-1.093 2.734-2.242 4.702-2.242 2.76 0 4.209 1.394 4.209 4.264v8.419c0 0.547-0.464 1.012-1.038 1.012z" fill="#cccccc" />
      <path d="M127.647 28.157c-1.941 0-3.499-0.355-4.947-1.585-0.191-0.164-0.301-0.41-0.301-0.684 0-0.465 0.41-0.875 0.902-0.875 0.218 0 0.41 0.055 0.574 0.191 1.039 0.929 2.214 1.257 3.772 1.257 2.187 0 4.237-1.066 4.237-3.964v-1.886c-0.957 1.34-2.57 2.351-4.428 2.351-3.444 0-5.876-2.569-5.876-6.833 0-4.237 2.405-6.861 5.876-6.861 1.777 0 3.362 0.875 4.428 2.324v-1.175c0-0.519 0.464-0.984 1.066-0.984 0.52 0 0.984 0.465 0.984 0.984v11.999c0 4.373-3.061 5.74-6.286 5.74zM131.884 13.233c-0.711-1.148-2.296-2.132-3.936-2.132-2.652 0-4.237 2.105-4.237 5.030 0 2.897 1.585 5.029 4.237 5.029 1.64 0 3.225-1.011 3.936-2.16v-5.767z" fill="#cccccc" />
      <path d="M155.309 11.237l-3.198 10.332c-0.246 0.82-1.039 1.394-1.886 1.394h-0.055c-0.875 0-1.64-0.574-1.886-1.394l-2.652-8.391-2.651 8.391c-0.246 0.82-1.039 1.394-1.913 1.394h-0.055c-0.848 0-1.613-0.574-1.859-1.394l-3.225-10.332c-0.027-0.137-0.055-0.273-0.055-0.41 0-0.684 0.574-1.394 1.449-1.394 0.629 0 1.23 0.41 1.394 1.011l2.515 8.665 2.788-8.528c0.219-0.683 0.848-1.148 1.64-1.148 0.711 0 1.34 0.465 1.585 1.148l2.788 8.528 2.514-8.665c0.164-0.601 0.766-1.011 1.395-1.011 0.847 0 1.449 0.656 1.449 1.394-0.001 0.137-0.028 0.273-0.083 0.41z" fill="#cccccc" />
      <path d="M168.073 17.141h-8.692c0.191 1.968 1.695 3.635 4.155 3.635 0.956 0 2.049-0.3 2.952-0.875 0.191-0.109 0.41-0.164 0.601-0.164 0.602 0 1.23 0.492 1.23 1.202 0 1.503-3.389 2.187-5.084 2.187-3.964 0-6.915-2.761-6.915-6.943 0-3.827 2.788-6.916 6.697-6.916 3.089 0 5.33 1.859 6.15 4.701 0.164 0.547 0.328 1.175 0.328 1.749 0 0.765-0.629 1.421-1.421 1.421zM163.017 11.62c-2.406 0-3.526 1.913-3.663 3.499h7.326c-0.055-1.53-1.094-3.499-3.663-3.499z" fill="#cccccc" />
      <path d="M173.129 22.964c-0.82 0-1.449-0.656-1.449-1.449v-15.689c0-0.765 0.629-1.421 1.503-1.421 0.766 0 1.422 0.656 1.422 1.421v15.689c-0 0.793-0.656 1.449-1.477 1.449z" fill="#cccccc" />
      <path d="M179.060 22.964c-0.82 0-1.449-0.656-1.449-1.449v-15.689c0-0.765 0.629-1.421 1.503-1.421 0.766 0 1.422 0.656 1.422 1.421v15.689c-0 0.793-0.656 1.449-1.477 1.449z" fill="#cccccc" />
      <path d="M28.781 14.834c-0.117-1.519-0.498-3.012-1.117-4.385-0.618-1.374-1.471-2.627-2.501-3.694-1.030-1.068-2.235-1.949-3.546-2.598-1.311-0.651-2.727-1.067-4.16-1.23-1.432-0.164-2.878-0.081-4.264 0.24-1.385 0.321-2.702 0.883-3.877 1.644-1.175 0.761-2.208 1.719-3.046 2.814-0.838 1.094-1.481 2.325-1.893 3.618-0.414 1.293-0.596 2.648-0.55 3.983l0.263 0.003c0.076-1.305 0.375-2.585 0.879-3.768 0.503-1.183 1.208-2.268 2.067-3.196 0.858-0.929 1.87-1.701 2.971-2.277 1.102-0.576 2.294-0.955 3.505-1.118 1.209-0.164 2.442-0.116 3.617 0.132 1.176 0.247 2.296 0.697 3.299 1.318 1.004 0.62 1.89 1.411 2.614 2.318 0.724 0.907 1.283 1.93 1.649 3.006 0.367 1.076 0.54 2.204 0.521 3.323-0.020 1.122-0.23 2.224-0.617 3.247-0.386 1.024-0.949 1.969-1.648 2.787-0.699 0.818-1.534 1.507-2.449 2.031-0.915 0.525-1.91 0.883-2.925 1.061-1.014 0.178-2.057 0.177-3.060 0.007-1.001-0.169-1.954-0.509-2.815-0.996-0.295-0.167-0.578-0.352-0.85-0.551l4.686-7.132-0.102-0.083-10.27 10.316 0.106 0.099c0.083 0.076 0.156 0.142 0.236 0.211 0.157 0.137 0.318 0.271 0.48 0.401 0.326 0.261 0.662 0.506 1.008 0.737 0.201 0.134 0.405 0.263 0.613 0.386 0.506 0.302 1.029 0.573 1.566 0.81 1.513 0.669 3.135 1.066 4.76 1.18 0.813 0.057 1.622 0.045 2.428-0.035 0.805-0.080 1.603-0.229 2.379-0.445 1.554-0.431 3.020-1.132 4.315-2.052 1.296-0.918 2.423-2.054 3.321-3.338 0.9-1.283 1.572-2.715 1.978-4.21 0.408-1.495 0.548-3.048 0.429-4.565z" fill="#cccccc" />
    </svg>
  </div>
</div>
`},useData:!0}),ErrorView=View.extend({className:"error-page",template:ErrorTemplate,triggers:{"click .js-back":"click:back"},onClickBack(){Radio.trigger("event-router","default")},templateContext(){return this.options}}),legacyRoots=["worklist","patient","patient-action","flow","schedule","clinicians","dashboards","form","program","programs","program-flow"],ErrorApp=RouterApp.extend({eventRoutes:{notFound:{action:"show404",route:"404",root:!0},unknownError:{action:"showError",route:"unknown-error",root:!0}},initialize(){this.router.route("*unknown","404",bind$2(this.handleUnknown,this))},viewEvents:{"click:back":"stop"},onBeforeStop(){this.getRegion().empty()},handleUnknown(){const e=getRootRoute();if(contains(legacyRoots,e)){const t=Radio.request("bootstrap","currentWorkspace");this.replaceUrl(`/${t.get("slug")}${location.pathname}`);return}this.start(),this.show404()},show404(){this.showView(new ErrorView({is404:!0}))},showError(e){this.showView(new ErrorView({status:e}))}}),px=e=>`${parseFloat(e)}px`,userActivityCh$1=Radio.channel("user-activity"),topRegionCh=Radio.channel("top-region"),TopRegionBehavior=Behavior.extend({regionName:"region",className:"fill-window",initialize(e){this.mergeOptions(e,["regionName","className"])},onInitialize(){this.region=this.view.getRegion(this.regionName),this.listenTo(this.region,{empty:bind$2(this.view.triggerMethod,this.view,"region:empty"),show:bind$2(this.view.triggerMethod,this.view,"region:show")})},onRegionShow(){this.listenTo(userActivityCh$1,"body:down",this.onBodyDown),this.listenTo(userActivityCh$1,"iframe:focus",this.onIframeFocus),this.$el.addClass(this.className)},onRegionEmpty(){this.stopListening(userActivityCh$1),this.region.isSwappingView()||this.$el.removeClass(this.className)},onBodyDown({target:e}){this.emptyOnActvity(e)},onIframeFocus(e){this.emptyOnActvity(e)},emptyOnActvity(e){!this.region.hasView()||topRegionCh.request("contains",this.view,e)||this.region.empty()}}),userActivityCh=Radio.channel("user-activity"),historyCh=Radio.channel("history");function preventRegionClose(){return this.getRegion("region").hasView()}const AppView=View.extend({className:"app-frame",template:_Handlebars2.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){return`
    <div class="app-frame__nav js-nav" data-nav-region></div>
    <div class="app-frame__content flex-region" data-content-region></div>
    <div class="app-frame__sidebar" data-sidebar-region></div>
  `},useData:!0}),ui:{nav:".js-nav"},regions:{nav:"[data-nav-region]",content:{el:"[data-content-region]",regionClass:PreloadRegion},sidebar:"[data-sidebar-region]"},toggleNav(e){this.ui.nav.toggleClass("is-hidden",!e)}}),TopRegionView=View.extend({behaviors:[TopRegionBehavior],regionClass:Region.extend({replaceElement:!0}),template:_Handlebars2.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){return"<div data-region></div>"},useData:!0}),regions:{region:"[data-region]"},contains(e){const t=this.getRegion("region");if(t.hasView()&&(t.currentView.el===e||this.Dom.hasEl(t.currentView.el,e))||this.ignoreEl===e||this.ignoreEl&&this.Dom.hasEl(this.ignoreEl,e))return!0},empty(){this.region.empty()}}),PreloaderRegionView=TopRegionView.extend({contains:preventRegionClose,onRender(){this.showChildView("region",new PreloaderView)}}),ModalRegionView=TopRegionView.extend({className:"fill-window--dark",behaviors:[{behaviorClass:TopRegionBehavior,className:"is-shown"}],initialize(e){this.mergeOptions(e,["$body","setLocation","contains"]),this.region=this.getRegion("region");const t=Radio.channel("hotkey");this.listenTo(t,"close",this.empty)},onRegionShow(){this.listenTo(historyCh,"change:route",this.empty),this.listenTo(userActivityCh,"window:resize",this.setLocation),this.setLocation()},onRegionEmpty(){this.stopListening(userActivityCh)},setLocation(){const e=this.region.currentView,t=e.$el.outerWidth(),i=e.$el.outerHeight(),r=this.$body.height(),n=this.$body.width()/2-t/2,s=r/3-i/3;e.$el.css({left:px(n),top:px(s)})},contains(e,t){if(!this.region.hasView())return!1;const i=this.region.currentView.el;if(i===e||this.Dom.hasEl(i,e)||this!==t)return!0}}),popDefaults={align:"left",direction:"down",left:0,outerHeight:0,outerWidth:0,popWidth:null,top:0,windowPadding:5},PopRegionView=TopRegionView.extend({initialize({$body:e}){this.region=this.getRegion("region"),this.$body=e;const t=Radio.channel("hotkey");this.listenTo(t,"close",this.empty)},onRegionShow(e,t,i){t.$el.addClass("app-frame__pop-region");const r=extend({},popDefaults,i);this.ignoreEl=i.ignoreEl,this.listenTo(userActivityCh,"window:resize",this.empty),this.listenTo(historyCh,"change:route",this.empty),this.listenTo(t,"render render:children",partial(this.setLocation,r)),this.setLocation(r)},onRegionEmpty(e,t){t.$el.removeClass("app-frame__pop-region"),this.stopListening(userActivityCh),this.stopListening(historyCh),this.stopListening(t)},setLocation(e){const t=this.region.currentView;e.popWidth&&t.$el.css({width:px(e.popWidth)});const i=t.$el.outerHeight(),r=this.setDirection(i,e),o=e.popWidth||t.$el.outerWidth(),n=this.setAlign(o,e);t.$el.css({top:px(r),left:px(n)})},setAlign(e,{left:t,align:i,windowPadding:r,outerWidth:o}){if(i==="right"&&(t+=o-e),t<r)return r;const n=this.$body.width();return t+e>n-r?n-e-r:t},setDirection(e,{top:t,direction:i,windowPadding:r,outerHeight:o}){const n=this.$body.height();return i==="down"?t+o+e+r>n?(i="forceUp",this.setDirection(e,{top:t,direction:i,windowPadding:r,outerHeight:o})):o+t:(t-=e,t>=r?t:i==="forceUp"?n-r-e:(i="down",this.setDirection(e,{top:t,direction:i,windowPadding:r,outerHeight:o})))}}),TooltipRegionView=TopRegionView.extend({initialize({$body:e}){this.region=this.getRegion("region"),this.$body=e},onRegionShow(e,t,i){if(this.listenTo(userActivityCh,"window:resize",this.empty),this.ignoreEl=i.ignoreEl,i.orientation==="horizontal"){this.setHorizontalLocation(i);return}this.setVerticalLocation(i)},onRegionEmpty(e){this.stopListening(userActivityCh)},addClass(e){this.region.currentView.$el.addClass(e)},setTop(e){this.region.currentView.$el.css({top:px(e)})},setLeft(e){this.region.currentView.$el.css({left:px(e)})},setHorizontalLocation({left:e,top:t,outerWidth:i,outerHeight:r}){const o=this.region.currentView,n=(e+i)/this.$body.width(),s=(t+r/2)/this.$body.height();s<.25?(this.addClass("is-top"),this.setTop(t+r/2)):s>.75?(this.addClass("is-bottom"),this.setTop(t+r/2-o.$el.outerHeight())):this.setTop(t-o.$el.outerHeight()/2+r/2),n>.6?(this.addClass("is-right-arrow"),this.setLeft(e-o.$el.outerWidth())):(this.addClass("is-left-arrow"),this.setLeft(e+i))},setVerticalLocation({left:e,top:t,outerWidth:i,outerHeight:r}){const o=this.region.currentView,n=(e+i/2)/this.$body.width(),s=(t+r)/this.$body.height();n<.15?(this.addClass("is-left"),this.setLeft(e+i/2)):n>.85?(this.addClass("is-right"),this.setLeft(e+i/2-o.$el.outerWidth())):this.setLeft(e-o.$el.outerWidth()/2+i/2),s>.6?(this.addClass("is-bottom-arrow"),this.setTop(t-o.$el.outerHeight())):(this.addClass("is-top-arrow"),this.setTop(t+r))}}),RootView=CollectionView.extend({viewComparator:!1,el:"#root",template:_Handlebars2.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,r,o){return""},useData:!0}),AppView,initialize(){this.render(),this.regions=[];const e=this.$el;Radio.reply("top-region","contains",this.contains,this),this.appView=new this.AppView,this.addChildView(this.appView),this.addRegionView("tooltip",new TooltipRegionView({$body:e})),this.addRegionView("modalSidebar",new ModalRegionView({$body:e,setLocation:noop})),this.addRegionView("modal",new ModalRegionView({$body:e})),this.addRegionView("modalSmall",new ModalRegionView({$body:e})),this.addRegionView("modalLoading",new ModalRegionView({$body:e,contains:preventRegionClose})),this.addRegionView("alert",new TopRegionView),this.addRegionView("pop",new PopRegionView({$body:e})),this.addRegionView("preloader",new PreloaderRegionView),this.addRegionView("error",new TopRegionView)},addRegionView(e,t){t.name=e,this.addChildView(t),this.regions[e]=t.getRegion("region")},getRegion(e){return this.regions[e]},contains(e,t){const i=this.children.findIndexByView(e);for(let r=this.children.length-1;i<=r;r--)if(this.children.findByIndex(r).contains(t,e))return!0}}),$document=$(document),Application=App.extend({channelName:"app",radioRequests:{"show:pop":"showPop"},initialize(){initPlatform()},onBeforeStart(){new BootstrapService({name:appConfig.name}),this.setView(new RootView),this.configComponents(),this.startServices(),this.setListeners(),new ErrorApp({region:this.getRegion("error")})},configComponents(){Tooltip.setRegion(this.getRegion("tooltip"));const e=this.getRegion("pop");Datepicker.setRegion(e),Droplist.setPopRegion(e),Optionlist.setRegion(e)},showPop(e,t){return this.getRegion("pop").show(e,t)},startServices(){new AlertService({region:this.getRegion("alert")}),new LastestListService,new ModalService({modalRegion:this.getRegion("modal"),modalSmallRegion:this.getRegion("modalSmall"),modalSidebarRegion:this.getRegion("modalSidebar"),modalLoadingRegion:this.getRegion("modalLoading")})},setListeners(){$(window).on({"resize.app"(){Radio.trigger("user-activity","window:resize")},beforeunload:()=>{this.stop()}}),$document.on("keydown.app",function(e){Radio.trigger("user-activity","document:keydown",e)}),this.setMouseListeners(),this.setHotkeyListeners()},setMouseListeners(){$document.on("mouseover.app",function(e){Radio.trigger("user-activity","document:mouseover",e)}),$document.on("mouseleave.app",function(e){Radio.trigger("user-activity","document:mouseleave",e)}),$("body").on("pointerdown.app",function(e){Radio.trigger("user-activity","body:down",e)})},setHotkeyListeners(){$document.on("keydown.app",null,"/",function(e){Radio.trigger("hotkey","search",e)}),$document.on("keydown.app",null,"esc",function(e){Radio.trigger("hotkey","close",e)})},beforeStart(){return[Radio.request("bootstrap","fetch"),__vitePreload(()=>import("./20240621-app-frame_app-JglqrLX1.js").then(e=>e.o),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))]},onFail(e,t){addError(get(t,"responseData",t)),(t==="No workspaces found"||get(t,["response","status"])===401&&get(t,["responseData","errors",0,"code"])==="5000")&&this.getRegion("preloader").show(new PreloaderView({notSetup:!0}))},onStart(e,t,{default:i}){if(!t.hasTeam()||!t.get("enabled")){this.getRegion("preloader").show(new PreloaderView({notSetup:!0}));return}this.emptyRegion("preloader");const r=this.addChildApp("appFrame",i);this.listenToOnce(r,"before:start",this.startHistory),r.start({view:this.getView().appView})},startHistory(){Backbone.history.start({pushState:!0}),new HistoryService},emptyRegion(e){return this.getRegion(e).empty()}});function startApp(){new Application().start()}const app=Object.freeze(Object.defineProperty({__proto__:null,Application,startApp},Symbol.toStringTag,{value:"Module"}));export{Droplist as D,FormsService as F,InputWatcherBehavior as I,Optionlist as O,PicklistBehavior as P,Tooltip as T,animSidebar as a,Datepicker as b,InputFocusBehavior as c,Picklist$1 as d,app as e,store as s};
