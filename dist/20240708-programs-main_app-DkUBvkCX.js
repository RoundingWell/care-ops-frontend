import{R as Qt}from"./20240708-iframe-form-iEdGnNF0.js";import{V as A,_ as S,R as v,C as ct,b as Pt,B as it,a as Jt}from"./20240708-runtime-BXvT6bd-.js";import{A as ut}from"./20240708-app-B2MCT9A2.js";import{a as Ot,P as mt,b as en}from"./20240708-workspaces-C5ZMaYO1.js";import{P as We}from"./20240708-prelogin_views-C2vioOh0.js";import{S as St}from"./20240708-list-pages-CMZRr94d.js";import{b as tn,I as nn}from"./20240708-index-IPow8CrK.js";import{i as xe}from"./20240708-index-Cs2PJlZg.js";import{D as on,O as rn}from"./20240708-app-C8ogM37O.js";import{B as xt,j as Tt,k as At,l as It,m as an}from"./20240708-app-frame_app-BHFyliMl.js";import"./20240708-parsePhoneNumber-DUok-7-R.js";/* empty css                        */const ln=A.extend({tagName:"tr",template:S.template({compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i=t.lookupProperty||function(l,s){if(Object.prototype.hasOwnProperty.call(l,s))return l[s]};return`
    <td class="table-empty-list">
      <h2>`+t.escapeExpression(t.lambda((o=(o=(o=a&&i(a,"intl"))&&i(o,"programs"))&&i(o,"programsAllViews"))&&i(o,"emptyView"),e))+`</h2>
    </td>
  `},useData:!0})}),sn=A.extend({className:"table-list__item",tagName:"tr",template:S.template({1:function(t,e,n,r,a){return" is-published"},3:function(t,e,n,r,a){var o=t.lookupProperty||function(i,l){if(Object.prototype.hasOwnProperty.call(i,l))return i[l]};return t.escapeExpression((o(n,"fas")||e&&o(e,"fas")||t.hooks.helperMissing).call(e??(t.nullContext||{}),"toggle-on",{name:"fas",hash:{},data:a,loc:{start:{line:4,column:23},end:{line:4,column:42}}}))},5:function(t,e,n,r,a){var o=t.lookupProperty||function(i,l){if(Object.prototype.hasOwnProperty.call(i,l))return i[l]};return t.escapeExpression((o(n,"far")||e&&o(e,"far")||t.hooks.helperMissing).call(e??(t.nullContext||{}),"toggle-off",{name:"far",hash:{},data:a,loc:{start:{line:4,column:50},end:{line:4,column:70}}}))},compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i,l=e??(t.nullContext||{}),s=t.hooks.helperMissing,u=t.escapeExpression,m=t.lookupProperty||function(c,d){if(Object.prototype.hasOwnProperty.call(c,d))return c[d]};return`
    <td class="table-list__cell w-60">`+u((i=(i=m(n,"name")||(e!=null?m(e,"name"):e))!=null?i:s,typeof i=="function"?i.call(l,{name:"name",hash:{},data:a,loc:{start:{line:2,column:38},end:{line:2,column:48}}}):i))+`</td>
    <td class="table-list__cell w-20 programs-list__published`+((o=m(n,"if").call(l,e!=null?m(e,"published"):e,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a,loc:{start:{line:3,column:61},end:{line:3,column:98}}}))!=null?o:"")+`">
      `+((o=m(n,"if").call(l,e!=null?m(e,"published"):e,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.program(5,a,0),data:a,loc:{start:{line:4,column:6},end:{line:4,column:77}}}))!=null?o:"")+`
      `+u((m(n,"formatMessage")||e&&m(e,"formatMessage")||s).call(l,(m(n,"intlGet")||e&&m(e,"intlGet")||s).call(l,"programs.programsAllViews.itemView.published",{name:"intlGet",hash:{},data:a,loc:{start:{line:5,column:22},end:{line:5,column:78}}}),{name:"formatMessage",hash:{published:e!=null?m(e,"published"):e},data:a,loc:{start:{line:5,column:6},end:{line:5,column:100}}}))+`
    </td>
    <td class="table-list__cell w-20 programs-list__updated-ts">`+u((m(n,"formatDateTime")||e&&m(e,"formatDateTime")||s).call(l,e!=null?m(e,"updated_at"):e,"TIME_OR_DAY",{name:"formatDateTime",hash:{},data:a,loc:{start:{line:7,column:64},end:{line:7,column:107}}}))+`</td>
  `},useData:!0}),templateContext(){return{published:!!this.model.get("published_at")}},triggers:{click:"click"},onClick(){v.trigger("event-router","program:details",this.model.id)}}),cn=A.extend({className:"flex-region",template:S.template({compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i=e??(t.nullContext||{}),l=t.hooks.helperMissing,s=t.escapeExpression,u=t.lambda,m=t.lookupProperty||function(c,d){if(Object.prototype.hasOwnProperty.call(c,d))return c[d]};return`
    <div class="list-page__header">
      <div class="flex list-page__title">
        <div class="flex list-page__title-filter">
          <span class="list-page__title-icon">`+s((m(n,"far")||e&&m(e,"far")||l).call(i,"screwdriver-wrench",{name:"far",hash:{},data:a,loc:{start:{line:5,column:46},end:{line:5,column:74}}}))+"</span>"+s(u((o=(o=(o=(o=a&&m(a,"intl"))&&m(o,"programs"))&&m(o,"programsAllViews"))&&m(o,"layoutView"))&&m(o,"title"),e))+`
        </div>
      </div>
      <button class="u-margin--b-16 button-primary js-add">`+s((m(n,"far")||e&&m(e,"far")||l).call(i,"circle-plus",{name:"far",hash:{},data:a,loc:{start:{line:8,column:59},end:{line:8,column:80}}}))+"<span>"+s(u((o=(o=(o=a&&m(a,"intl"))&&m(o,"programs"))&&m(o,"programsAllViews"))&&m(o,"addProgramBtn"),e))+`</span></button>
    </div>
    <div class="flex-region list-page__list">
      <table class="w-100"><tr>
        <td class="table-list__header w-60">`+s(u((o=(o=(o=(o=a&&m(a,"intl"))&&m(o,"programs"))&&m(o,"programsAllViews"))&&m(o,"layoutView"))&&m(o,"programHeader"),e))+`</td>
        <td class="table-list__header w-20">`+s(u((o=(o=(o=(o=a&&m(a,"intl"))&&m(o,"programs"))&&m(o,"programsAllViews"))&&m(o,"layoutView"))&&m(o,"stateHeader"),e))+`</td>
        <td class="table-list__header w-20">`+s(u((o=(o=(o=(o=a&&m(a,"intl"))&&m(o,"programs"))&&m(o,"programsAllViews"))&&m(o,"layoutView"))&&m(o,"updatedHeader"),e))+`</td>
      </tr></table>
      <div class="flex-region" data-list-region></div>
    </div>
  `},useData:!0}),regions:{list:{el:"[data-list-region]",regionClass:We}},triggers:{"click .js-add":"click:add"}}),un=ct.extend({className:"table-list",tagName:"table",childView:sn,viewComparator(t,e){return Ot("desc",t.model.get("updated_at"),e.model.get("updated_at"))},emptyView:ln}),mn=ut.extend({viewTriggers:{"click:add":"click:add"},onBeforeStart(){this.showView(new cn),this.getRegion("list").startPreloader()},beforeStart(){return v.request("entities","fetch:programs:collection")},onStart(t,e){this.programs=e,this.showChildView("list",new un({collection:e}))},onClickAdd(){const t=v.request("entities","programs:model",{}),e=v.request("sidebar","start","program",{program:t});this.listenTo(e,"stop",()=>{t.isNew()||this.programs.add(t)})}}),fn=S.template({1:function(t,e,n,r,a){var o,i=t.lookupProperty||function(l,s){if(Object.prototype.hasOwnProperty.call(l,s))return l[s]};return"<em>"+t.escapeExpression(t.lambda((o=(o=(o=(o=(o=a&&i(a,"intl"))&&i(o,"programs"))&&i(o,"program"))&&i(o,"workflows"))&&i(o,"actionItemTemplate"))&&i(o,"newProgramAction"),e))+"</em>"},3:function(t,e,n,r,a){var o=t.lookupProperty||function(i,l){if(Object.prototype.hasOwnProperty.call(i,l))return i[l]};return'      <button class="js-form button-secondary--compact">'+t.escapeExpression((o(n,"far")||e&&o(e,"far")||t.hooks.helperMissing).call(e??(t.nullContext||{}),"square-poll-horizontal",{name:"far",hash:{},data:a,loc:{start:{line:14,column:56},end:{line:14,column:88}}}))+`</button>
`},compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i,l=e??(t.nullContext||{}),s=t.hooks.helperMissing,u=t.escapeExpression,m="function",c=t.lookupProperty||function(d,p){if(Object.prototype.hasOwnProperty.call(d,p))return d[p]};return`<td class="table-list__cell w-40">
  <span class="workflows__action-icon">`+u((c(n,"far")||e&&c(e,"far")||s).call(l,e!=null?c(e,"icon"):e,{name:"far",hash:{},data:a,loc:{start:{line:2,column:39},end:{line:2,column:51}}}))+"</span>"+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:2,column:58},end:{line:2,column:83}}}):i))+`<span class="workflows__action-name">
    `+u((i=(i=c(n,"name")||(e!=null?c(e,"name"):e))!=null?i:s,typeof i===m?i.call(l,{name:"name",hash:{},data:a,loc:{start:{line:4,column:4},end:{line:4,column:14}}}):i))+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:4,column:14},end:{line:4,column:39}}}):i))+((o=c(n,"unless").call(l,e!=null?c(e,"name"):e,{name:"unless",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a,loc:{start:{line:5,column:4},end:{line:5,column:116}}}))!=null?o:"")+`</span>
</td>
<td class="table-list__cell w-60">
  <span class="table-list__meta" data-behavior-region></span>`+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:9,column:61},end:{line:9,column:86}}}):i))+'<span class="table-list__meta" data-owner-region></span>'+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:10,column:58},end:{line:10,column:83}}}):i))+'<span class="table-list__meta" data-due-region></span>'+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:11,column:56},end:{line:11,column:81}}}):i))+`<span class="table-list__meta">
`+((o=c(n,"if").call(l,e!=null?c(e,"hasForm"):e,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a,loc:{start:{line:13,column:4},end:{line:15,column:12}}}))!=null?o:"")+"  </span>"+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:16,column:9},end:{line:16,column:34}}}):i))+'<span class="workflows__item-ts">'+u((c(n,"formatDateTime")||e&&c(e,"formatDateTime")||s).call(l,e!=null?c(e,"updated_at"):e,"TIME_OR_DAY",{name:"formatDateTime",hash:{},data:a,loc:{start:{line:17,column:35},end:{line:17,column:78}}}))+`</span>
</td>
`},useData:!0}),dn=S.template({1:function(t,e,n,r,a){var o,i=t.lookupProperty||function(l,s){if(Object.prototype.hasOwnProperty.call(l,s))return l[s]};return"<em>"+t.escapeExpression(t.lambda((o=(o=(o=(o=(o=a&&i(a,"intl"))&&i(o,"programs"))&&i(o,"program"))&&i(o,"workflows"))&&i(o,"flowItemTemplate"))&&i(o,"newProgramFlow"),e))+"</em>"},3:function(t,e,n,r,a){var o,i=t.lookupProperty||function(l,s){if(Object.prototype.hasOwnProperty.call(l,s))return l[s]};return(o=i(n,"if").call(e??(t.nullContext||{}),e!=null?i(e,"isAutomated"):e,{name:"if",hash:{},fn:t.program(4,a,0),inverse:t.program(6,a,0),data:a,loc:{start:{line:11,column:6},end:{line:15,column:13}}}))!=null?o:""},4:function(t,e,n,r,a){var o=t.lookupProperty||function(i,l){if(Object.prototype.hasOwnProperty.call(i,l))return i[l]};return'        <span class="workflows-action--automated">'+t.escapeExpression((o(n,"far")||e&&o(e,"far")||t.hooks.helperMissing).call(e??(t.nullContext||{}),"bolt",{name:"far",hash:{},data:a,loc:{start:{line:12,column:50},end:{line:12,column:64}}}))+`</span>
`},6:function(t,e,n,r,a){var o=t.lookupProperty||function(i,l){if(Object.prototype.hasOwnProperty.call(i,l))return i[l]};return'        <span class="workflows-action--published">'+t.escapeExpression((o(n,"far")||e&&o(e,"far")||t.hooks.helperMissing).call(e??(t.nullContext||{}),"circle-play",{name:"far",hash:{},data:a,loc:{start:{line:14,column:50},end:{line:14,column:71}}}))+`</span>
`},8:function(t,e,n,r,a){var o=t.lookupProperty||function(i,l){if(Object.prototype.hasOwnProperty.call(i,l))return i[l]};return'      <span class="workflows-action--draft">'+t.escapeExpression((o(n,"far")||e&&o(e,"far")||t.hooks.helperMissing).call(e??(t.nullContext||{}),"pen-to-square",{name:"far",hash:{},data:a,loc:{start:{line:17,column:44},end:{line:17,column:67}}}))+`</span>
`},compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i,l=e??(t.nullContext||{}),s=t.hooks.helperMissing,u=t.escapeExpression,m="function",c=t.lookupProperty||function(d,p){if(Object.prototype.hasOwnProperty.call(d,p))return d[p]};return`<td class="table-list__cell w-40">
  <span class="workflows__flow-icon">`+u((c(n,"fas")||e&&c(e,"fas")||s).call(l,"folder",{name:"fas",hash:{},data:a,loc:{start:{line:2,column:37},end:{line:2,column:53}}}))+"</span>"+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:2,column:60},end:{line:2,column:85}}}):i))+`<span class="workflows__flow-name">
    `+u((i=(i=c(n,"name")||(e!=null?c(e,"name"):e))!=null?i:s,typeof i===m?i.call(l,{name:"name",hash:{},data:a,loc:{start:{line:4,column:4},end:{line:4,column:14}}}):i))+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:4,column:14},end:{line:4,column:39}}}):i))+((o=c(n,"unless").call(l,e!=null?c(e,"name"):e,{name:"unless",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a,loc:{start:{line:5,column:4},end:{line:5,column:112}}}))!=null?o:"")+`</span>
</td>
<td class="table-list__cell w-60">
  <span class="table-list__meta workflows__flow-status">
`+((o=c(n,"if").call(l,e!=null?c(e,"published"):e,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.program(8,a,0),data:a,loc:{start:{line:10,column:4},end:{line:18,column:11}}}))!=null?o:"")+"  </span>"+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:19,column:9},end:{line:19,column:34}}}):i))+'<span class="table-list__meta" data-owner-region></span>'+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:20,column:58},end:{line:20,column:83}}}):i))+'<span class="workflows__item-ts">'+u((c(n,"formatDateTime")||e&&c(e,"formatDateTime")||s).call(l,e!=null?c(e,"updated_at"):e,"TIME_OR_DAY",{name:"formatDateTime",hash:{},data:a,loc:{start:{line:21,column:35},end:{line:21,column:78}}}))+`</span>
</td>
`},useData:!0}),pn=S.template({compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i=t.lookupProperty||function(l,s){if(Object.prototype.hasOwnProperty.call(l,s))return l[s]};return`<div>
  <span class="workflows__tab--selected">`+t.escapeExpression(t.lambda((o=(o=(o=(o=(o=a&&i(a,"intl"))&&i(o,"programs"))&&i(o,"program"))&&i(o,"workflows"))&&i(o,"layoutTemplate"))&&i(o,"workflowsLabel"),e))+`</span>
</div>
<div class="workflows__actions" data-add-region></div>
<div data-content-region></div>
`},useData:!0}),hn=A.extend({tagName:"tr",template:S.template({compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i=t.lookupProperty||function(l,s){if(Object.prototype.hasOwnProperty.call(l,s))return l[s]};return`
    <td class="workflows__empty-list">
      <h2>`+t.escapeExpression(t.lambda((o=(o=(o=(o=(o=a&&i(a,"intl"))&&i(o,"programs"))&&i(o,"program"))&&i(o,"workflows"))&&i(o,"workflowsViews"))&&i(o,"emptyView"),e))+`</h2>
    </td>
  `},useData:!0})}),Ft=Pt.extend({modelEvents:{editing:"onEditing",change:"onChange"},onChange(){this.view.render()},onEditing(t){this.$el.toggleClass("is-selected",t)},onInitialize(){this.view.model.isNew()&&this.$el.addClass("is-selected")}}),gn=A.extend({className:"table-list__item",tagName:"tr",behaviors:[Ft],regions:{behavior:"[data-behavior-region]",owner:"[data-owner-region]",due:"[data-due-region]"},template:fn,templateContext(){return{hasForm:this.model.getForm(),icon:this.model.hasOutreach()?"share-from-square":"file-lines"}},ui:{form:".js-form"},triggers:{click:"click","click @ui.form":"click:form"},onClick(){if(this.model.isNew()){v.trigger("event-router","program:action:new",this.model.get("_program"));return}v.trigger("event-router","program:action",this.model.get("_program"),this.model.id)},onClickForm(){const t=this.model.getForm();v.trigger("event-router","form:preview",t.id)},onRender(){this.showBehavior(),this.showOwner(),this.showDue()},showBehavior(){const t=this.model.isNew(),e=!!this.model.get("_program_flow"),n=new xt({isConditionalAvailable:e,behavior:this.model.get("behavior"),isCompact:!0,state:{isDisabled:t}});this.listenTo(n,"change:status",({behavior:r})=>{this.model.save({behavior:r})}),this.showChildView("behavior",n)},showOwner(){const t=this.model.isNew(),e=!!this.model.get("_program_flow"),n=new Tt({owner:this.model.getOwner(),isFromFlow:e,isCompact:!0,state:{isDisabled:t}});this.listenTo(n,"change:owner",r=>{this.model.saveOwner(r)}),this.showChildView("owner",n)},showDue(){const t=this.model.isNew(),e=new At({day:this.model.get("days_until_due"),isCompact:!0,state:{isDisabled:t}});this.listenTo(e,"change:day",n=>{this.model.save({days_until_due:n})}),this.showChildView("due",e)}}),wn=A.extend({className:"table-list__item",tagName:"tr",behaviors:[Ft],regions:{owner:"[data-owner-region]"},template:dn,templateContext(){return{published:!!this.model.get("published_at"),isAutomated:this.model.get("behavior")===mt.AUTOMATED}},triggers:{click:"click"},onClick(){if(this.model.isNew()){v.trigger("event-router","programFlow:new",this.model.get("_program"));return}v.trigger("event-router","programFlow",this.model.id)},onRender(){this.showOwner()},showOwner(){const t=this.model.isNew(),e=new It({owner:this.model.getOwner(),isCompact:!0,state:{isDisabled:t}});this.listenTo(e,"change:owner",n=>{this.model.saveOwner(n)}),this.showChildView("owner",e)}}),vn=ct.extend({className:"table-list workflows__list",tagName:"table",childView(t){return t.type==="program-flows"?wn:gn},emptyView:hn,viewComparator(t,e){return Ot("desc",t.model.get("updated_at"),e.model.get("updated_at"))}}),bn=A.extend({className:"flex-region workflows__content",regions:{content:{el:"[data-content-region]",regionClass:We,replaceElement:!0},add:"[data-add-region]"},template:pn}),_n=on.extend({popWidth:248,picklistOptions(){return{headingText:xe.programs.program.workflows.workflowsViews.addActionHeading,itemClassName:"u-text--italic"}},viewOptions:{className:"button-primary",template:S.template({compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i=e??(t.nullContext||{}),l=t.hooks.helperMissing,s=t.escapeExpression,u=t.lookupProperty||function(m,c){if(Object.prototype.hasOwnProperty.call(m,c))return m[c]};return s((u(n,"far")||e&&u(e,"far")||l).call(i,"circle-plus",{name:"far",hash:{},data:a,loc:{start:{line:1,column:0},end:{line:1,column:21}}}))+"<span>"+s(t.lambda((o=(o=(o=(o=(o=a&&u(a,"intl"))&&u(o,"programs"))&&u(o,"program"))&&u(o,"workflows"))&&u(o,"workflowsViews"))&&u(o,"addAction"),e))+"</span>"+s((u(n,"far")||e&&u(e,"far")||l).call(i,"angle-down",{name:"far",hash:{classes:"workflows__arrow"},data:a,loc:{start:{line:1,column:97},end:{line:1,column:144}}}))},useData:!0})},picklistEvents:{"picklist:item:select":"onSelect"},onSelect({model:t}){t.get("onSelect")()}}),yn=ut.extend({viewTriggers:{"click:add":"click:add"},onBeforeStart({program:t}){this.program=t,this.showView(new bn({model:t})),this.getRegion("content").startPreloader()},beforeStart({program:t}){return[v.request("entities","fetch:programActions:collection:byProgram",{programId:t.id}),v.request("entities","fetch:programFlows:collection:byProgram",{programId:t.id})]},onStart({program:t},e,n){this.collection=new it.Collection([...e.models,...n.models]),this.showChildView("content",new vn({collection:this.collection}));const r=new it.Collection([{onSelect:()=>{v.trigger("event-router","program:action:new",this.program.id)},icon:{type:"far",icon:"file-lines",classes:"workflows--add-action"},text:xe.programs.program.workflows.workflowsApp.newAction},{onSelect:()=>{v.trigger("event-router","programFlow:new",this.program.id)},icon:{type:"fas",icon:"folder",classes:"workflows--add-flow"},text:xe.programs.program.workflows.workflowsApp.newFlow}]);this.showChildView("add",new _n({collection:r}))},onEditItem(t){if(t.isNew()){this.collection.unshift(t);return}t.trigger("editing",!0)}}),Mt=ut.extend({beforeStart({actionId:t,programId:e,flowId:n}){return t?v.request("entities","fetch:programActions:model",t):v.request("entities","programActions:model",{_program:e,_program_flow:n,_owner:null,days_until_due:null,behavior:mt.STANDARD,published_at:null,archived_at:null,outreach:en.DISABLED})},onFail(){v.request("alert","show:error",xe.programs.program.action.actionApp.notFound),this.stop()},onStart(t,e){const n=v.request("sidebar","start","programAction",{action:e});this.listenTo(n,"stop",this.stop)}}),En=A.extend({modelEvents:{"change:name":"render"},className:"program__context-trail",template:S.template({1:function(t,e,n,r,a){var o,i=e??(t.nullContext||{}),l=t.hooks.helperMissing,s=t.escapeExpression,u=t.lookupProperty||function(m,c){if(Object.prototype.hasOwnProperty.call(m,c))return m[c]};return`      <a class="js-back program__context-link">
        `+s((u(n,"fas")||e&&u(e,"fas")||l).call(i,"chevron-left",{name:"fas",hash:{},data:a,loc:{start:{line:4,column:8},end:{line:4,column:30}}}))+s(t.lambda((o=(o=(o=(o=a&&u(a,"intl"))&&u(o,"programs"))&&u(o,"program"))&&u(o,"programViews"))&&u(o,"contextBackBtn"),e))+`
      </a>
      `+s((u(n,"fas")||e&&u(e,"fas")||l).call(i,"chevron-right",{name:"fas",hash:{},data:a,loc:{start:{line:6,column:6},end:{line:6,column:29}}}))+`
    `},compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i,l=e??(t.nullContext||{}),s=t.lookupProperty||function(u,m){if(Object.prototype.hasOwnProperty.call(u,m))return u[m]};return`
`+((o=s(n,"if").call(l,e!=null?s(e,"hasLatestList"):e,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a,loc:{start:{line:2,column:4},end:{line:7,column:11}}}))!=null?o:"")+t.escapeExpression((i=(i=s(n,"name")||(e!=null?s(e,"name"):e))!=null?i:t.hooks.helperMissing,typeof i=="function"?i.call(l,{name:"name",hash:{},data:a,loc:{start:{line:7,column:11},end:{line:7,column:21}}}):i))+`
  `},useData:!0}),triggers:{"click .js-back":"click:back"},onClickBack(){v.request("history","go:latestList")},templateContext(){return{hasLatestList:v.request("history","has:latestList")}}}),kn=A.extend({className:"program__frame",template:S.template({compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){return`
    <div class="program__layout">
        <div data-context-trail-region></div>
        <div data-content-region></div>
    </div>
    <div class="program__sidebar" data-sidebar-region></div>
  `},useData:!0}),regions:{contextTrail:{el:"[data-context-trail-region]",replaceElement:!0},sidebar:"[data-sidebar-region]",content:{el:"[data-content-region]",regionClass:We,replaceElement:!0}},onRender(){this.showChildView("contextTrail",new En({model:this.model}))}}),Dn=S.template({1:function(t,e,n,r,a){var o,i=t.lookupProperty||function(l,s){if(Object.prototype.hasOwnProperty.call(l,s))return l[s]};return t.escapeExpression((o=(o=i(n,"details")||(e!=null?i(e,"details"):e))!=null?o:t.hooks.helperMissing,typeof o=="function"?o.call(e??(t.nullContext||{}),{name:"details",hash:{},data:a,loc:{start:{line:5,column:22},end:{line:5,column:35}}}):o))},3:function(t,e,n,r,a){var o,i=t.lookupProperty||function(l,s){if(Object.prototype.hasOwnProperty.call(l,s))return l[s]};return'<span class="u-text--italic">'+t.escapeExpression(t.lambda((o=(o=(o=(o=(o=a&&i(a,"intl"))&&i(o,"programs"))&&i(o,"program"))&&i(o,"sidebar"))&&i(o,"sidebarLayoutTemplate"))&&i(o,"noDetails"),e))+"</span>"},5:function(t,e,n,r,a){return" is-published"},7:function(t,e,n,r,a){var o=t.lookupProperty||function(i,l){if(Object.prototype.hasOwnProperty.call(i,l))return i[l]};return t.escapeExpression((o(n,"fas")||e&&o(e,"fas")||t.hooks.helperMissing).call(e??(t.nullContext||{}),"toggle-on",{name:"fas",hash:{},data:a,loc:{start:{line:8,column:21},end:{line:8,column:40}}}))},9:function(t,e,n,r,a){var o=t.lookupProperty||function(i,l){if(Object.prototype.hasOwnProperty.call(i,l))return i[l]};return t.escapeExpression((o(n,"far")||e&&o(e,"far")||t.hooks.helperMissing).call(e??(t.nullContext||{}),"toggle-off",{name:"far",hash:{},data:a,loc:{start:{line:8,column:48},end:{line:8,column:68}}}))},compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i,l=e??(t.nullContext||{}),s=t.hooks.helperMissing,u=t.escapeExpression,m=t.lambda,c=t.lookupProperty||function(d,p){if(Object.prototype.hasOwnProperty.call(d,p))return d[p]};return'<h1 class="program-sidebar__name">'+u((i=(i=c(n,"name")||(e!=null?c(e,"name"):e))!=null?i:s,typeof i=="function"?i.call(l,{name:"name",hash:{},data:a,loc:{start:{line:1,column:34},end:{line:1,column:44}}}):i))+`</h1>
<button class="button--icon program-sidebar__context-menu js-menu">`+u((c(n,"far")||e&&c(e,"far")||s).call(l,"ellipsis",{name:"far",hash:{},data:a,loc:{start:{line:2,column:67},end:{line:2,column:85}}}))+`</button>
<div class="u-margin--t-16">
  <div class="program-sidebar__heading">`+u(m((o=(o=(o=(o=(o=a&&c(a,"intl"))&&c(o,"programs"))&&c(o,"program"))&&c(o,"sidebar"))&&c(o,"sidebarLayoutTemplate"))&&c(o,"details"),e))+`</div>
  <div>`+((o=c(n,"if").call(l,e!=null?c(e,"details"):e,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.program(3,a,0),data:a,loc:{start:{line:5,column:7},end:{line:5,column:154}}}))!=null?o:"")+`</div>
  <div class="program-sidebar__heading">`+u(m((o=(o=(o=(o=(o=a&&c(a,"intl"))&&c(o,"programs"))&&c(o,"program"))&&c(o,"sidebar"))&&c(o,"sidebarLayoutTemplate"))&&c(o,"state"),e))+`</div>
  <div class="program-sidebar__published`+((o=c(n,"if").call(l,e!=null?c(e,"published"):e,{name:"if",hash:{},fn:t.program(5,a,0),inverse:t.noop,data:a,loc:{start:{line:7,column:40},end:{line:7,column:77}}}))!=null?o:"")+`">
    `+((o=c(n,"if").call(l,e!=null?c(e,"published"):e,{name:"if",hash:{},fn:t.program(7,a,0),inverse:t.program(9,a,0),data:a,loc:{start:{line:8,column:4},end:{line:8,column:75}}}))!=null?o:"")+`
    `+u((c(n,"formatMessage")||e&&c(e,"formatMessage")||s).call(l,(c(n,"intlGet")||e&&c(e,"intlGet")||s).call(l,"programs.program.sidebar.sidebarLayoutTemplate.published",{name:"intlGet",hash:{},data:a,loc:{start:{line:9,column:20},end:{line:9,column:88}}}),{name:"formatMessage",hash:{published:e!=null?c(e,"published"):e},data:a,loc:{start:{line:9,column:4},end:{line:9,column:110}}}))+`
  </div>
</div>
`},useData:!0}),gt=xe.programs.program.sidebar.sidebarViews,Nt=A.extend({className:"program-sidebar",template:Dn,regionClass:Jt.extend({replaceElement:!0}),triggers:{"click @ui.menu":"click:menu"},ui:{menu:".js-menu"},modelEvents:{change:"render"},templateContext(){return{published:!!this.model.get("published_at")}},onClickMenu(){const t=new it.Collection([{onSelect:tn(this.triggerMethod,this,"edit"),icon:"pen-to-square",className:"program-sidebar__edit",text:gt.menuOptions.edit}]);new rn({ui:this.ui.menu,uiView:this,headingText:gt.menuOptions.headingText,itemTemplate:S.template({compiler:[8,">= 4.3.0"],main:function(n,r,a,o,i){var l,s=r??(n.nullContext||{}),u=n.hooks.helperMissing,m="function",c=n.escapeExpression,d=n.lookupProperty||function(p,b){if(Object.prototype.hasOwnProperty.call(p,b))return p[b]};return"<span class="+c((l=(l=d(a,"className")||(r!=null?d(r,"className"):r))!=null?l:u,typeof l===m?l.call(s,{name:"className",hash:{},data:i,loc:{start:{line:1,column:12},end:{line:1,column:27}}}):l))+">"+c((d(a,"far")||r&&d(r,"far")||u).call(s,r!=null?d(r,"icon"):r,{name:"far",hash:{},data:i,loc:{start:{line:1,column:28},end:{line:1,column:40}}}))+c((l=(l=d(a,"text")||(r!=null?d(r,"text"):r))!=null?l:u,typeof l===m?l.call(s,{name:"text",hash:{},data:i,loc:{start:{line:1,column:40},end:{line:1,column:50}}}):l))+"</span>"},useData:!0}),lists:[{collection:t}],align:"right",popWidth:248}).show()}}),Cn=St.extend({eventRoutes(){return{"program:details":nn(this.startCurrent,"workflows"),"program:action":this.startProgramAction,"program:action:new":this.startProgramAction,"programFlow:new":this.startFlowSidebar}},childApps:{workflows:yn,action:Mt},currentAppOptions(){return{region:this.getRegion("content"),program:this.getOption("program")}},onBeforeStart(){this.getRegion().startPreloader()},beforeStart({programId:t}){return v.request("entities","fetch:programs:model",t)},onStart({currentRoute:t},e){this.program=e,this.setView(new kn({model:e})),this.showSidebar(),this.listenTo(v.channel("sidebar"),{show:this.emptySidebar,close:this.showSidebar}),this.startRoute(t),this.showView()},startProgramAction(t,e){const n=this.getChildApp("action");this.listenToOnce(n,{start(r,a){this.editList(a)},fail(){this.startCurrent("workflows")}}),this.startChildApp("action",{actionId:e,programId:t})},editList(t){const e=this.getCurrent()||this.startCurrent("workflows");if(!e.isRunning()){this.listenToOnce(e,"start",()=>{e.triggerMethod("edit:item",t)});return}e.triggerMethod("edit:item",t)},startFlowSidebar(t){const e=v.request("entities","programFlows:model",{_program:t,_owner:null,published_at:null,archived_at:null,behavior:mt.STANDARD});v.request("sidebar","start","programFlow",{flow:e}),this.editList(e)},showSidebar(){const t=new Nt({model:this.program});this.listenTo(t,{edit:this.onEdit}),this.showChildView("sidebar",t)},emptySidebar(){this.getRegion("sidebar").empty()},onEdit(){v.request("sidebar","start","program",{program:this.program})}});/**!
 * Sortable 1.15.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function wt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?wt(Object(n),!0).forEach(function(r){Pn(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Re(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Re=function(e){return typeof e}:Re=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re(t)}function Pn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z(){return Z=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Z.apply(this,arguments)}function On(t,e){if(t==null)return{};var n={},r=Object.keys(t),a,o;for(o=0;o<r.length;o++)a=r[o],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function Sn(t,e){if(t==null)return{};var n=On(t,e),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)r=o[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}var xn="1.15.2";function K(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var Q=K(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Te=K(/Edge/i),vt=K(/firefox/i),De=K(/safari/i)&&!K(/chrome/i)&&!K(/android/i),Vt=K(/iP(ad|od|hone)/i),Rt=K(/chrome/i)&&K(/android/i),jt={capture:!1,passive:!1};function y(t,e,n){t.addEventListener(e,n,!Q&&jt)}function _(t,e,n){t.removeEventListener(e,n,!Q&&jt)}function qe(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function Tn(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function X(t,e,n,r){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&qe(t,e):qe(t,e))||r&&t===n)return t;if(t===n)break}while(t=Tn(t))}return null}var bt=/\s+/g;function R(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var r=(" "+t.className+" ").replace(bt," ").replace(" "+e+" "," ");t.className=(r+(n?" "+e:"")).replace(bt," ")}}function h(t,e,n){var r=t&&t.style;if(r){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];!(e in r)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),r[e]=n+(typeof n=="string"?"":"px")}}function pe(t,e){var n="";if(typeof t=="string")n=t;else do{var r=h(t,"transform");r&&r!=="none"&&(n=r+" "+n)}while(!e&&(t=t.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(n)}function Bt(t,e,n){if(t){var r=t.getElementsByTagName(e),a=0,o=r.length;if(n)for(;a<o;a++)n(r[a],a);return r}return[]}function $(){var t=document.scrollingElement;return t||document.documentElement}function O(t,e,n,r,a){if(!(!t.getBoundingClientRect&&t!==window)){var o,i,l,s,u,m,c;if(t!==window&&t.parentNode&&t!==$()?(o=t.getBoundingClientRect(),i=o.top,l=o.left,s=o.bottom,u=o.right,m=o.height,c=o.width):(i=0,l=0,s=window.innerHeight,u=window.innerWidth,m=window.innerHeight,c=window.innerWidth),(e||n)&&t!==window&&(a=a||t.parentNode,!Q))do if(a&&a.getBoundingClientRect&&(h(a,"transform")!=="none"||n&&h(a,"position")!=="static")){var d=a.getBoundingClientRect();i-=d.top+parseInt(h(a,"border-top-width")),l-=d.left+parseInt(h(a,"border-left-width")),s=i+o.height,u=l+o.width;break}while(a=a.parentNode);if(r&&t!==window){var p=pe(a||t),b=p&&p.a,E=p&&p.d;p&&(i/=E,l/=b,c/=b,m/=E,s=i+m,u=l+c)}return{top:i,left:l,bottom:s,right:u,width:c,height:m}}}function _t(t,e,n){for(var r=oe(t,!0),a=O(t)[e];r;){var o=O(r)[n],i=void 0;if(i=a>=o,!i)return r;if(r===$())break;r=oe(r,!1)}return!1}function he(t,e,n,r){for(var a=0,o=0,i=t.children;o<i.length;){if(i[o].style.display!=="none"&&i[o]!==g.ghost&&(r||i[o]!==g.dragged)&&X(i[o],n.draggable,t,!1)){if(a===e)return i[o];a++}o++}return null}function ft(t,e){for(var n=t.lastElementChild;n&&(n===g.ghost||h(n,"display")==="none"||e&&!qe(n,e));)n=n.previousElementSibling;return n||null}function L(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==g.clone&&(!e||qe(t,e))&&n++;return n}function yt(t){var e=0,n=0,r=$();if(t)do{var a=pe(t),o=a.a,i=a.d;e+=t.scrollLeft*o,n+=t.scrollTop*i}while(t!==r&&(t=t.parentNode));return[e,n]}function An(t,e){for(var n in t)if(t.hasOwnProperty(n)){for(var r in e)if(e.hasOwnProperty(r)&&e[r]===t[n][r])return Number(n)}return-1}function oe(t,e){if(!t||!t.getBoundingClientRect)return $();var n=t,r=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var a=h(n);if(n.clientWidth<n.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return $();if(r||e)return n;r=!0}}while(n=n.parentNode);return $()}function In(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Ue(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var Ce;function Lt(t,e){return function(){if(!Ce){var n=arguments,r=this;n.length===1?t.call(r,n[0]):t.apply(r,n),Ce=setTimeout(function(){Ce=void 0},e)}}}function Fn(){clearTimeout(Ce),Ce=void 0}function Yt(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function qt(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function Ht(t,e,n){var r={};return Array.from(t.children).forEach(function(a){var o,i,l,s;if(!(!X(a,e.draggable,t,!1)||a.animated||a===n)){var u=O(a);r.left=Math.min((o=r.left)!==null&&o!==void 0?o:1/0,u.left),r.top=Math.min((i=r.top)!==null&&i!==void 0?i:1/0,u.top),r.right=Math.max((l=r.right)!==null&&l!==void 0?l:-1/0,u.right),r.bottom=Math.max((s=r.bottom)!==null&&s!==void 0?s:-1/0,u.bottom)}}),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var B="Sortable"+new Date().getTime();function Mn(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(a){if(!(h(a,"display")==="none"||a===g.ghost)){t.push({target:a,rect:O(a)});var o=W({},t[t.length-1].rect);if(a.thisAnimationDuration){var i=pe(a,!0);i&&(o.top-=i.f,o.left-=i.e)}a.fromRect=o}})}},addAnimationState:function(r){t.push(r)},removeAnimationState:function(r){t.splice(An(t,{target:r}),1)},animateAll:function(r){var a=this;if(!this.options.animation){clearTimeout(e),typeof r=="function"&&r();return}var o=!1,i=0;t.forEach(function(l){var s=0,u=l.target,m=u.fromRect,c=O(u),d=u.prevFromRect,p=u.prevToRect,b=l.rect,E=pe(u,!0);E&&(c.top-=E.f,c.left-=E.e),u.toRect=c,u.thisAnimationDuration&&Ue(d,c)&&!Ue(m,c)&&(b.top-c.top)/(b.left-c.left)===(m.top-c.top)/(m.left-c.left)&&(s=Vn(b,d,p,a.options)),Ue(c,m)||(u.prevFromRect=m,u.prevToRect=c,s||(s=a.options.animation),a.animate(u,b,c,s)),s&&(o=!0,i=Math.max(i,s),clearTimeout(u.animationResetTimer),u.animationResetTimer=setTimeout(function(){u.animationTime=0,u.prevFromRect=null,u.fromRect=null,u.prevToRect=null,u.thisAnimationDuration=null},s),u.thisAnimationDuration=s)}),clearTimeout(e),o?e=setTimeout(function(){typeof r=="function"&&r()},i):typeof r=="function"&&r(),t=[]},animate:function(r,a,o,i){if(i){h(r,"transition",""),h(r,"transform","");var l=pe(this.el),s=l&&l.a,u=l&&l.d,m=(a.left-o.left)/(s||1),c=(a.top-o.top)/(u||1);r.animatingX=!!m,r.animatingY=!!c,h(r,"transform","translate3d("+m+"px,"+c+"px,0)"),this.forRepaintDummy=Nn(r),h(r,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),h(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){h(r,"transition",""),h(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},i)}}}}function Nn(t){return t.offsetWidth}function Vn(t,e,n,r){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*r.animation}var ue=[],Ke={initializeByDefault:!0},Ae={mount:function(e){for(var n in Ke)Ke.hasOwnProperty(n)&&!(n in e)&&(e[n]=Ke[n]);ue.forEach(function(r){if(r.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),ue.push(e)},pluginEvent:function(e,n,r){var a=this;this.eventCanceled=!1,r.cancel=function(){a.eventCanceled=!0};var o=e+"Global";ue.forEach(function(i){n[i.pluginName]&&(n[i.pluginName][o]&&n[i.pluginName][o](W({sortable:n},r)),n.options[i.pluginName]&&n[i.pluginName][e]&&n[i.pluginName][e](W({sortable:n},r)))})},initializePlugins:function(e,n,r,a){ue.forEach(function(l){var s=l.pluginName;if(!(!e.options[s]&&!l.initializeByDefault)){var u=new l(e,n,e.options);u.sortable=e,u.options=e.options,e[s]=u,Z(r,u.defaults)}});for(var o in e.options)if(e.options.hasOwnProperty(o)){var i=this.modifyOption(e,o,e.options[o]);typeof i<"u"&&(e.options[o]=i)}},getEventProperties:function(e,n){var r={};return ue.forEach(function(a){typeof a.eventProperties=="function"&&Z(r,a.eventProperties.call(n[a.pluginName],e))}),r},modifyOption:function(e,n,r){var a;return ue.forEach(function(o){e[o.pluginName]&&o.optionListeners&&typeof o.optionListeners[n]=="function"&&(a=o.optionListeners[n].call(e[o.pluginName],r))}),a}};function Rn(t){var e=t.sortable,n=t.rootEl,r=t.name,a=t.targetEl,o=t.cloneEl,i=t.toEl,l=t.fromEl,s=t.oldIndex,u=t.newIndex,m=t.oldDraggableIndex,c=t.newDraggableIndex,d=t.originalEvent,p=t.putSortable,b=t.extraEventProperties;if(e=e||n&&n[B],!!e){var E,Y=e.options,z="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!Q&&!Te?E=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(E=document.createEvent("Event"),E.initEvent(r,!0,!0)),E.to=i||n,E.from=l||n,E.item=a||n,E.clone=o,E.oldIndex=s,E.newIndex=u,E.oldDraggableIndex=m,E.newDraggableIndex=c,E.originalEvent=d,E.pullMode=p?p.lastPutMode:void 0;var I=W(W({},b),Ae.getEventProperties(r,e));for(var q in I)E[q]=I[q];n&&n.dispatchEvent(E),Y[z]&&Y[z].call(e,E)}}var jn=["evt"],M=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=r.evt,o=Sn(r,jn);Ae.pluginEvent.bind(g)(e,n,W({dragEl:f,parentEl:C,ghostEl:w,rootEl:k,nextEl:ce,lastDownEl:je,cloneEl:D,cloneHidden:ne,dragStarted:ye,putSortable:x,activeSortable:g.active,originalEvent:a,oldIndex:de,oldDraggableIndex:Pe,newIndex:j,newDraggableIndex:te,hideGhostForTarget:Wt,unhideGhostForTarget:zt,cloneNowHidden:function(){ne=!0},cloneNowShown:function(){ne=!1},dispatchSortableEvent:function(l){F({sortable:n,name:l,originalEvent:a})}},o))};function F(t){Rn(W({putSortable:x,cloneEl:D,targetEl:f,rootEl:k,oldIndex:de,oldDraggableIndex:Pe,newIndex:j,newDraggableIndex:te},t))}var f,C,w,k,ce,je,D,ne,de,j,Pe,te,Fe,x,fe=!1,He=!1,Xe=[],le,H,Ze,Qe,Et,kt,ye,me,Oe,Se=!1,Me=!1,Be,T,Je=[],rt=!1,Ge=[],ze=typeof document<"u",Ne=Vt,Dt=Te||Q?"cssFloat":"float",Bn=ze&&!Rt&&!Vt&&"draggable"in document.createElement("div"),Xt=function(){if(ze){if(Q)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),Gt=function(e,n){var r=h(e),a=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),o=he(e,0,n),i=he(e,1,n),l=o&&h(o),s=i&&h(i),u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+O(o).width,m=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+O(i).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&l.float&&l.float!=="none"){var c=l.float==="left"?"left":"right";return i&&(s.clear==="both"||s.clear===c)?"vertical":"horizontal"}return o&&(l.display==="block"||l.display==="flex"||l.display==="table"||l.display==="grid"||u>=a&&r[Dt]==="none"||i&&r[Dt]==="none"&&u+m>a)?"vertical":"horizontal"},Ln=function(e,n,r){var a=r?e.left:e.top,o=r?e.right:e.bottom,i=r?e.width:e.height,l=r?n.left:n.top,s=r?n.right:n.bottom,u=r?n.width:n.height;return a===l||o===s||a+i/2===l+u/2},Yn=function(e,n){var r;return Xe.some(function(a){var o=a[B].options.emptyInsertThreshold;if(!(!o||ft(a))){var i=O(a),l=e>=i.left-o&&e<=i.right+o,s=n>=i.top-o&&n<=i.bottom+o;if(l&&s)return r=a}}),r},$t=function(e){function n(o,i){return function(l,s,u,m){var c=l.options.group.name&&s.options.group.name&&l.options.group.name===s.options.group.name;if(o==null&&(i||c))return!0;if(o==null||o===!1)return!1;if(i&&o==="clone")return o;if(typeof o=="function")return n(o(l,s,u,m),i)(l,s,u,m);var d=(i?l:s).options.group.name;return o===!0||typeof o=="string"&&o===d||o.join&&o.indexOf(d)>-1}}var r={},a=e.group;(!a||Re(a)!="object")&&(a={name:a}),r.name=a.name,r.checkPull=n(a.pull,!0),r.checkPut=n(a.put),r.revertClone=a.revertClone,e.group=r},Wt=function(){!Xt&&w&&h(w,"display","none")},zt=function(){!Xt&&w&&h(w,"display","")};ze&&!Rt&&document.addEventListener("click",function(t){if(He)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),He=!1,!1},!0);var se=function(e){if(f){e=e.touches?e.touches[0]:e;var n=Yn(e.clientX,e.clientY);if(n){var r={};for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);r.target=r.rootEl=n,r.preventDefault=void 0,r.stopPropagation=void 0,n[B]._onDragOver(r)}}},qn=function(e){f&&f.parentNode[B]._isOutsideThisEl(e.target)};function g(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=Z({},e),t[B]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Gt(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(i,l){i.setData("Text",l.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:g.supportPointer!==!1&&"PointerEvent"in window&&!De,emptyInsertThreshold:5};Ae.initializePlugins(this,t,n);for(var r in n)!(r in e)&&(e[r]=n[r]);$t(e);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=e.forceFallback?!1:Bn,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?y(t,"pointerdown",this._onTapStart):(y(t,"mousedown",this._onTapStart),y(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(y(t,"dragover",this),y(t,"dragenter",this)),Xe.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Z(this,Mn())}g.prototype={constructor:g,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(me=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,f):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,r=this.el,a=this.options,o=a.preventOnFilter,i=e.type,l=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,s=(l||e).target,u=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,m=a.filter;if(Kn(r),!f&&!(/mousedown|pointerdown/.test(i)&&e.button!==0||a.disabled)&&!u.isContentEditable&&!(!this.nativeDraggable&&De&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=X(s,a.draggable,r,!1),!(s&&s.animated)&&je!==s)){if(de=L(s),Pe=L(s,a.draggable),typeof m=="function"){if(m.call(this,e,s,this)){F({sortable:n,rootEl:u,name:"filter",targetEl:s,toEl:r,fromEl:r}),M("filter",n,{evt:e}),o&&e.cancelable&&e.preventDefault();return}}else if(m&&(m=m.split(",").some(function(c){if(c=X(u,c.trim(),r,!1),c)return F({sortable:n,rootEl:c,name:"filter",targetEl:s,fromEl:r,toEl:r}),M("filter",n,{evt:e}),!0}),m)){o&&e.cancelable&&e.preventDefault();return}a.handle&&!X(u,a.handle,r,!1)||this._prepareDragStart(e,l,s)}}},_prepareDragStart:function(e,n,r){var a=this,o=a.el,i=a.options,l=o.ownerDocument,s;if(r&&!f&&r.parentNode===o){var u=O(r);if(k=o,f=r,C=f.parentNode,ce=f.nextSibling,je=r,Fe=i.group,g.dragged=f,le={target:f,clientX:(n||e).clientX,clientY:(n||e).clientY},Et=le.clientX-u.left,kt=le.clientY-u.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,f.style["will-change"]="all",s=function(){if(M("delayEnded",a,{evt:e}),g.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!vt&&a.nativeDraggable&&(f.draggable=!0),a._triggerDragStart(e,n),F({sortable:a,name:"choose",originalEvent:e}),R(f,i.chosenClass,!0)},i.ignore.split(",").forEach(function(m){Bt(f,m.trim(),et)}),y(l,"dragover",se),y(l,"mousemove",se),y(l,"touchmove",se),y(l,"mouseup",a._onDrop),y(l,"touchend",a._onDrop),y(l,"touchcancel",a._onDrop),vt&&this.nativeDraggable&&(this.options.touchStartThreshold=4,f.draggable=!0),M("delayStart",this,{evt:e}),i.delay&&(!i.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(Te||Q))){if(g.eventCanceled){this._onDrop();return}y(l,"mouseup",a._disableDelayedDrag),y(l,"touchend",a._disableDelayedDrag),y(l,"touchcancel",a._disableDelayedDrag),y(l,"mousemove",a._delayedDragTouchMoveHandler),y(l,"touchmove",a._delayedDragTouchMoveHandler),i.supportPointer&&y(l,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(s,i.delay)}else s()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){f&&et(f),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._disableDelayedDrag),_(e,"touchend",this._disableDelayedDrag),_(e,"touchcancel",this._disableDelayedDrag),_(e,"mousemove",this._delayedDragTouchMoveHandler),_(e,"touchmove",this._delayedDragTouchMoveHandler),_(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?y(document,"pointermove",this._onTouchMove):n?y(document,"touchmove",this._onTouchMove):y(document,"mousemove",this._onTouchMove):(y(f,"dragend",this),y(k,"dragstart",this._onDragStart));try{document.selection?Le(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(fe=!1,k&&f){M("dragStarted",this,{evt:n}),this.nativeDraggable&&y(document,"dragover",qn);var r=this.options;!e&&R(f,r.dragClass,!1),R(f,r.ghostClass,!0),g.active=this,e&&this._appendGhost(),F({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(H){this._lastX=H.clientX,this._lastY=H.clientY,Wt();for(var e=document.elementFromPoint(H.clientX,H.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(H.clientX,H.clientY),e!==n);)n=e;if(f.parentNode[B]._isOutsideThisEl(e),n)do{if(n[B]){var r=void 0;if(r=n[B]._onDragOver({clientX:H.clientX,clientY:H.clientY,target:e,rootEl:n}),r&&!this.options.dragoverBubble)break}e=n}while(n=n.parentNode);zt()}},_onTouchMove:function(e){if(le){var n=this.options,r=n.fallbackTolerance,a=n.fallbackOffset,o=e.touches?e.touches[0]:e,i=w&&pe(w,!0),l=w&&i&&i.a,s=w&&i&&i.d,u=Ne&&T&&yt(T),m=(o.clientX-le.clientX+a.x)/(l||1)+(u?u[0]-Je[0]:0)/(l||1),c=(o.clientY-le.clientY+a.y)/(s||1)+(u?u[1]-Je[1]:0)/(s||1);if(!g.active&&!fe){if(r&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if(w){i?(i.e+=m-(Ze||0),i.f+=c-(Qe||0)):i={a:1,b:0,c:0,d:1,e:m,f:c};var d="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");h(w,"webkitTransform",d),h(w,"mozTransform",d),h(w,"msTransform",d),h(w,"transform",d),Ze=m,Qe=c,H=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!w){var e=this.options.fallbackOnBody?document.body:k,n=O(f,!0,Ne,!0,e),r=this.options;if(Ne){for(T=e;h(T,"position")==="static"&&h(T,"transform")==="none"&&T!==document;)T=T.parentNode;T!==document.body&&T!==document.documentElement?(T===document&&(T=$()),n.top+=T.scrollTop,n.left+=T.scrollLeft):T=$(),Je=yt(T)}w=f.cloneNode(!0),R(w,r.ghostClass,!1),R(w,r.fallbackClass,!0),R(w,r.dragClass,!0),h(w,"transition",""),h(w,"transform",""),h(w,"box-sizing","border-box"),h(w,"margin",0),h(w,"top",n.top),h(w,"left",n.left),h(w,"width",n.width),h(w,"height",n.height),h(w,"opacity","0.8"),h(w,"position",Ne?"absolute":"fixed"),h(w,"zIndex","100000"),h(w,"pointerEvents","none"),g.ghost=w,e.appendChild(w),h(w,"transform-origin",Et/parseInt(w.style.width)*100+"% "+kt/parseInt(w.style.height)*100+"%")}},_onDragStart:function(e,n){var r=this,a=e.dataTransfer,o=r.options;if(M("dragStart",this,{evt:e}),g.eventCanceled){this._onDrop();return}M("setupClone",this),g.eventCanceled||(D=qt(f),D.removeAttribute("id"),D.draggable=!1,D.style["will-change"]="",this._hideClone(),R(D,this.options.chosenClass,!1),g.clone=D),r.cloneId=Le(function(){M("clone",r),!g.eventCanceled&&(r.options.removeCloneOnHide||k.insertBefore(D,f),r._hideClone(),F({sortable:r,name:"clone"}))}),!n&&R(f,o.dragClass,!0),n?(He=!0,r._loopId=setInterval(r._emulateDragOver,50)):(_(document,"mouseup",r._onDrop),_(document,"touchend",r._onDrop),_(document,"touchcancel",r._onDrop),a&&(a.effectAllowed="move",o.setData&&o.setData.call(r,a,f)),y(document,"drop",r),h(f,"transform","translateZ(0)")),fe=!0,r._dragStartId=Le(r._dragStarted.bind(r,n,e)),y(document,"selectstart",r),ye=!0,De&&h(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,r=e.target,a,o,i,l=this.options,s=l.group,u=g.active,m=Fe===s,c=l.sort,d=x||u,p,b=this,E=!1;if(rt)return;function Y(_e,Kt){M(_e,b,W({evt:e,isOwner:m,axis:p?"vertical":"horizontal",revert:i,dragRect:a,targetRect:o,canSort:c,fromSortable:d,target:r,completed:I,onMove:function(ht,Zt){return Ve(k,n,f,a,ht,O(ht),e,Zt)},changed:q},Kt))}function z(){Y("dragOverAnimationCapture"),b.captureAnimationState(),b!==d&&d.captureAnimationState()}function I(_e){return Y("dragOverCompleted",{insertion:_e}),_e&&(m?u._hideClone():u._showClone(b),b!==d&&(R(f,x?x.options.ghostClass:u.options.ghostClass,!1),R(f,l.ghostClass,!0)),x!==b&&b!==g.active?x=b:b===g.active&&x&&(x=null),d===b&&(b._ignoreWhileAnimating=r),b.animateAll(function(){Y("dragOverAnimationComplete"),b._ignoreWhileAnimating=null}),b!==d&&(d.animateAll(),d._ignoreWhileAnimating=null)),(r===f&&!f.animated||r===n&&!r.animated)&&(me=null),!l.dragoverBubble&&!e.rootEl&&r!==document&&(f.parentNode[B]._isOutsideThisEl(e.target),!_e&&se(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),E=!0}function q(){j=L(f),te=L(f,l.draggable),F({sortable:b,name:"change",toEl:n,newIndex:j,newDraggableIndex:te,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),r=X(r,l.draggable,n,!0),Y("dragOver"),g.eventCanceled)return E;if(f.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||b._ignoreWhileAnimating===r)return I(!1);if(He=!1,u&&!l.disabled&&(m?c||(i=C!==k):x===this||(this.lastPutMode=Fe.checkPull(this,u,f,e))&&s.checkPut(this,u,f,e))){if(p=this._getDirection(e,r)==="vertical",a=O(f),Y("dragOverValid"),g.eventCanceled)return E;if(i)return C=k,z(),this._hideClone(),Y("revert"),g.eventCanceled||(ce?k.insertBefore(f,ce):k.appendChild(f)),I(!0);var N=ft(n,l.draggable);if(!N||$n(e,p,this)&&!N.animated){if(N===f)return I(!1);if(N&&n===e.target&&(r=N),r&&(o=O(r)),Ve(k,n,f,a,r,o,e,!!r)!==!1)return z(),N&&N.nextSibling?n.insertBefore(f,N.nextSibling):n.appendChild(f),C=n,q(),I(!0)}else if(N&&Gn(e,p,this)){var ie=he(n,0,l,!0);if(ie===f)return I(!1);if(r=ie,o=O(r),Ve(k,n,f,a,r,o,e,!1)!==!1)return z(),n.insertBefore(f,ie),C=n,q(),I(!0)}else if(r.parentNode===n){o=O(r);var G=0,re,ge=f.parentNode!==n,V=!Ln(f.animated&&f.toRect||a,r.animated&&r.toRect||o,p),we=p?"top":"left",J=_t(r,"top","top")||_t(f,"top","top"),ve=J?J.scrollTop:void 0;me!==r&&(re=o[we],Se=!1,Me=!V&&l.invertSwap||ge),G=Wn(e,r,o,p,V?1:l.swapThreshold,l.invertedSwapThreshold==null?l.swapThreshold:l.invertedSwapThreshold,Me,me===r);var U;if(G!==0){var ae=L(f);do ae-=G,U=C.children[ae];while(U&&(h(U,"display")==="none"||U===w))}if(G===0||U===r)return I(!1);me=r,Oe=G;var be=r.nextElementSibling,ee=!1;ee=G===1;var Ie=Ve(k,n,f,a,r,o,e,ee);if(Ie!==!1)return(Ie===1||Ie===-1)&&(ee=Ie===1),rt=!0,setTimeout(Xn,30),z(),ee&&!be?n.appendChild(f):r.parentNode.insertBefore(f,ee?be:r),J&&Yt(J,0,ve-J.scrollTop),C=f.parentNode,re!==void 0&&!Me&&(Be=Math.abs(re-O(r)[we])),q(),I(!0)}if(n.contains(f))return I(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){_(document,"mousemove",this._onTouchMove),_(document,"touchmove",this._onTouchMove),_(document,"pointermove",this._onTouchMove),_(document,"dragover",se),_(document,"mousemove",se),_(document,"touchmove",se)},_offUpEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._onDrop),_(e,"touchend",this._onDrop),_(e,"pointerup",this._onDrop),_(e,"touchcancel",this._onDrop),_(document,"selectstart",this)},_onDrop:function(e){var n=this.el,r=this.options;if(j=L(f),te=L(f,r.draggable),M("drop",this,{evt:e}),C=f&&f.parentNode,j=L(f),te=L(f,r.draggable),g.eventCanceled){this._nulling();return}fe=!1,Me=!1,Se=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),at(this.cloneId),at(this._dragStartId),this.nativeDraggable&&(_(document,"drop",this),_(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),De&&h(document.body,"user-select",""),h(f,"transform",""),e&&(ye&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),w&&w.parentNode&&w.parentNode.removeChild(w),(k===C||x&&x.lastPutMode!=="clone")&&D&&D.parentNode&&D.parentNode.removeChild(D),f&&(this.nativeDraggable&&_(f,"dragend",this),et(f),f.style["will-change"]="",ye&&!fe&&R(f,x?x.options.ghostClass:this.options.ghostClass,!1),R(f,this.options.chosenClass,!1),F({sortable:this,name:"unchoose",toEl:C,newIndex:null,newDraggableIndex:null,originalEvent:e}),k!==C?(j>=0&&(F({rootEl:C,name:"add",toEl:C,fromEl:k,originalEvent:e}),F({sortable:this,name:"remove",toEl:C,originalEvent:e}),F({rootEl:C,name:"sort",toEl:C,fromEl:k,originalEvent:e}),F({sortable:this,name:"sort",toEl:C,originalEvent:e})),x&&x.save()):j!==de&&j>=0&&(F({sortable:this,name:"update",toEl:C,originalEvent:e}),F({sortable:this,name:"sort",toEl:C,originalEvent:e})),g.active&&((j==null||j===-1)&&(j=de,te=Pe),F({sortable:this,name:"end",toEl:C,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){M("nulling",this),k=f=C=w=ce=D=je=ne=le=H=ye=j=te=de=Pe=me=Oe=x=Fe=g.dragged=g.ghost=g.clone=g.active=null,Ge.forEach(function(e){e.checked=!0}),Ge.length=Ze=Qe=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":f&&(this._onDragOver(e),Hn(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,r=this.el.children,a=0,o=r.length,i=this.options;a<o;a++)n=r[a],X(n,i.draggable,this.el,!1)&&e.push(n.getAttribute(i.dataIdAttr)||Un(n));return e},sort:function(e,n){var r={},a=this.el;this.toArray().forEach(function(o,i){var l=a.children[i];X(l,this.options.draggable,a,!1)&&(r[o]=l)},this),n&&this.captureAnimationState(),e.forEach(function(o){r[o]&&(a.removeChild(r[o]),a.appendChild(r[o]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return X(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var r=this.options;if(n===void 0)return r[e];var a=Ae.modifyOption(this,e,n);typeof a<"u"?r[e]=a:r[e]=n,e==="group"&&$t(r)},destroy:function(){M("destroy",this);var e=this.el;e[B]=null,_(e,"mousedown",this._onTapStart),_(e,"touchstart",this._onTapStart),_(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(_(e,"dragover",this),_(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Xe.splice(Xe.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!ne){if(M("hideClone",this),g.eventCanceled)return;h(D,"display","none"),this.options.removeCloneOnHide&&D.parentNode&&D.parentNode.removeChild(D),ne=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(ne){if(M("showClone",this),g.eventCanceled)return;f.parentNode==k&&!this.options.group.revertClone?k.insertBefore(D,f):ce?k.insertBefore(D,ce):k.appendChild(D),this.options.group.revertClone&&this.animate(f,D),h(D,"display",""),ne=!1}}};function Hn(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Ve(t,e,n,r,a,o,i,l){var s,u=t[B],m=u.options.onMove,c;return window.CustomEvent&&!Q&&!Te?s=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent("move",!0,!0)),s.to=e,s.from=t,s.dragged=n,s.draggedRect=r,s.related=a||e,s.relatedRect=o||O(e),s.willInsertAfter=l,s.originalEvent=i,t.dispatchEvent(s),m&&(c=m.call(u,s,i)),c}function et(t){t.draggable=!1}function Xn(){rt=!1}function Gn(t,e,n){var r=O(he(n.el,0,n.options,!0)),a=Ht(n.el,n.options,w),o=10;return e?t.clientX<a.left-o||t.clientY<r.top&&t.clientX<r.right:t.clientY<a.top-o||t.clientY<r.bottom&&t.clientX<r.left}function $n(t,e,n){var r=O(ft(n.el,n.options.draggable)),a=Ht(n.el,n.options,w),o=10;return e?t.clientX>a.right+o||t.clientY>r.bottom&&t.clientX>r.left:t.clientY>a.bottom+o||t.clientX>r.right&&t.clientY>r.top}function Wn(t,e,n,r,a,o,i,l){var s=r?t.clientY:t.clientX,u=r?n.height:n.width,m=r?n.top:n.left,c=r?n.bottom:n.right,d=!1;if(!i){if(l&&Be<u*a){if(!Se&&(Oe===1?s>m+u*o/2:s<c-u*o/2)&&(Se=!0),Se)d=!0;else if(Oe===1?s<m+Be:s>c-Be)return-Oe}else if(s>m+u*(1-a)/2&&s<c-u*(1-a)/2)return zn(e)}return d=d||i,d&&(s<m+u*o/2||s>c-u*o/2)?s>m+u/2?1:-1:0}function zn(t){return L(f)<L(t)?1:-1}function Un(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,r=0;n--;)r+=e.charCodeAt(n);return r.toString(36)}function Kn(t){Ge.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var r=e[n];r.checked&&Ge.push(r)}}function Le(t){return setTimeout(t,0)}function at(t){return clearTimeout(t)}ze&&y(document,"touchmove",function(t){(g.active||fe)&&t.cancelable&&t.preventDefault()});g.utils={on:y,off:_,css:h,find:Bt,is:function(e,n){return!!X(e,n,e,!1)},extend:In,throttle:Lt,closest:X,toggleClass:R,clone:qt,index:L,nextTick:Le,cancelNextTick:at,detectDirection:Gt,getChild:he};g.get=function(t){return t[B]};g.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(g.utils=W(W({},g.utils),r.utils)),Ae.mount(r)})};g.create=function(t,e){return new g(t,e)};g.version=xn;var P=[],Ee,lt,st=!1,tt,nt,$e,ke;function Zn(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(n){var r=n.originalEvent;this.sortable.nativeDraggable?y(document,"dragover",this._handleAutoScroll):this.options.supportPointer?y(document,"pointermove",this._handleFallbackAutoScroll):r.touches?y(document,"touchmove",this._handleFallbackAutoScroll):y(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var r=n.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?_(document,"dragover",this._handleAutoScroll):(_(document,"pointermove",this._handleFallbackAutoScroll),_(document,"touchmove",this._handleFallbackAutoScroll),_(document,"mousemove",this._handleFallbackAutoScroll)),Ct(),Ye(),Fn()},nulling:function(){$e=lt=Ee=st=ke=tt=nt=null,P.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,r){var a=this,o=(n.touches?n.touches[0]:n).clientX,i=(n.touches?n.touches[0]:n).clientY,l=document.elementFromPoint(o,i);if($e=n,r||this.options.forceAutoScrollFallback||Te||Q||De){ot(n,this.options,l,r);var s=oe(l,!0);st&&(!ke||o!==tt||i!==nt)&&(ke&&Ct(),ke=setInterval(function(){var u=oe(document.elementFromPoint(o,i),!0);u!==s&&(s=u,Ye()),ot(n,a.options,u,r)},10),tt=o,nt=i)}else{if(!this.options.bubbleScroll||oe(l,!0)===$()){Ye();return}ot(n,this.options,oe(l,!1),!1)}}},Z(t,{pluginName:"scroll",initializeByDefault:!0})}function Ye(){P.forEach(function(t){clearInterval(t.pid)}),P=[]}function Ct(){clearInterval(ke)}var ot=Lt(function(t,e,n,r){if(e.scroll){var a=(t.touches?t.touches[0]:t).clientX,o=(t.touches?t.touches[0]:t).clientY,i=e.scrollSensitivity,l=e.scrollSpeed,s=$(),u=!1,m;lt!==n&&(lt=n,Ye(),Ee=e.scroll,m=e.scrollFn,Ee===!0&&(Ee=oe(n,!0)));var c=0,d=Ee;do{var p=d,b=O(p),E=b.top,Y=b.bottom,z=b.left,I=b.right,q=b.width,N=b.height,ie=void 0,G=void 0,re=p.scrollWidth,ge=p.scrollHeight,V=h(p),we=p.scrollLeft,J=p.scrollTop;p===s?(ie=q<re&&(V.overflowX==="auto"||V.overflowX==="scroll"||V.overflowX==="visible"),G=N<ge&&(V.overflowY==="auto"||V.overflowY==="scroll"||V.overflowY==="visible")):(ie=q<re&&(V.overflowX==="auto"||V.overflowX==="scroll"),G=N<ge&&(V.overflowY==="auto"||V.overflowY==="scroll"));var ve=ie&&(Math.abs(I-a)<=i&&we+q<re)-(Math.abs(z-a)<=i&&!!we),U=G&&(Math.abs(Y-o)<=i&&J+N<ge)-(Math.abs(E-o)<=i&&!!J);if(!P[c])for(var ae=0;ae<=c;ae++)P[ae]||(P[ae]={});(P[c].vx!=ve||P[c].vy!=U||P[c].el!==p)&&(P[c].el=p,P[c].vx=ve,P[c].vy=U,clearInterval(P[c].pid),(ve!=0||U!=0)&&(u=!0,P[c].pid=setInterval(function(){r&&this.layer===0&&g.active._onTouchMove($e);var be=P[this.layer].vy?P[this.layer].vy*l:0,ee=P[this.layer].vx?P[this.layer].vx*l:0;typeof m=="function"&&m.call(g.dragged.parentNode[B],ee,be,t,$e,P[this.layer].el)!=="continue"||Yt(P[this.layer].el,ee,be)}.bind({layer:c}),24))),c++}while(e.bubbleScroll&&d!==s&&(d=oe(d,!1)));st=u}},30),Ut=function(e){var n=e.originalEvent,r=e.putSortable,a=e.dragEl,o=e.activeSortable,i=e.dispatchSortableEvent,l=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(n){var u=r||o;l();var m=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,c=document.elementFromPoint(m.clientX,m.clientY);s(),u&&!u.el.contains(c)&&(i("spill"),this.onSpill({dragEl:a,putSortable:r}))}};function dt(){}dt.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var a=he(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(n,a):this.sortable.el.appendChild(n),this.sortable.animateAll(),r&&r.animateAll()},drop:Ut};Z(dt,{pluginName:"revertOnSpill"});function pt(){}pt.prototype={onSpill:function(e){var n=e.dragEl,r=e.putSortable,a=r||this.sortable;a.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),a.animateAll()},drop:Ut};Z(pt,{pluginName:"removeOnSpill"});g.mount(new Zn);g.mount(pt,dt);const Qn=Pt.extend({options:{handle:".js-sort",item:".js-draggable"},initialize(){this.shouldDisable=this.getOption("shouldDisable")},shouldDisable(){return this.view.collection.length<2},collectionEvents:{"update change:id":"updateDisabled"},updateDisabled(){const t=this.shouldDisable();this.view.$el.toggleClass("is-draggable",!t),this.sortable.option("disabled",t)},onRender(){this.sortable&&this.sortable.destroy(),this.sortable=g.create(this.el,{handle:this.getOption("handle"),item:this.getOption("item"),direction:"vertical",onEnd:this.onEnd.bind(this),onStart:this.onStart.bind(this)}),this.updateDisabled()},onBeforeDestroy(){this.sortable.destroy()},onEnd({oldIndex:t,newIndex:e}){const n=this.view.collection.models[t];this.view.$el.removeClass("is-dragging"),this.view.collection.models.splice(t,1),this.view.collection.models.splice(e,0,n),this.view.triggerMethod("drag:end",n)},onStart({oldIndex:t}){const e=this.view.collection.models[t];this.view.$el.addClass("is-dragging"),this.view.triggerMethod("drag:start",e)}}),Jn=S.template({1:function(t,e,n,r,a){var o,i=t.lookupProperty||function(l,s){if(Object.prototype.hasOwnProperty.call(l,s))return l[s]};return"<em>"+t.escapeExpression(t.lambda((o=(o=(o=(o=(o=a&&i(a,"intl"))&&i(o,"programs"))&&i(o,"program"))&&i(o,"flow"))&&i(o,"actionItemTemplate"))&&i(o,"newProgramFlowAction"),e))+"</em>"},3:function(t,e,n,r,a){var o=t.lookupProperty||function(i,l){if(Object.prototype.hasOwnProperty.call(i,l))return i[l]};return'        <button class="js-form button-secondary--compact">'+t.escapeExpression((o(n,"far")||e&&o(e,"far")||t.hooks.helperMissing).call(e??(t.nullContext||{}),"square-poll-horizontal",{name:"far",hash:{},data:a,loc:{start:{line:15,column:58},end:{line:15,column:90}}}))+`</button>
`},compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i,l=e??(t.nullContext||{}),s=t.hooks.helperMissing,u=t.escapeExpression,m="function",c=t.lookupProperty||function(d,p){if(Object.prototype.hasOwnProperty.call(d,p))return d[p]};return`<td class="table-list__cell w-40">
  <span class="program-flow__action-icon">`+u((c(n,"far")||e&&c(e,"far")||s).call(l,e!=null?c(e,"icon"):e,{name:"far",hash:{},data:a,loc:{start:{line:2,column:42},end:{line:2,column:54}}}))+"</span>"+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:2,column:61},end:{line:2,column:86}}}):i))+`<span class="program-flow__action-name">
    `+u((i=(i=c(n,"name")||(e!=null?c(e,"name"):e))!=null?i:s,typeof i===m?i.call(l,{name:"name",hash:{},data:a,loc:{start:{line:4,column:4},end:{line:4,column:14}}}):i))+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:4,column:14},end:{line:4,column:39}}}):i))+((o=c(n,"unless").call(l,e!=null?c(e,"name"):e,{name:"unless",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a,loc:{start:{line:5,column:4},end:{line:5,column:115}}}))!=null?o:"")+`</span>
</td>
<td class="table-list__cell w-60">
  <div class="pos--relative">
    <span class="table-list__meta" data-behavior-region></span>`+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:10,column:63},end:{line:10,column:88}}}):i))+'<span class="table-list__meta" data-owner-region></span>'+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:11,column:60},end:{line:11,column:85}}}):i))+'<span class="table-list__meta" data-due-region></span>'+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:12,column:58},end:{line:12,column:83}}}):i))+`<span class="table-list__meta">
`+((o=c(n,"if").call(l,e!=null?c(e,"hasForm"):e,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a,loc:{start:{line:14,column:6},end:{line:16,column:14}}}))!=null?o:"")+"    </span>"+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:17,column:11},end:{line:17,column:36}}}):i))+'<span class="program-flow__action-ts">'+u((c(n,"formatDateTime")||e&&c(e,"formatDateTime")||s).call(l,e!=null?c(e,"updated_at"):e,"TIME_OR_DAY",{name:"formatDateTime",hash:{},data:a,loc:{start:{line:18,column:42},end:{line:18,column:85}}}))+`</span>
    <span class="program-flow__sort-handle js-sort">`+u((c(n,"fas")||e&&c(e,"fas")||s).call(l,"grip-vertical",{name:"fas",hash:{},data:a,loc:{start:{line:19,column:52},end:{line:19,column:75}}}))+"</span>"+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:19,column:82},end:{line:19,column:107}}}):i))+`</div>
</td>
`},useData:!0}),eo=S.template({1:function(t,e,n,r,a){var o,i=t.lookupProperty||function(l,s){if(Object.prototype.hasOwnProperty.call(l,s))return l[s]};return"    "+t.escapeExpression((o=(o=i(n,"details")||(e!=null?i(e,"details"):e))!=null?o:t.hooks.helperMissing,typeof o=="function"?o.call(e??(t.nullContext||{}),{name:"details",hash:{},data:a,loc:{start:{line:5,column:4},end:{line:5,column:17}}}):o))+`
`},3:function(t,e,n,r,a){var o=t.lookupProperty||function(i,l){if(Object.prototype.hasOwnProperty.call(i,l))return i[l]};return'    <button class="program-flow__meta button-secondary">'+t.escapeExpression((o(n,"far")||e&&o(e,"far")||t.hooks.helperMissing).call(e??(t.nullContext||{}),"pen-to-square",{name:"far",hash:{},data:a,loc:{start:{line:7,column:56},end:{line:7,column:79}}}))+` Add Details</button>
`},compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i,l=e??(t.nullContext||{}),s=t.hooks.helperMissing,u=t.escapeExpression,m="function",c=t.lookupProperty||function(d,p){if(Object.prototype.hasOwnProperty.call(d,p))return d[p]};return'<h1 class="program-flow__name">'+u((c(n,"fas")||e&&c(e,"fas")||s).call(l,"folder-open",{name:"fas",hash:{},data:a,loc:{start:{line:1,column:31},end:{line:1,column:52}}}))+" "+u((i=(i=c(n,"name")||(e!=null?c(e,"name"):e))!=null?i:s,typeof i===m?i.call(l,{name:"name",hash:{},data:a,loc:{start:{line:1,column:53},end:{line:1,column:63}}}):i))+`</h1>
<div>
  <p class="program-flow__details">
`+((o=c(n,"if").call(l,e!=null?c(e,"details"):e,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.program(3,a,0),data:a,loc:{start:{line:4,column:2},end:{line:8,column:9}}}))!=null?o:"")+"  </p>"+u((i=(i=c(n,"remove_whitespace")||(e!=null?c(e,"remove_whitespace"):e))!=null?i:s,typeof i===m?i.call(l,{name:"remove_whitespace",hash:{},data:a,loc:{start:{line:9,column:6},end:{line:9,column:31}}}):i))+`<span class="program-flow__meta" data-behavior-region></span>
  <span class="program-flow__meta" data-owner-region></span>
</div>
`},useData:!0}),to=A.extend({modelEvents:{"change:name":"render"},initialize({program:t}){this.program=t,this.listenTo(this.program,"change:name",this.render)},className:"program-flow__context-trail",template:S.template({1:function(t,e,n,r,a){var o,i=e??(t.nullContext||{}),l=t.hooks.helperMissing,s=t.escapeExpression,u=t.lookupProperty||function(m,c){if(Object.prototype.hasOwnProperty.call(m,c))return m[c]};return`      <a class="js-back program-flow__context-link">
        `+s((u(n,"fas")||e&&u(e,"fas")||l).call(i,"chevron-left",{name:"fas",hash:{},data:a,loc:{start:{line:4,column:8},end:{line:4,column:30}}}))+s(t.lambda((o=(o=(o=(o=(o=a&&u(a,"intl"))&&u(o,"programs"))&&u(o,"program"))&&u(o,"flow"))&&u(o,"flowViews"))&&u(o,"contextBackBtn"),e))+`
      </a>
      `+s((u(n,"fas")||e&&u(e,"fas")||l).call(i,"chevron-right",{name:"fas",hash:{},data:a,loc:{start:{line:6,column:6},end:{line:6,column:29}}}))+`
`},compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i,l=e??(t.nullContext||{}),s=t.hooks.helperMissing,u="function",m=t.escapeExpression,c=t.lookupProperty||function(d,p){if(Object.prototype.hasOwnProperty.call(d,p))return d[p]};return`
`+((o=c(n,"if").call(l,e!=null?c(e,"hasLatestList"):e,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a,loc:{start:{line:2,column:4},end:{line:7,column:11}}}))!=null?o:"")+'    <a class="js-program program-flow__context-link">'+m((i=(i=c(n,"programName")||(e!=null?c(e,"programName"):e))!=null?i:s,typeof i===u?i.call(l,{name:"programName",hash:{},data:a,loc:{start:{line:8,column:53},end:{line:8,column:70}}}):i))+"</a>"+m((c(n,"fas")||e&&c(e,"fas")||s).call(l,"chevron-right",{name:"fas",hash:{},data:a,loc:{start:{line:8,column:74},end:{line:8,column:97}}}))+m((i=(i=c(n,"name")||(e!=null?c(e,"name"):e))!=null?i:s,typeof i===u?i.call(l,{name:"name",hash:{},data:a,loc:{start:{line:8,column:97},end:{line:8,column:107}}}):i))+`
  `},useData:!0}),triggers:{"click .js-back":"click:back","click .js-program":"click:program"},onClickBack(){v.request("history","go:latestList")},onClickProgram(){v.trigger("event-router","program:details",this.program.id)},templateContext(){return{hasLatestList:v.request("history","has:latestList"),programName:this.program.get("name")}}}),no=A.extend({className:"program-flow__header",modelEvents:{editing:"onEditing",change:"render"},onEditing(t){this.$el.toggleClass("is-selected",t)},template:eo,regions:{behavior:"[data-behavior-region]",owner:"[data-owner-region]"},triggers:{click:"edit"},onRender(){this.showBehavior(),this.showOwner()},showBehavior(){const t=new an({behavior:this.model.get("behavior"),isCompact:!0});this.listenTo(t,"change:status",({behavior:e})=>{this.model.save({behavior:e})}),this.showChildView("behavior",t)},showOwner(){const t=new It({owner:this.model.getOwner(),isCompact:!0});this.listenTo(t,"change:owner",e=>{this.model.saveOwner(e)}),this.showChildView("owner",t)}}),oo=A.extend({className:"program-flow__actions",template:S.template({compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i=t.escapeExpression,l=t.lookupProperty||function(s,u){if(Object.prototype.hasOwnProperty.call(s,u))return s[u]};return`
    <button class="button-primary js-add-action">
      `+i((l(n,"far")||e&&l(e,"far")||t.hooks.helperMissing).call(e??(t.nullContext||{}),"circle-plus",{name:"far",hash:{},data:a,loc:{start:{line:3,column:6},end:{line:3,column:27}}}))+"<span>"+i(t.lambda((o=(o=(o=(o=(o=a&&l(a,"intl"))&&l(o,"programs"))&&l(o,"program"))&&l(o,"flow"))&&l(o,"flowViews"))&&l(o,"addActionBtn"),e))+`</span>
    </button>
  `},useData:!0}),triggers:{"click .js-add-action":"click:addAction"}}),io=A.extend({tagName:"tr",template:S.template({compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){var o,i=t.lookupProperty||function(l,s){if(Object.prototype.hasOwnProperty.call(l,s))return l[s]};return`
    <td class="program-flow__empty-list">
      <h2>`+t.escapeExpression(t.lambda((o=(o=(o=(o=(o=a&&i(a,"intl"))&&i(o,"programs"))&&i(o,"program"))&&i(o,"flow"))&&i(o,"flowViews"))&&i(o,"emptyView"),e))+`</h2>
    </td>
  `},useData:!0})}),ro=A.extend({modelEvents:{change:"render",editing:"onEditing"},className(){const t="table-list__item program-flow__action-item js-draggable";return this.model.isNew()?`${t} is-selected`:t},template:Jn,templateContext(){return{hasForm:this.model.getForm(),icon:this.model.hasOutreach()?"share-from-square":"file-lines"}},tagName:"tr",regions:{behavior:"[data-behavior-region]",owner:"[data-owner-region]",due:"[data-due-region]"},ui:{form:".js-form"},triggers:{click:"click","click @ui.form":"click:form"},onClick(){if(this.model.isNew()){v.trigger("event-router","programFlow:action:new",this.model.get("_program_flow"));return}v.trigger("event-router","programFlow:action",this.model.get("_program_flow"),this.model.id)},onClickForm(){const t=this.model.getForm();v.trigger("event-router","form:preview",t.id)},onEditing(t){this.$el.toggleClass("is-selected",t)},onRender(){this.showBehavior(),this.showOwner(),this.showDue()},showDue(){const t=this.model.isNew(),e=new At({day:this.model.get("days_until_due"),isCompact:!0,state:{isDisabled:t}});this.listenTo(e,"change:day",n=>{this.model.save({days_until_due:n})}),this.showChildView("due",e)},showBehavior(){const t=this.model.isNew(),e=new xt({behavior:this.model.get("behavior"),isCompact:!0,state:{isDisabled:t}});this.listenTo(e,"change:status",({behavior:n})=>{this.model.save({behavior:n})}),this.showChildView("behavior",e)},showOwner(){const t=this.model.isNew(),e=!!this.model.get("_program_flow"),n=new Tt({owner:this.model.getOwner(),isFromFlow:e,isCompact:!0,state:{isDisabled:t}});this.listenTo(n,"change:owner",r=>{this.model.saveOwner(r)}),this.showChildView("owner",n)}}),ao=ct.extend({behaviors:[{behaviorClass:Qn,shouldDisable(){return this.view.collection.length<2||this.view.collection.last().isNew()}}],collectionEvents:{"change:id":"onChangeId"},className:"table-list program-flow__list",tagName:"table",childView:ro,emptyView:io,onDragEnd(){this.collection.updateSequences()},onChangeId(){this.collection.updateSequences()}}),lo=A.extend({className:"program-flow__frame",template:S.template({compiler:[8,">= 4.3.0"],main:function(t,e,n,r,a){return`
    <div class="program-flow__layout">
      <div data-context-trail-region></div>
      <div data-header-region></div>
      <div data-add-action-region></div>
      <div data-action-list-region></div>
    </div>
    <div class="program-flow__sidebar" data-sidebar-region></div>
  `},useData:!0}),regions:{contextTrail:{el:"[data-context-trail-region]",replaceElement:!0},header:"[data-header-region]",addAction:"[data-add-action-region]",sidebar:"[data-sidebar-region]",actionList:{el:"[data-action-list-region]",regionClass:We,replaceElement:!0}}}),so=St.extend({routerAppName:"ProgramFlowApp",childApps:{action:Mt},eventRoutes:{"programFlow:action":"showActionSidebar","programFlow:action:new":"showActionSidebar"},onBeforeStart(){this.showView(new lo)},beforeStart({flowId:t}){return[v.request("entities","fetch:programs:model:byProgramFlow",t),v.request("entities","fetch:programFlows:model",t),v.request("entities","fetch:programActions:collection:byProgramFlow",t)]},onFail(){v.trigger("event-router","notFound"),this.stop()},onStart({currentRoute:t},e,n,r){this.program=e,this.flow=n,this.actions=r,this.maintainFlowActions(),this.showChildView("contextTrail",new to({model:this.flow,program:this.program})),this.showHeader(),this.showAddAction(),this.showActionList(),this.showProgramSidebar(),this.startRoute(t)},maintainFlowActions(){this.listenTo(this.actions,"change:id destroy",()=>{const t=this.actions.map(({id:e})=>({id:e}));this.flow.set("_program_actions",t)})},showHeader(){const t=new no({model:this.flow});this.listenTo(t,{edit:this.onEditFlow}),this.showChildView("header",t)},showAddAction(){const t=new oo;this.listenTo(t,{"click:addAction":()=>{v.trigger("event-router","programFlow:action:new",this.flow.id)}}),this.showChildView("addAction",t)},showActionList(){this.showChildView("actionList",new ao({collection:this.actions}))},showProgramSidebar(){const t=new Nt({model:this.program});this.listenTo(t,{edit:this.onEditProgram}),this.showChildView("sidebar",t)},showActionSidebar(t,e){const n=this.getChildApp("action");this.listenToOnce(n,{start(r,a){this.editAction(a)}}),this.startChildApp("action",{actionId:e,flowId:t})},editAction(t){if(t.isNew()){t.set({sequence:this.actions.length}),this.actions.add(t);return}t.trigger("editing",!0)},onEditProgram(){v.request("sidebar","start","program",{program:this.program})},onEditFlow(){v.request("sidebar","start","programFlow",{flow:this.flow})}}),ko=Qt.extend({routerAppName:"ProgramsApp",childApps:{programsAll:mn,program:Cn,programflow:so},eventRoutes:{"programs:all":{action:"showProgramsAll",route:"programs",isList:!0},"program:details":{action:"showProgram",route:"program/:id"},"program:action":{action:"showProgram",route:"program/:id/action/:id"},"program:action:new":{action:"showProgram",route:"program/:id/action"},"programFlow:new":{action:"showProgram",route:"program/:id/flow"},programFlow:{action:"showProgramFlow",route:"program-flow/:id"},"programFlow:action":{action:"showProgramFlow",route:"program-flow/:id/action/:id"},"programFlow:action:new":{action:"showProgramFlow",route:"program-flow/:id/action"}},showProgramsAll(){this.startCurrent("programsAll")},showProgram(t){this.startRoute("program",{programId:t})},showProgramFlow(t){this.startRoute("programflow",{flowId:t})}});export{ko as default};
