import{R as St}from"./20241003-runtime-C_JJASG6.js";import{h as Me,a2 as fe,e as Pe,a as Re,a3 as je,a4 as Ye}from"./20241003-index-DFBLEA3t.js";import{L as qe}from"./20241003-prelogin_views-CRgMGhV-.js";/* empty css                        */function H(o,e){var t={};for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&e.indexOf(n)<0&&(t[n]=o[n]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function"){var i=0;for(n=Object.getOwnPropertySymbols(o);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(o,n[i])&&(t[n[i]]=o[n[i]])}return t}var q=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Be(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function Qe(o,e){return o(e={exports:{}},e.exports),e.exports}var Y=Qe(function(o,e){Object.defineProperty(e,"__esModule",{value:!0});var t=function(){function n(){var i=this;this.locked=new Map,this.addToLocked=function(r,s){var c=i.locked.get(r);c===void 0?s===void 0?i.locked.set(r,[]):i.locked.set(r,[s]):s!==void 0&&(c.unshift(s),i.locked.set(r,c))},this.isLocked=function(r){return i.locked.has(r)},this.lock=function(r){return new Promise(function(s,c){i.isLocked(r)?i.addToLocked(r,s):(i.addToLocked(r),s())})},this.unlock=function(r){var s=i.locked.get(r);if(s!==void 0&&s.length!==0){var c=s.pop();i.locked.set(r,s),c!==void 0&&setTimeout(c,0)}else i.locked.delete(r)}}return n.getInstance=function(){return n.instance===void 0&&(n.instance=new n),n.instance},n}();e.default=function(){return t.getInstance()}});Be(Y);var Mt=Be(Qe(function(o,e){var t=q&&q.__awaiter||function(a,l,u,d){return new(u||(u=Promise))(function(p,w){function k(_){try{I(d.next(_))}catch(f){w(f)}}function y(_){try{I(d.throw(_))}catch(f){w(f)}}function I(_){_.done?p(_.value):new u(function(f){f(_.value)}).then(k,y)}I((d=d.apply(a,l||[])).next())})},n=q&&q.__generator||function(a,l){var u,d,p,w,k={label:0,sent:function(){if(1&p[0])throw p[1];return p[1]},trys:[],ops:[]};return w={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function y(I){return function(_){return function(f){if(u)throw new TypeError("Generator is already executing.");for(;k;)try{if(u=1,d&&(p=2&f[0]?d.return:f[0]?d.throw||((p=d.return)&&p.call(d),0):d.next)&&!(p=p.call(d,f[1])).done)return p;switch(d=0,p&&(f=[2&f[0],p.value]),f[0]){case 0:case 1:p=f;break;case 4:return k.label++,{value:f[1],done:!1};case 5:k.label++,d=f[1],f=[0];continue;case 7:f=k.ops.pop(),k.trys.pop();continue;default:if(p=k.trys,!((p=p.length>0&&p[p.length-1])||f[0]!==6&&f[0]!==2)){k=0;continue}if(f[0]===3&&(!p||f[1]>p[0]&&f[1]<p[3])){k.label=f[1];break}if(f[0]===6&&k.label<p[1]){k.label=p[1],p=f;break}if(p&&k.label<p[2]){k.label=p[2],k.ops.push(f);break}p[2]&&k.ops.pop(),k.trys.pop();continue}f=l.call(a,k)}catch(C){f=[6,C],d=0}finally{u=p=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}([I,_])}}},i=q;Object.defineProperty(e,"__esModule",{value:!0});var r="browser-tabs-lock-key",s={key:function(a){return t(i,void 0,void 0,function(){return n(this,function(l){throw new Error("Unsupported")})})},getItem:function(a){return t(i,void 0,void 0,function(){return n(this,function(l){throw new Error("Unsupported")})})},clear:function(){return t(i,void 0,void 0,function(){return n(this,function(a){return[2,window.localStorage.clear()]})})},removeItem:function(a){return t(i,void 0,void 0,function(){return n(this,function(l){throw new Error("Unsupported")})})},setItem:function(a,l){return t(i,void 0,void 0,function(){return n(this,function(u){throw new Error("Unsupported")})})},keySync:function(a){return window.localStorage.key(a)},getItemSync:function(a){return window.localStorage.getItem(a)},clearSync:function(){return window.localStorage.clear()},removeItemSync:function(a){return window.localStorage.removeItem(a)},setItemSync:function(a,l){return window.localStorage.setItem(a,l)}};function c(a){return new Promise(function(l){return setTimeout(l,a)})}function h(a){for(var l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",u="",d=0;d<a;d++)u+=l[Math.floor(Math.random()*l.length)];return u}var m=function(){function a(l){this.acquiredIatSet=new Set,this.storageHandler=void 0,this.id=Date.now().toString()+h(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),this.storageHandler=l,a.waiters===void 0&&(a.waiters=[])}return a.prototype.acquireLock=function(l,u){return u===void 0&&(u=5e3),t(this,void 0,void 0,function(){var d,p,w,k,y,I,_;return n(this,function(f){switch(f.label){case 0:d=Date.now()+h(4),p=Date.now()+u,w=r+"-"+l,k=this.storageHandler===void 0?s:this.storageHandler,f.label=1;case 1:return Date.now()<p?[4,c(30)]:[3,8];case 2:return f.sent(),k.getItemSync(w)!==null?[3,5]:(y=this.id+"-"+l+"-"+d,[4,c(Math.floor(25*Math.random()))]);case 3:return f.sent(),k.setItemSync(w,JSON.stringify({id:this.id,iat:d,timeoutKey:y,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,c(30)];case 4:return f.sent(),(I=k.getItemSync(w))!==null&&(_=JSON.parse(I)).id===this.id&&_.iat===d?(this.acquiredIatSet.add(d),this.refreshLockWhileAcquired(w,d),[2,!0]):[3,7];case 5:return a.lockCorrector(this.storageHandler===void 0?s:this.storageHandler),[4,this.waitForSomethingToChange(p)];case 6:f.sent(),f.label=7;case 7:return d=Date.now()+h(4),[3,1];case 8:return[2,!1]}})})},a.prototype.refreshLockWhileAcquired=function(l,u){return t(this,void 0,void 0,function(){var d=this;return n(this,function(p){return setTimeout(function(){return t(d,void 0,void 0,function(){var w,k,y;return n(this,function(I){switch(I.label){case 0:return[4,Y.default().lock(u)];case 1:return I.sent(),this.acquiredIatSet.has(u)?(w=this.storageHandler===void 0?s:this.storageHandler,(k=w.getItemSync(l))===null?(Y.default().unlock(u),[2]):((y=JSON.parse(k)).timeRefreshed=Date.now(),w.setItemSync(l,JSON.stringify(y)),Y.default().unlock(u),this.refreshLockWhileAcquired(l,u),[2])):(Y.default().unlock(u),[2])}})})},1e3),[2]})})},a.prototype.waitForSomethingToChange=function(l){return t(this,void 0,void 0,function(){return n(this,function(u){switch(u.label){case 0:return[4,new Promise(function(d){var p=!1,w=Date.now(),k=!1;function y(){if(k||(window.removeEventListener("storage",y),a.removeFromWaiting(y),clearTimeout(I),k=!0),!p){p=!0;var _=50-(Date.now()-w);_>0?setTimeout(d,_):d(null)}}window.addEventListener("storage",y),a.addToWaiting(y);var I=setTimeout(y,Math.max(0,l-Date.now()))})];case 1:return u.sent(),[2]}})})},a.addToWaiting=function(l){this.removeFromWaiting(l),a.waiters!==void 0&&a.waiters.push(l)},a.removeFromWaiting=function(l){a.waiters!==void 0&&(a.waiters=a.waiters.filter(function(u){return u!==l}))},a.notifyWaiters=function(){a.waiters!==void 0&&a.waiters.slice().forEach(function(l){return l()})},a.prototype.releaseLock=function(l){return t(this,void 0,void 0,function(){return n(this,function(u){switch(u.label){case 0:return[4,this.releaseLock__private__(l)];case 1:return[2,u.sent()]}})})},a.prototype.releaseLock__private__=function(l){return t(this,void 0,void 0,function(){var u,d,p,w;return n(this,function(k){switch(k.label){case 0:return u=this.storageHandler===void 0?s:this.storageHandler,d=r+"-"+l,(p=u.getItemSync(d))===null?[2]:(w=JSON.parse(p)).id!==this.id?[3,2]:[4,Y.default().lock(w.iat)];case 1:k.sent(),this.acquiredIatSet.delete(w.iat),u.removeItemSync(d),Y.default().unlock(w.iat),a.notifyWaiters(),k.label=2;case 2:return[2]}})})},a.lockCorrector=function(l){for(var u=Date.now()-5e3,d=l,p=[],w=0;;){var k=d.keySync(w);if(k===null)break;p.push(k),w++}for(var y=!1,I=0;I<p.length;I++){var _=p[I];if(_.includes(r)){var f=d.getItemSync(_);if(f!==null){var C=JSON.parse(f);(C.timeRefreshed===void 0&&C.timeAcquired<u||C.timeRefreshed!==void 0&&C.timeRefreshed<u)&&(d.removeItemSync(_),y=!0)}}}y&&a.notifyWaiters()},a.waiters=void 0,a}();e.default=m}));const Yt={timeoutInSeconds:60},Tt={name:"auth0-spa-js",version:"2.1.3"},Ot=()=>Date.now();class R extends Error{constructor(e,t){super(t),this.error=e,this.error_description=t,Object.setPrototypeOf(this,R.prototype)}static fromPayload({error:e,error_description:t}){return new R(e,t)}}class et extends R{constructor(e,t,n,i=null){super(e,t),this.state=n,this.appState=i,Object.setPrototypeOf(this,et.prototype)}}class _e extends R{constructor(){super("timeout","Timeout"),Object.setPrototypeOf(this,_e.prototype)}}class tt extends _e{constructor(e){super(),this.popup=e,Object.setPrototypeOf(this,tt.prototype)}}class ot extends R{constructor(e){super("cancelled","Popup closed"),this.popup=e,Object.setPrototypeOf(this,ot.prototype)}}class nt extends R{constructor(e,t,n){super(e,t),this.mfa_token=n,Object.setPrototypeOf(this,nt.prototype)}}class Le extends R{constructor(e,t){super("missing_refresh_token",`Missing Refresh Token (audience: '${ct(e,["default"])}', scope: '${ct(t)}')`),this.audience=e,this.scope=t,Object.setPrototypeOf(this,Le.prototype)}}function ct(o,e=[]){return o&&!e.includes(o)?o:""}const Te=()=>window.crypto,Ne=()=>{const o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.";let e="";return Array.from(Te().getRandomValues(new Uint8Array(43))).forEach(t=>e+=o[t%o.length]),e},lt=o=>btoa(o),He=o=>{var{clientId:e}=o,t=H(o,["clientId"]);return new URLSearchParams((n=>Object.keys(n).filter(i=>n[i]!==void 0).reduce((i,r)=>Object.assign(Object.assign({},i),{[r]:n[r]}),{}))(Object.assign({client_id:e},t))).toString()},ut=o=>(e=>decodeURIComponent(atob(e).split("").map(t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join("")))(o.replace(/_/g,"/").replace(/-/g,"+")),qt=async(o,e)=>{const t=await fetch(o,e);return{ok:t.ok,json:await t.json()}},Bt=async(o,e,t)=>{const n=new AbortController;let i;return e.signal=n.signal,Promise.race([qt(o,e),new Promise((r,s)=>{i=setTimeout(()=>{n.abort(),s(new Error("Timeout when executing 'fetch'"))},t)})]).finally(()=>{clearTimeout(i)})},Qt=async(o,e,t,n,i,r,s)=>{return c={auth:{audience:e,scope:t},timeout:i,fetchUrl:o,fetchOptions:n,useFormData:s},h=r,new Promise(function(m,a){const l=new MessageChannel;l.port1.onmessage=function(u){u.data.error?a(new Error(u.data.error)):m(u.data),l.port1.close()},h.postMessage(c,[l.port2])});var c,h},eo=async(o,e,t,n,i,r,s=1e4)=>i?Qt(o,e,t,n,s,i,r):Bt(o,n,s);async function to(o,e){var{baseUrl:t,timeout:n,audience:i,scope:r,auth0Client:s,useFormData:c}=o,h=H(o,["baseUrl","timeout","audience","scope","auth0Client","useFormData"]);const m=c?He(h):JSON.stringify(h);return await async function(a,l,u,d,p,w,k){let y,I=null;for(let $=0;$<3;$++)try{y=await eo(a,u,d,p,w,k,l),I=null;break}catch(de){I=de}if(I)throw I;const _=y.json,{error:f,error_description:C}=_,V=H(_,["error","error_description"]),{ok:E}=y;if(!E){const $=C||`HTTP error. Unable to fetch ${a}`;throw f==="mfa_required"?new nt(f,$,V.mfa_token):f==="missing_refresh_token"?new Le(u,d):new R(f||"request_error",$)}return V}(`${t}/oauth/token`,n,i||"default",r,{method:"POST",body:m,headers:{"Content-Type":c?"application/x-www-form-urlencoded":"application/json","Auth0-Client":btoa(JSON.stringify(s||Tt))}},e,c)}const be=(...o)=>{return(e=o.filter(Boolean).join(" ").trim().split(/\s+/),Array.from(new Set(e))).join(" ");var e};class J{constructor(e,t="@@auth0spajs@@",n){this.prefix=t,this.suffix=n,this.clientId=e.clientId,this.scope=e.scope,this.audience=e.audience}toKey(){return[this.prefix,this.clientId,this.audience,this.scope,this.suffix].filter(Boolean).join("::")}static fromKey(e){const[t,n,i,r]=e.split("::");return new J({clientId:n,scope:r,audience:i},t)}static fromCacheEntry(e){const{scope:t,audience:n,client_id:i}=e;return new J({scope:t,audience:n,clientId:i})}}class oo{set(e,t){localStorage.setItem(e,JSON.stringify(t))}get(e){const t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch{return}}remove(e){localStorage.removeItem(e)}allKeys(){return Object.keys(window.localStorage).filter(e=>e.startsWith("@@auth0spajs@@"))}}class Ct{constructor(){this.enclosedCache=function(){let e={};return{set(t,n){e[t]=n},get(t){const n=e[t];if(n)return n},remove(t){delete e[t]},allKeys:()=>Object.keys(e)}}()}}class no{constructor(e,t,n){this.cache=e,this.keyManifest=t,this.nowProvider=n||Ot}async setIdToken(e,t,n){var i;const r=this.getIdTokenCacheKey(e);await this.cache.set(r,{id_token:t,decodedToken:n}),await((i=this.keyManifest)===null||i===void 0?void 0:i.add(r))}async getIdToken(e){const t=await this.cache.get(this.getIdTokenCacheKey(e.clientId));if(!t&&e.scope&&e.audience){const n=await this.get(e);return!n||!n.id_token||!n.decodedToken?void 0:{id_token:n.id_token,decodedToken:n.decodedToken}}if(t)return{id_token:t.id_token,decodedToken:t.decodedToken}}async get(e,t=0){var n;let i=await this.cache.get(e.toKey());if(!i){const c=await this.getCacheKeys();if(!c)return;const h=this.matchExistingCacheKey(e,c);h&&(i=await this.cache.get(h))}if(!i)return;const r=await this.nowProvider(),s=Math.floor(r/1e3);return i.expiresAt-t<s?i.body.refresh_token?(i.body={refresh_token:i.body.refresh_token},await this.cache.set(e.toKey(),i),i.body):(await this.cache.remove(e.toKey()),void await((n=this.keyManifest)===null||n===void 0?void 0:n.remove(e.toKey()))):i.body}async set(e){var t;const n=new J({clientId:e.client_id,scope:e.scope,audience:e.audience}),i=await this.wrapCacheEntry(e);await this.cache.set(n.toKey(),i),await((t=this.keyManifest)===null||t===void 0?void 0:t.add(n.toKey()))}async clear(e){var t;const n=await this.getCacheKeys();n&&(await n.filter(i=>!e||i.includes(e)).reduce(async(i,r)=>{await i,await this.cache.remove(r)},Promise.resolve()),await((t=this.keyManifest)===null||t===void 0?void 0:t.clear()))}async wrapCacheEntry(e){const t=await this.nowProvider();return{body:e,expiresAt:Math.floor(t/1e3)+e.expires_in}}async getCacheKeys(){var e;return this.keyManifest?(e=await this.keyManifest.get())===null||e===void 0?void 0:e.keys:this.cache.allKeys?this.cache.allKeys():void 0}getIdTokenCacheKey(e){return new J({clientId:e},"@@auth0spajs@@","@@user@@").toKey()}matchExistingCacheKey(e,t){return t.filter(n=>{var i;const r=J.fromKey(n),s=new Set(r.scope&&r.scope.split(" ")),c=((i=e.scope)===null||i===void 0?void 0:i.split(" "))||[],h=r.scope&&c.reduce((m,a)=>m&&s.has(a),!0);return r.prefix==="@@auth0spajs@@"&&r.clientId===e.clientId&&r.audience===e.audience&&h})[0]}}class io{constructor(e,t,n){this.storage=e,this.clientId=t,this.cookieDomain=n,this.storageKey=`a0.spajs.txs.${this.clientId}`}create(e){this.storage.save(this.storageKey,e,{daysUntilExpire:1,cookieDomain:this.cookieDomain})}get(){return this.storage.get(this.storageKey)}remove(){this.storage.remove(this.storageKey,{cookieDomain:this.cookieDomain})}}const pe=o=>typeof o=="number",ro=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"],so=o=>{if(!o.id_token)throw new Error("ID token is required but missing");const e=(r=>{const s=r.split("."),[c,h,m]=s;if(s.length!==3||!c||!h||!m)throw new Error("ID token could not be decoded");const a=JSON.parse(ut(h)),l={__raw:r},u={};return Object.keys(a).forEach(d=>{l[d]=a[d],ro.includes(d)||(u[d]=a[d])}),{encoded:{header:c,payload:h,signature:m},header:JSON.parse(ut(c)),claims:l,user:u}})(o.id_token);if(!e.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(e.claims.iss!==o.iss)throw new Error(`Issuer (iss) claim mismatch in the ID token; expected "${o.iss}", found "${e.claims.iss}"`);if(!e.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if(e.header.alg!=="RS256")throw new Error(`Signature algorithm of "${e.header.alg}" is not supported. Expected the ID token to be signed with "RS256".`);if(!e.claims.aud||typeof e.claims.aud!="string"&&!Array.isArray(e.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(e.claims.aud)){if(!e.claims.aud.includes(o.aud))throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${o.aud}" but was not one of "${e.claims.aud.join(", ")}"`);if(e.claims.aud.length>1){if(!e.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(e.claims.azp!==o.aud)throw new Error(`Authorized Party (azp) claim mismatch in the ID token; expected "${o.aud}", found "${e.claims.azp}"`)}}else if(e.claims.aud!==o.aud)throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${o.aud}" but found "${e.claims.aud}"`);if(o.nonce){if(!e.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(e.claims.nonce!==o.nonce)throw new Error(`Nonce (nonce) claim mismatch in the ID token; expected "${o.nonce}", found "${e.claims.nonce}"`)}if(o.max_age&&!pe(e.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(e.claims.exp==null||!pe(e.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!pe(e.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");const t=o.leeway||60,n=new Date(o.now||Date.now()),i=new Date(0);if(i.setUTCSeconds(e.claims.exp+t),n>i)throw new Error(`Expiration Time (exp) claim error in the ID token; current time (${n}) is after expiration time (${i})`);if(e.claims.nbf!=null&&pe(e.claims.nbf)){const r=new Date(0);if(r.setUTCSeconds(e.claims.nbf-t),n<r)throw new Error(`Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Current time (${n}) is before ${r}`)}if(e.claims.auth_time!=null&&pe(e.claims.auth_time)){const r=new Date(0);if(r.setUTCSeconds(parseInt(e.claims.auth_time)+o.max_age+t),n>r)throw new Error(`Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Current time (${n}) is after last auth at ${r}`)}if(o.organization){const r=o.organization.trim();if(r.startsWith("org_")){const s=r;if(!e.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(s!==e.claims.org_id)throw new Error(`Organization ID (org_id) claim mismatch in the ID token; expected "${s}", found "${e.claims.org_id}"`)}else{const s=r.toLowerCase();if(!e.claims.org_name)throw new Error("Organization Name (org_name) claim must be a string present in the ID token");if(s!==e.claims.org_name)throw new Error(`Organization Name (org_name) claim mismatch in the ID token; expected "${s}", found "${e.claims.org_name}"`)}}return e};var Q=Qe(function(o,e){var t=q&&q.__assign||function(){return t=Object.assign||function(h){for(var m,a=1,l=arguments.length;a<l;a++)for(var u in m=arguments[a])Object.prototype.hasOwnProperty.call(m,u)&&(h[u]=m[u]);return h},t.apply(this,arguments)};function n(h,m){if(!m)return"";var a="; "+h;return m===!0?a:a+"="+m}function i(h,m,a){return encodeURIComponent(h).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(m).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(l){if(typeof l.expires=="number"){var u=new Date;u.setMilliseconds(u.getMilliseconds()+864e5*l.expires),l.expires=u}return n("Expires",l.expires?l.expires.toUTCString():"")+n("Domain",l.domain)+n("Path",l.path)+n("Secure",l.secure)+n("SameSite",l.sameSite)}(a)}function r(h){for(var m={},a=h?h.split("; "):[],l=/(%[\dA-F]{2})+/gi,u=0;u<a.length;u++){var d=a[u].split("="),p=d.slice(1).join("=");p.charAt(0)==='"'&&(p=p.slice(1,-1));try{m[d[0].replace(l,decodeURIComponent)]=p.replace(l,decodeURIComponent)}catch{}}return m}function s(){return r(document.cookie)}function c(h,m,a){document.cookie=i(h,m,t({path:"/"},a))}e.__esModule=!0,e.encode=i,e.parse=r,e.getAll=s,e.get=function(h){return s()[h]},e.set=c,e.remove=function(h,m){c(h,"",t(t({},m),{expires:-1}))}});Be(Q),Q.encode,Q.parse,Q.getAll;var ao=Q.get,Et=Q.set,Pt=Q.remove;const ce={get(o){const e=ao(o);if(e!==void 0)return JSON.parse(e)},save(o,e,t){let n={};window.location.protocol==="https:"&&(n={secure:!0,sameSite:"none"}),t?.daysUntilExpire&&(n.expires=t.daysUntilExpire),t?.cookieDomain&&(n.domain=t.cookieDomain),Et(o,JSON.stringify(e),n)},remove(o,e){let t={};e?.cookieDomain&&(t.domain=e.cookieDomain),Pt(o,t)}},co={get(o){return ce.get(o)||ce.get(`_legacy_${o}`)},save(o,e,t){let n={};window.location.protocol==="https:"&&(n={secure:!0}),t?.daysUntilExpire&&(n.expires=t.daysUntilExpire),t?.cookieDomain&&(n.domain=t.cookieDomain),Et(`_legacy_${o}`,JSON.stringify(e),n),ce.save(o,e,t)},remove(o,e){let t={};e?.cookieDomain&&(t.domain=e.cookieDomain),Pt(o,t),ce.remove(o,e),ce.remove(`_legacy_${o}`,e)}},lo={get(o){if(typeof sessionStorage>"u")return;const e=sessionStorage.getItem(o);return e!=null?JSON.parse(e):void 0},save(o,e){sessionStorage.setItem(o,JSON.stringify(e))},remove(o){sessionStorage.removeItem(o)}};function uo(o,e,t){var n=e===void 0?null:e,i=function(h,m){var a=atob(h);if(m){for(var l=new Uint8Array(a.length),u=0,d=a.length;u<d;++u)l[u]=a.charCodeAt(u);return String.fromCharCode.apply(null,new Uint16Array(l.buffer))}return a}(o,t!==void 0&&t),r=i.indexOf(`
`,10)+1,s=i.substring(r)+(n?"//# sourceMappingURL="+n:""),c=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(c)}var dt,ht,mt,$e,ho=(dt="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Y2xhc3MgZSBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQscil7c3VwZXIociksdGhpcy5lcnJvcj10LHRoaXMuZXJyb3JfZGVzY3JpcHRpb249cixPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxlLnByb3RvdHlwZSl9c3RhdGljIGZyb21QYXlsb2FkKHtlcnJvcjp0LGVycm9yX2Rlc2NyaXB0aW9uOnJ9KXtyZXR1cm4gbmV3IGUodCxyKX19Y2xhc3MgdCBleHRlbmRzIGV7Y29uc3RydWN0b3IoZSxzKXtzdXBlcigibWlzc2luZ19yZWZyZXNoX3Rva2VuIixgTWlzc2luZyBSZWZyZXNoIFRva2VuIChhdWRpZW5jZTogJyR7cihlLFsiZGVmYXVsdCJdKX0nLCBzY29wZTogJyR7cihzKX0nKWApLHRoaXMuYXVkaWVuY2U9ZSx0aGlzLnNjb3BlPXMsT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdC5wcm90b3R5cGUpfX1mdW5jdGlvbiByKGUsdD1bXSl7cmV0dXJuIGUmJiF0LmluY2x1ZGVzKGUpP2U6IiJ9ImZ1bmN0aW9uIj09dHlwZW9mIFN1cHByZXNzZWRFcnJvciYmU3VwcHJlc3NlZEVycm9yO2NvbnN0IHM9ZT0+e3ZhcntjbGllbnRJZDp0fT1lLHI9ZnVuY3Rpb24oZSx0KXt2YXIgcj17fTtmb3IodmFyIHMgaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxzKSYmdC5pbmRleE9mKHMpPDAmJihyW3NdPWVbc10pO2lmKG51bGwhPWUmJiJmdW5jdGlvbiI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihzPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxzLmxlbmd0aDtvKyspdC5pbmRleE9mKHNbb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLHNbb10pJiYocltzW29dXT1lW3Nbb11dKX1yZXR1cm4gcn0oZSxbImNsaWVudElkIl0pO3JldHVybiBuZXcgVVJMU2VhcmNoUGFyYW1zKChlPT5PYmplY3Qua2V5cyhlKS5maWx0ZXIoKHQ9PnZvaWQgMCE9PWVbdF0pKS5yZWR1Y2UoKCh0LHIpPT5PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse1tyXTplW3JdfSkpLHt9KSkoT2JqZWN0LmFzc2lnbih7Y2xpZW50X2lkOnR9LHIpKSkudG9TdHJpbmcoKX07bGV0IG89e307Y29uc3Qgbj0oZSx0KT0+YCR7ZX18JHt0fWA7YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGFzeW5jKHtkYXRhOnt0aW1lb3V0OmUsYXV0aDpyLGZldGNoVXJsOmksZmV0Y2hPcHRpb25zOmMsdXNlRm9ybURhdGE6YX0scG9ydHM6W3BdfSk9PntsZXQgZjtjb25zdHthdWRpZW5jZTp1LHNjb3BlOmx9PXJ8fHt9O3RyeXtjb25zdCByPWE/KGU9Pntjb25zdCB0PW5ldyBVUkxTZWFyY2hQYXJhbXMoZSkscj17fTtyZXR1cm4gdC5mb3JFYWNoKCgoZSx0KT0+e3JbdF09ZX0pKSxyfSkoYy5ib2R5KTpKU09OLnBhcnNlKGMuYm9keSk7aWYoIXIucmVmcmVzaF90b2tlbiYmInJlZnJlc2hfdG9rZW4iPT09ci5ncmFudF90eXBlKXtjb25zdCBlPSgoZSx0KT0+b1tuKGUsdCldKSh1LGwpO2lmKCFlKXRocm93IG5ldyB0KHUsbCk7Yy5ib2R5PWE/cyhPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JlZnJlc2hfdG9rZW46ZX0pKTpKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JlZnJlc2hfdG9rZW46ZX0pKX1sZXQgaCxnOyJmdW5jdGlvbiI9PXR5cGVvZiBBYm9ydENvbnRyb2xsZXImJihoPW5ldyBBYm9ydENvbnRyb2xsZXIsYy5zaWduYWw9aC5zaWduYWwpO3RyeXtnPWF3YWl0IFByb21pc2UucmFjZShbKGQ9ZSxuZXcgUHJvbWlzZSgoZT0+c2V0VGltZW91dChlLGQpKSkpLGZldGNoKGksT2JqZWN0LmFzc2lnbih7fSxjKSldKX1jYXRjaChlKXtyZXR1cm4gdm9pZCBwLnBvc3RNZXNzYWdlKHtlcnJvcjplLm1lc3NhZ2V9KX1pZighZylyZXR1cm4gaCYmaC5hYm9ydCgpLHZvaWQgcC5wb3N0TWVzc2FnZSh7ZXJyb3I6IlRpbWVvdXQgd2hlbiBleGVjdXRpbmcgJ2ZldGNoJyJ9KTtmPWF3YWl0IGcuanNvbigpLGYucmVmcmVzaF90b2tlbj8oKChlLHQscik9PntvW24odCxyKV09ZX0pKGYucmVmcmVzaF90b2tlbix1LGwpLGRlbGV0ZSBmLnJlZnJlc2hfdG9rZW4pOigoZSx0KT0+e2RlbGV0ZSBvW24oZSx0KV19KSh1LGwpLHAucG9zdE1lc3NhZ2Uoe29rOmcub2ssanNvbjpmfSl9Y2F0Y2goZSl7cC5wb3N0TWVzc2FnZSh7b2s6ITEsanNvbjp7ZXJyb3I6ZS5lcnJvcixlcnJvcl9kZXNjcmlwdGlvbjplLm1lc3NhZ2V9fSl9dmFyIGR9KSl9KCk7Cgo=",ht=null,mt=!1,function(o){return $e=$e||uo(dt,ht,mt),new Worker($e,o)});const We={};class mo{constructor(e,t){this.cache=e,this.clientId=t,this.manifestKey=this.createManifestKeyFrom(this.clientId)}async add(e){var t;const n=new Set(((t=await this.cache.get(this.manifestKey))===null||t===void 0?void 0:t.keys)||[]);n.add(e),await this.cache.set(this.manifestKey,{keys:[...n]})}async remove(e){const t=await this.cache.get(this.manifestKey);if(t){const n=new Set(t.keys);return n.delete(e),n.size>0?await this.cache.set(this.manifestKey,{keys:[...n]}):await this.cache.remove(this.manifestKey)}}get(){return this.cache.get(this.manifestKey)}clear(){return this.cache.remove(this.manifestKey)}createManifestKeyFrom(e){return`@@auth0spajs@@::${e}`}}const po={memory:()=>new Ct().enclosedCache,localstorage:()=>new oo},pt=o=>po[o],ft=o=>{const{openUrl:e,onRedirect:t}=o,n=H(o,["openUrl","onRedirect"]);return Object.assign(Object.assign({},n),{openUrl:e===!1||e?e:t})},De=new Mt;class fo{constructor(e){let t,n;if(this.userCache=new Ct().enclosedCache,this.defaultOptions={authorizationParams:{scope:"openid profile email"},useRefreshTokensFallback:!1,useFormData:!0},this._releaseLockOnPageHide=async()=>{await De.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)},this.options=Object.assign(Object.assign(Object.assign({},this.defaultOptions),e),{authorizationParams:Object.assign(Object.assign({},this.defaultOptions.authorizationParams),e.authorizationParams)}),typeof window<"u"&&(()=>{if(!Te())throw new Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(Te().subtle===void 0)throw new Error(`
      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/main/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.
    `)})(),e.cache&&e.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),e.cache)n=e.cache;else{if(t=e.cacheLocation||"memory",!pt(t))throw new Error(`Invalid cache location "${t}"`);n=pt(t)()}this.httpTimeoutMs=e.httpTimeoutInSeconds?1e3*e.httpTimeoutInSeconds:1e4,this.cookieStorage=e.legacySameSiteCookie===!1?ce:co,this.orgHintCookieName=`auth0.${this.options.clientId}.organization_hint`,this.isAuthenticatedCookieName=(s=>`auth0.${s}.is.authenticated`)(this.options.clientId),this.sessionCheckExpiryDays=e.sessionCheckExpiryDays||1;const i=e.useCookiesForTransactions?this.cookieStorage:lo;var r;this.scope=be("openid",this.options.authorizationParams.scope,this.options.useRefreshTokens?"offline_access":""),this.transactionManager=new io(i,this.options.clientId,this.options.cookieDomain),this.nowProvider=this.options.nowProvider||Ot,this.cacheManager=new no(n,n.allKeys?void 0:new mo(n,this.options.clientId),this.nowProvider),this.domainUrl=(r=this.options.domain,/^https?:\/\//.test(r)?r:`https://${r}`),this.tokenIssuer=((s,c)=>s?s.startsWith("https://")?s:`https://${s}/`:`${c}/`)(this.options.issuer,this.domainUrl),typeof window<"u"&&window.Worker&&this.options.useRefreshTokens&&t==="memory"&&(this.options.workerUrl?this.worker=new Worker(this.options.workerUrl):this.worker=new ho)}_url(e){const t=encodeURIComponent(btoa(JSON.stringify(this.options.auth0Client||Tt)));return`${this.domainUrl}${e}&auth0Client=${t}`}_authorizeUrl(e){return this._url(`/authorize?${He(e)}`)}async _verifyIdToken(e,t,n){const i=await this.nowProvider();return so({iss:this.tokenIssuer,aud:this.options.clientId,id_token:e,nonce:t,organization:n,leeway:this.options.leeway,max_age:(r=this.options.authorizationParams.max_age,typeof r!="string"?r:parseInt(r,10)||void 0),now:i});var r}_processOrgHint(e){e?this.cookieStorage.save(this.orgHintCookieName,e,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}):this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain})}async _prepareAuthorizeUrl(e,t,n){const i=lt(Ne()),r=lt(Ne()),s=Ne(),c=(a=>{const l=new Uint8Array(a);return(u=>{const d={"+":"-","/":"_","=":""};return u.replace(/[+/=]/g,p=>d[p])})(window.btoa(String.fromCharCode(...Array.from(l))))})(await(async a=>await Te().subtle.digest({name:"SHA-256"},new TextEncoder().encode(a)))(s)),h=((a,l,u,d,p,w,k,y)=>Object.assign(Object.assign(Object.assign({client_id:a.clientId},a.authorizationParams),u),{scope:be(l,u.scope),response_type:"code",response_mode:y||"query",state:d,nonce:p,redirect_uri:k||a.authorizationParams.redirect_uri,code_challenge:w,code_challenge_method:"S256"}))(this.options,this.scope,e,i,r,c,e.redirect_uri||this.options.authorizationParams.redirect_uri||n,t?.response_mode),m=this._authorizeUrl(h);return{nonce:r,code_verifier:s,scope:h.scope,audience:h.audience||"default",redirect_uri:h.redirect_uri,state:i,url:m}}async loginWithPopup(e,t){var n;if(e=e||{},!(t=t||{}).popup&&(t.popup=(c=>{const h=window.screenX+(window.innerWidth-400)/2,m=window.screenY+(window.innerHeight-600)/2;return window.open(c,"auth0:authorize:popup",`left=${h},top=${m},width=400,height=600,resizable,scrollbars=yes,status=1`)})(""),!t.popup))throw new Error("Unable to open a popup for loginWithPopup - window.open returned `null`");const i=await this._prepareAuthorizeUrl(e.authorizationParams||{},{response_mode:"web_message"},window.location.origin);t.popup.location.href=i.url;const r=await(c=>new Promise((h,m)=>{let a;const l=setInterval(()=>{c.popup&&c.popup.closed&&(clearInterval(l),clearTimeout(u),window.removeEventListener("message",a,!1),m(new ot(c.popup)))},1e3),u=setTimeout(()=>{clearInterval(l),m(new tt(c.popup)),window.removeEventListener("message",a,!1)},1e3*(c.timeoutInSeconds||60));a=function(d){if(d.data&&d.data.type==="authorization_response"){if(clearTimeout(u),clearInterval(l),window.removeEventListener("message",a,!1),c.popup.close(),d.data.response.error)return m(R.fromPayload(d.data.response));h(d.data.response)}},window.addEventListener("message",a)}))(Object.assign(Object.assign({},t),{timeoutInSeconds:t.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60}));if(i.state!==r.state)throw new R("state_mismatch","Invalid state");const s=((n=e.authorizationParams)===null||n===void 0?void 0:n.organization)||this.options.authorizationParams.organization;await this._requestToken({audience:i.audience,scope:i.scope,code_verifier:i.code_verifier,grant_type:"authorization_code",code:r.code,redirect_uri:i.redirect_uri},{nonceIn:i.nonce,organization:s})}async getUser(){var e;const t=await this._getIdTokenFromCache();return(e=t?.decodedToken)===null||e===void 0?void 0:e.user}async getIdTokenClaims(){var e;const t=await this._getIdTokenFromCache();return(e=t?.decodedToken)===null||e===void 0?void 0:e.claims}async loginWithRedirect(e={}){var t;const n=ft(e),{openUrl:i,fragment:r,appState:s}=n,c=H(n,["openUrl","fragment","appState"]),h=((t=c.authorizationParams)===null||t===void 0?void 0:t.organization)||this.options.authorizationParams.organization,m=await this._prepareAuthorizeUrl(c.authorizationParams||{}),{url:a}=m,l=H(m,["url"]);this.transactionManager.create(Object.assign(Object.assign(Object.assign({},l),{appState:s}),h&&{organization:h}));const u=r?`${a}#${r}`:a;i?await i(u):window.location.assign(u)}async handleRedirectCallback(e=window.location.href){const t=e.split("?").slice(1);if(t.length===0)throw new Error("There are no query params available for parsing.");const{state:n,code:i,error:r,error_description:s}=(l=>{l.indexOf("#")>-1&&(l=l.substring(0,l.indexOf("#")));const u=new URLSearchParams(l);return{state:u.get("state"),code:u.get("code")||void 0,error:u.get("error")||void 0,error_description:u.get("error_description")||void 0}})(t.join("")),c=this.transactionManager.get();if(!c)throw new R("missing_transaction","Invalid state");if(this.transactionManager.remove(),r)throw new et(r,s||r,n,c.appState);if(!c.code_verifier||c.state&&c.state!==n)throw new R("state_mismatch","Invalid state");const h=c.organization,m=c.nonce,a=c.redirect_uri;return await this._requestToken(Object.assign({audience:c.audience,scope:c.scope,code_verifier:c.code_verifier,grant_type:"authorization_code",code:i},a?{redirect_uri:a}:{}),{nonceIn:m,organization:h}),{appState:c.appState}}async checkSession(e){if(!this.cookieStorage.get(this.isAuthenticatedCookieName)){if(!this.cookieStorage.get("auth0.is.authenticated"))return;this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove("auth0.is.authenticated")}try{await this.getTokenSilently(e)}catch{}}async getTokenSilently(e={}){var t;const n=Object.assign(Object.assign({cacheMode:"on"},e),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),e.authorizationParams),{scope:be(this.scope,(t=e.authorizationParams)===null||t===void 0?void 0:t.scope)})}),i=await((r,s)=>{let c=We[s];return c||(c=r().finally(()=>{delete We[s],c=null}),We[s]=c),c})(()=>this._getTokenSilently(n),`${this.options.clientId}::${n.authorizationParams.audience}::${n.authorizationParams.scope}`);return e.detailedResponse?i:i?.access_token}async _getTokenSilently(e){const{cacheMode:t}=e,n=H(e,["cacheMode"]);if(t!=="off"){const i=await this._getEntryFromCache({scope:n.authorizationParams.scope,audience:n.authorizationParams.audience||"default",clientId:this.options.clientId});if(i)return i}if(t!=="cache-only"){if(!await(async(i,r=3)=>{for(let s=0;s<r;s++)if(await i())return!0;return!1})(()=>De.acquireLock("auth0.lock.getTokenSilently",5e3),10))throw new _e;try{if(window.addEventListener("pagehide",this._releaseLockOnPageHide),t!=="off"){const m=await this._getEntryFromCache({scope:n.authorizationParams.scope,audience:n.authorizationParams.audience||"default",clientId:this.options.clientId});if(m)return m}const i=this.options.useRefreshTokens?await this._getTokenUsingRefreshToken(n):await this._getTokenFromIFrame(n),{id_token:r,access_token:s,oauthTokenScope:c,expires_in:h}=i;return Object.assign(Object.assign({id_token:r,access_token:s},c?{scope:c}:null),{expires_in:h})}finally{await De.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)}}}async getTokenWithPopup(e={},t={}){var n;const i=Object.assign(Object.assign({},e),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),e.authorizationParams),{scope:be(this.scope,(n=e.authorizationParams)===null||n===void 0?void 0:n.scope)})});return t=Object.assign(Object.assign({},Yt),t),await this.loginWithPopup(i,t),(await this.cacheManager.get(new J({scope:i.authorizationParams.scope,audience:i.authorizationParams.audience||"default",clientId:this.options.clientId}))).access_token}async isAuthenticated(){return!!await this.getUser()}_buildLogoutUrl(e){e.clientId!==null?e.clientId=e.clientId||this.options.clientId:delete e.clientId;const t=e.logoutParams||{},{federated:n}=t,i=H(t,["federated"]),r=n?"&federated":"";return this._url(`/v2/logout?${He(Object.assign({clientId:e.clientId},i))}`)+r}async logout(e={}){const t=ft(e),{openUrl:n}=t,i=H(t,["openUrl"]);e.clientId===null?await this.cacheManager.clear():await this.cacheManager.clear(e.clientId||this.options.clientId),this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove(this.isAuthenticatedCookieName,{cookieDomain:this.options.cookieDomain}),this.userCache.remove("@@user@@");const r=this._buildLogoutUrl(i);n?await n(r):n!==!1&&window.location.assign(r)}async _getTokenFromIFrame(e){const t=Object.assign(Object.assign({},e.authorizationParams),{prompt:"none"}),n=this.cookieStorage.get(this.orgHintCookieName);n&&!t.organization&&(t.organization=n);const{url:i,state:r,nonce:s,code_verifier:c,redirect_uri:h,scope:m,audience:a}=await this._prepareAuthorizeUrl(t,{response_mode:"web_message"},window.location.origin);try{if(window.crossOriginIsolated)throw new R("login_required","The application is running in a Cross-Origin Isolated context, silently retrieving a token without refresh token is not possible.");const l=e.timeoutInSeconds||this.options.authorizeTimeoutInSeconds,u=await((p,w,k=60)=>new Promise((y,I)=>{const _=window.document.createElement("iframe");_.setAttribute("width","0"),_.setAttribute("height","0"),_.style.display="none";const f=()=>{window.document.body.contains(_)&&(window.document.body.removeChild(_),window.removeEventListener("message",C,!1))};let C;const V=setTimeout(()=>{I(new _e),f()},1e3*k);C=function(E){if(E.origin!=w||!E.data||E.data.type!=="authorization_response")return;const $=E.source;$&&$.close(),E.data.response.error?I(R.fromPayload(E.data.response)):y(E.data.response),clearTimeout(V),window.removeEventListener("message",C,!1),setTimeout(f,2e3)},window.addEventListener("message",C,!1),window.document.body.appendChild(_),_.setAttribute("src",p)}))(i,this.domainUrl,l);if(r!==u.state)throw new R("state_mismatch","Invalid state");const d=await this._requestToken(Object.assign(Object.assign({},e.authorizationParams),{code_verifier:c,code:u.code,grant_type:"authorization_code",redirect_uri:h,timeout:e.authorizationParams.timeout||this.httpTimeoutMs}),{nonceIn:s,organization:t.organization});return Object.assign(Object.assign({},d),{scope:m,oauthTokenScope:d.scope,audience:a})}catch(l){throw l.error==="login_required"&&this.logout({openUrl:!1}),l}}async _getTokenUsingRefreshToken(e){const t=await this.cacheManager.get(new J({scope:e.authorizationParams.scope,audience:e.authorizationParams.audience||"default",clientId:this.options.clientId}));if(!(t&&t.refresh_token||this.worker)){if(this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(e);throw new Le(e.authorizationParams.audience||"default",e.authorizationParams.scope)}const n=e.authorizationParams.redirect_uri||this.options.authorizationParams.redirect_uri||window.location.origin,i=typeof e.timeoutInSeconds=="number"?1e3*e.timeoutInSeconds:null;try{const r=await this._requestToken(Object.assign(Object.assign(Object.assign({},e.authorizationParams),{grant_type:"refresh_token",refresh_token:t&&t.refresh_token,redirect_uri:n}),i&&{timeout:i}));return Object.assign(Object.assign({},r),{scope:e.authorizationParams.scope,oauthTokenScope:r.scope,audience:e.authorizationParams.audience||"default"})}catch(r){if((r.message.indexOf("Missing Refresh Token")>-1||r.message&&r.message.indexOf("invalid refresh token")>-1)&&this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(e);throw r}}async _saveEntryInCache(e){const{id_token:t,decodedToken:n}=e,i=H(e,["id_token","decodedToken"]);this.userCache.set("@@user@@",{id_token:t,decodedToken:n}),await this.cacheManager.setIdToken(this.options.clientId,e.id_token,e.decodedToken),await this.cacheManager.set(i)}async _getIdTokenFromCache(){const e=this.options.authorizationParams.audience||"default",t=await this.cacheManager.getIdToken(new J({clientId:this.options.clientId,audience:e,scope:this.scope})),n=this.userCache.get("@@user@@");return t&&t.id_token===n?.id_token?n:(this.userCache.set("@@user@@",t),t)}async _getEntryFromCache({scope:e,audience:t,clientId:n}){const i=await this.cacheManager.get(new J({scope:e,audience:t,clientId:n}),60);if(i&&i.access_token){const{access_token:r,oauthTokenScope:s,expires_in:c}=i,h=await this._getIdTokenFromCache();return h&&Object.assign(Object.assign({id_token:h.id_token,access_token:r},s?{scope:s}:null),{expires_in:c})}}async _requestToken(e,t){const{nonceIn:n,organization:i}=t||{},r=await to(Object.assign({baseUrl:this.domainUrl,client_id:this.options.clientId,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},e),this.worker),s=await this._verifyIdToken(r.id_token,n,i);return await this._saveEntryInCache(Object.assign(Object.assign(Object.assign(Object.assign({},r),{decodedToken:s,scope:e.scope,audience:e.audience||"default"}),r.scope?{oauthTokenScope:r.scope}:null),{client_id:this.options.clientId})),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this._processOrgHint(i||s.claims.org_id),Object.assign(Object.assign({},r),{decodedToken:s})}}async function go(o){const e=new fo(o);return await e.checkSession(),e}const D="/",x="/rw",ue="/authenticated",F="/login",G="/logout",Rt="google-oauth2";let te,Oe;function jt(){return!Me(fe)}function wo(o){return te=o,te.isAuthenticated()}function ko(o){Oe=o}function yo(){if(Oe)return Oe;if(!(!te||!navigator.onLine))return te.getTokenSilently().catch(()=>{Lt()})}function it(o){window.history.replaceState({},document.title,o)}function _o(o){return te.handleRedirectCallback().then(({appState:e})=>{e===F&&(e=D),e===x&&(e=D,localStorage.setItem(x,1)),it(e),o()}).catch(()=>{Ut()})}function vo(){return fe.authorizationParams=Pe({redirect_uri:location.origin+ue,audience:"care-ops-backend"},fe.authorizationParams),localStorage.getItem(x)&&(fe.authorizationParams.connection=Rt),fe}function Lt(){window.location=G}function Je(o){te.loginWithRedirect(Pe({prompt:"login"},o))}function Ut(o=D){if(top!==self){top.location=F;return}if(Re.disableLoginPrompt)return Je({appState:o});it(F);const e=new qe;e.on("click:login",()=>{Je({appState:o})}),e.render()}function bo(o){go(vo()).then(wo).then(e=>{if(location.pathname===G){Oe=null;const t=St.request("settings","get","federated_logout");te.logout({logoutParams:{returnTo:location.origin,federated:t}});return}if(location.pathname===x){Je({appState:x,authorizationParams:{connection:Rt}});return}if(location.pathname===ue){_o(o);return}if(!e){Ut(location.pathname);return}location.pathname===F&&it(D),o()})}const Io=Object.freeze(Object.defineProperty({__proto__:null,auth:bo,getToken:yo,logout:Lt,setToken:ko,should:jt},Symbol.toStringTag,{value:"Module"}));let rt;function At(){return Re.cypress||!navigator.onLine}function So(o){rt=o}function To(){return rt}function Oo(){window.location=G}function Co(o){if(location.pathname===G){rt=null,window.location=D;return}return o()}const Eo=Object.freeze(Object.defineProperty({__proto__:null,auth:Co,getToken:To,logout:Oo,setToken:So,should:At},Symbol.toStringTag,{value:"Module"})),gt="4.2.0",ge="pkce-code-verifier";var ye;(function(o){o.s="string",o.i="integer",o.b="boolean"})(ye||(ye={}));var O;(function(o){o.token_bundle="kinde_token",o.access_token="kinde_access_token",o.id_token="kinde_id_token",o.user="user",o.refresh_token="kinde_refresh_token"})(O||(O={}));class we extends Error{}we.prototype.name="InvalidTokenError";function Po(o){return decodeURIComponent(atob(o).replace(/(.)/g,(e,t)=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function Ro(o){let e=o.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Po(e)}catch{return atob(e)}}function Ie(o,e){if(typeof o!="string")throw new we("Invalid token specified: must be a string");e||(e={});const t=e.header===!0?0:1,n=o.split(".")[t];if(typeof n!="string")throw new we(`Invalid token specified: missing part #${t+1}`);let i;try{i=Ro(n)}catch(r){throw new we(`Invalid token specified: invalid base64 for part #${t+1} (${r.message})`)}try{return JSON.parse(i)}catch(r){throw new we(`Invalid token specified: invalid json for part #${t+1} (${r.message})`)}}const jo=o=>document.cookie.split("; ").find(e=>e.split("=")[0]===o)?.split("=")[1];function Lo(o){const e=Array.from(new Uint8Array(o));return btoa(String.fromCharCode.apply(null,e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function Uo(o){const t=new TextEncoder().encode(o);return window.crypto.subtle.digest("SHA-256",t)}async function Ao(o){const e=await Uo(o);return Lo(e)}function wt(){const o=new Uint32Array(28);return window.crypto.getRandomValues(o),Array.from(o,e=>("0"+e.toString(16)).substr(-2)).join("")}const xo=60,Fe=o=>{const e=Math.floor(Date.now()/1e3);return o.exp+xo>e},zo=async(o,e)=>{const t=wt(),n=wt(),i=await Ao(n);sessionStorage.setItem(`${ge}-${t}`,JSON.stringify({codeVerifier:n,appState:e}));const r=new URL(o);return{state:t,code_challenge:i,url:r}},No=()=>{let o={};return{reset:()=>{o={}},getItem:r=>o[r],removeItem:r=>{delete o[r]},setItem:(r,s)=>{o[r]=s}}},A=No(),xt=(o,e="access_token")=>{const t=A.getItem(`kinde_${e}`);return t?{name:o,value:t[o]}:null},B=(o,e="access_token")=>{const t=xt(o,e);return t&&t.value},Ue=(o,e,t)=>{const n=B("feature_flags"),i=n&&n[o]?n[o]:{};if(i.v==null&&e==null)throw Error(`Flag ${o} was not found, and no default value has been provided`);if(t&&i.t&&t!==i.t)throw Error(`Flag ${o} is of type ${ye[i.t]} - requested type ${ye[t]}`);return{code:o,type:ye[i.t||t],value:i.v==null?e:i.v,is_default:i.v==null}},$o=(o,e)=>{try{return Ue(o,e,"b").value}catch(t){return console.error(t),t}},Wo=(o,e)=>{try{return Ue(o,e,"i").value}catch(t){return console.error(t),t}},Do=(o,e)=>{try{return Ue(o,e,"s").value}catch(t){return console.error(t),t}},Ko=()=>({orgCodes:B("org_codes","id_token")??[]}),Zo=["iss","azp"],kt=(o,e)=>{if(!o)throw new Error("ID token is required");if(Zo.forEach(n=>{if(!o.payload[n])throw new Error(`(${n}) claim is required.`);if(o.payload[n]!==e[n])throw new Error(`${n} claim mismatch. Expected: "${e[n]}", Received: "${o.payload[n]}"`)}),o.header.alg!=="RS256")throw new Error(`Unsupported signature alg. Expected: "RS256", Received: "${o.header.alg}"`);if(e.aud){if(!Array.isArray(o.payload.aud))throw new Error("(aud) claim must be an array");if(!o.payload.aud.every(n=>e.aud.includes(n)))throw new Error(`(aud) claim mismatch. Expected: "${e.aud}", Received: "${o.payload.aud.join(", ")}"`)}if(!Fe(o.payload))throw new Error("Token expired");return!0},Ho=o=>new URL(o).hostname.split(".").slice(-2).join(".")!=="kinde.com",Jo=async o=>{if(!o)throw Error("Please provide your Kinde credentials");if(o!==Object(o))throw Error("The Kinde SDK must be initiated with an object");const{audience:e,client_id:t,domain:n,is_dangerously_use_local_storage:i=!1,redirect_uri:r,logout_uri:s=r,on_redirect_callback:c,on_error_callback:h,scope:m="openid profile email offline",proxy_redirect_uri:a,_framework:l,_frameworkVersion:u}=o;if(e&&typeof e!="string")throw Error("Please supply a valid audience for your api");if(m&&typeof m!="string")throw Error("Please supply a valid scope");if(!r||typeof o.redirect_uri!="string")throw Error("Please supply a valid redirect_uri for your users to be redirected after successful authentication");if(!n||typeof n!="string")throw Error("Please supply a valid Kinde domain so we can connect to your account");if(typeof i!="boolean")throw TypeError("Please supply a boolean value for is_dangerously_use_local_storage");const d=t||"spa@live",p=location.hostname==="localhost"||location.hostname==="127.0.0.1",w=!p&&!i&&Ho(n),k=p||i,y={audience:e,client_id:d,redirect_uri:r,authorization_endpoint:`${n}/oauth2/auth`,token_endpoint:`${n}/oauth2/token`,requested_scopes:m,domain:n,_framework:l,_frameworkVersion:u},I=g=>{if(!g||g.error)return;const b=Ie(g.id_token),T=Ie(g.id_token,{header:!0}),S=Ie(g.access_token),U=Ie(g.access_token,{header:!0}),X={iss:n,azp:t,aud:e};kt({payload:b,header:T},{...X,aud:t}),kt({payload:S,header:U},X),A.setItem(O.token_bundle,g),A.setItem(O.access_token,S),A.setItem(O.id_token,b),b.sub&&A.setItem(O.user,{id:b.sub,given_name:b.given_name,family_name:b.family_name,email:b.email,picture:b.picture}),k?localStorage.setItem(O.refresh_token,g.refresh_token):A.setItem(O.refresh_token,g.refresh_token)},_=async({tokenType:g}={tokenType:O.access_token})=>{const b=k?localStorage.getItem(O.refresh_token):A.getItem(O.refresh_token);if(b||w&&jo("_kbrte"))try{const U=await(await fetch(y.token_endpoint,{method:"POST",...w&&{credentials:"include"},headers:new Headers({"Content-type":"application/x-www-form-urlencoded; charset=UTF-8","Kinde-SDK":`
            ${y._framework||"JavaScript"}/${y._frameworkVersion||gt}`}),body:new URLSearchParams({client_id:y.client_id,grant_type:"refresh_token",...!w&&b&&{refresh_token:b}})})).json();return I(U),g===O.id_token?U.id_token:U.access_token}catch(S){console.error(S)}},f=async(g,b)=>{const T=A.getItem(O.token_bundle);if(!T||b.isForceRefresh)return await _({tokenType:g});const S=A.getItem(g);return Fe(S)?g===O.access_token?T.access_token:T.id_token:await _({tokenType:g})},C=async(g={})=>await f(O.access_token,g),V=async(g={})=>await f(O.id_token,g),E=async()=>{const g=A.getItem(O.access_token);return g?(Fe(g)||await _(),!0):!1},$=()=>{const g=B("org_code");return{permissions:B("permissions")??[],orgCode:g}},de=g=>{const b=B("org_code");return{isGranted:(B("permissions")??[]).some(S=>S===g),orgCode:b}},ve=()=>({orgCode:B("org_code")}),oe=()=>{const g=new URL(window.location.toString());g.search="",window.history.pushState({},"",g)},xe=async g=>{const b=g.get("code"),T=g.get("state"),S=g.get("error"),U=sessionStorage.getItem(`${ge}-${T}`);if(!U)console.error("Invalid state");else{if(S){const re=g.get("error"),he=g.get("error_description");oe(),sessionStorage.removeItem(`${ge}-${T}`);const{appState:M}=JSON.parse(U);return h?h({error:re,errorDescription:he,state:T,appState:M}):window.location.href=M.kindeOriginUrl,!1}const{appState:X,codeVerifier:ie}=JSON.parse(U);try{const he=await(await fetch(y.token_endpoint,{method:"POST",...w&&{credentials:"include"},headers:new Headers({"Content-type":"application/x-www-form-urlencoded; charset=UTF-8","Kinde-SDK":`${y._framework||"JavaScript"}/${y._frameworkVersion||gt}`}),body:new URLSearchParams({client_id:y.client_id,code:b,code_verifier:ie,grant_type:"authorization_code",redirect_uri:y.redirect_uri})})).json();I(he),oe(),sessionStorage.removeItem(`${ge}-${T}`);const M=K();c&&c(M,X)}catch(re){console.error(re),sessionStorage.removeItem(`${ge}-${T}`)}}},v=async g=>{const{app_state:b={},prompt:T,is_create_org:S,org_name:U="",org_code:X,authUrlParams:ie={}}=g;b.kindeOriginUrl||(b.kindeOriginUrl=window.location.href);const{state:re,code_challenge:he,url:M}=await zo(y.authorization_endpoint,b),me={redirect_uri:r,client_id:d,response_type:"code",scope:y.requested_scopes,code_challenge:he,code_challenge_method:"S256",state:re};T&&(me.prompt=T),X&&(me.org_code=X),S&&(me.is_create_org=String(S),me.org_name=U);const at=new URLSearchParams(Object.assign(ie,me));e&&e.trim().split(/\s+/).forEach(Gt=>{at.append("audience",Gt)}),M.search=String(at),window.location.href=M.toString()},P=async g=>{await v({...g,prompt:"create"})},W=async g=>{await v({...g})},z=async g=>{await v({...g,prompt:"create",is_create_org:!0})},K=()=>A.getItem(O.user),ne=async()=>{const b={Accept:"application/json",Authorization:`Bearer ${await C()}`};try{const S=await(await fetch(`${y.domain}/oauth2/v2/user_profile`,{method:"GET",headers:b})).json();return A.setItem(O.user,{id:S.sub,given_name:S.given_name,family_name:S.family_name,email:S.email,picture:S.picture}),A.getItem(O.user)}catch(T){console.error(T)}},Z=async()=>{const g=new URL(`${y.domain}/logout`);try{A.reset(),k&&localStorage.removeItem(O.refresh_token);const b=new URLSearchParams({redirect:s});g.search=String(b),window.location.href=g.toString()}catch(b){console.error(b)}},ze=async()=>{const g=new URLSearchParams(window.location.search);Vt(g)?await xe(g):(w||k)&&await _()},Vt=g=>{const b=g.has("code"),T=g.has("error");if(!b&&!T)return!1;const{protocol:S,host:U,pathname:X}=window.location,ie=a||`${S}//${U}${X}`;return ie===r||ie===`${r}/`};return await ze(),{getToken:C,getIdToken:V,getUser:K,getUserProfile:ne,login:W,logout:Z,register:P,isAuthenticated:E,createOrg:z,getClaim:xt,getFlag:Ue,getBooleanFlag:$o,getStringFlag:Do,getIntegerFlag:Wo,getPermissions:$,getPermission:de,getOrganization:ve,getUserOrganizations:Ko}};let le,Ce;function zt(){return!Me(je)}function Fo(o){Ce=o}function Xo(){if(Ce)return Ce;if(!(!le||!navigator.onLine))return le.getToken().catch(()=>{$t()})}function Nt(o){window.history.replaceState({},document.title,o)}function yt(o,e){le.register({app_state:{path:o},authUrlParams:{connection_id:e}})}async function Vo(o){const e={redirect_uri:location.origin+ue,logout_uri:location.origin,on_redirect_callback:(t,{path:n}={})=>{if(!t){Xe(n);return}n===F&&(n=D),n===x&&(n=D,localStorage.setItem(x,1)),Nt(n),o()}};return Jo(Pe(e,je.createParams))}function $t(){window.location=G}function Xe(o=D,e=je.connections.default){if(top!==self){top.location=F;return}if(Nt(F),Re.disableLoginPrompt){yt(o,e);return}const t=new qe;t.on("click:login",()=>{yt(o,e)}),t.render()}async function Go(o){const e=location.pathname;if(le=await Vo(o),e!==ue){if(e===G){Ce=null,le.logout();return}if(e===x||localStorage.getItem(x)){Xe(x,je.connections.roundingwell);return}if(!await le.getUser()){Xe(e);return}o()}}const Mo=Object.freeze(Object.defineProperty({__proto__:null,auth:Go,getToken:Xo,logout:$t,setToken:Fo,should:zt},Symbol.toStringTag,{value:"Module"}));var Yo=class extends Error{constructor(){super(...arguments),this.status=500,this.name="NoClientIdProvidedException",this.message='Missing Client ID. Pass it to the constructor (createClient("client_01HXRMBQ9BJ3E7QSTQ9X2PHVB7"))'}},qo=o=>({object:o.object,id:o.id,email:o.email,emailVerified:o.email_verified,firstName:o.first_name,profilePictureUrl:o.profile_picture_url,lastName:o.last_name,createdAt:o.created_at,updatedAt:o.updated_at}),Wt=o=>{const{user:e,organization_id:t,access_token:n,refresh_token:i,impersonator:r,...s}=o;return{user:qo(e),organizationId:t,accessToken:n,refreshToken:i,impersonator:r,...s}};async function Bo(o){const{baseUrl:e,clientId:t,code:n,codeVerifier:i,useCookie:r}=o,s=await fetch(`${e}/user_management/authenticate`,{method:"POST",...r&&{credentials:"include"},headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({code:n,client_id:t,grant_type:"authorization_code",code_verifier:i})});if(s.ok){const c=await s.json();return Wt(c)}else console.log("error",await s.json())}var Dt=class extends Error{},Ve=class extends Dt{},_t=class extends Dt{constructor(){super(...arguments),this.message="No access token available"}};async function Qo({baseUrl:o,clientId:e,refreshToken:t,organizationId:n,useCookie:i}){const r=await fetch(`${o}/user_management/authenticate`,{method:"POST",...i&&{credentials:"include"},headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({client_id:e,grant_type:"refresh_token",...!i&&{refresh_token:t},organization_id:n})});if(r.ok){const s=await r.json();return Wt(s)}else{const s=await r.json();throw new Ve(s.error_description)}}function en(o){const e=new URLSearchParams,t=Object.keys(o).sort();for(const n of t){const i=o[n];i&&e.append(n,i)}return e.toString()}function tn(o,{clientId:e,connectionId:t,context:n,domainHint:i,loginHint:r,organizationId:s,provider:c="authkit",redirectUri:h,state:m,screenHint:a,passwordResetToken:l,invitationToken:u,codeChallenge:d,codeChallengeMethod:p}){if(!c&&!t&&!s)throw new TypeError("Incomplete arguments. Need to specify either a 'connectionId', 'organizationId', or 'provider'.");if(c!=="authkit"&&a)throw new TypeError("'screenHint' is only supported for 'authkit' provider");const w=en({connection_id:t,context:n,organization_id:s,domain_hint:i,login_hint:r,provider:c,client_id:e,redirect_uri:h,response_type:"code",state:m,screen_hint:a,invitation_token:u,password_reset_token:l,code_challenge:d,code_challenge_method:p});return`${o}/user_management/authorize?${w}`}function on(){let o={};function e(r,s){o[r]=s}function t(r){return o[r]}function n(r){delete o[r]}function i(){o={}}return{setItem:e,getItem:t,removeItem:n,reset:i}}var N=on(),j={codeVerifier:"workos:code-verifier",user:"workos:user",accessToken:"workos:access-token",refreshToken:"workos:refresh-token",expiresAt:"workos:expires-at"};function st(o){return JSON.parse(atob(o.split(".")[1]))}function vt(o,{devMode:e=!1}={}){const{user:t,accessToken:n,refreshToken:i}=o;N.setItem(j.user,t),N.setItem(j.accessToken,n),(e?window.localStorage:N).setItem(j.refreshToken,i);const{exp:r,iat:s}=st(n),c=r-s,h=Date.now()+c*1e3;N.setItem(j.expiresAt,h)}function bt({devMode:o=!1}={}){N.removeItem(j.user),N.removeItem(j.accessToken),(o?window.localStorage:N).removeItem(j.refreshToken)}function nn({devMode:o=!1}={}){return(o?window.localStorage:N).getItem(j.refreshToken)}function rn(o){const e=N.getItem(j.accessToken);if(typeof e!="string")return null;const{sid:t}=st(e);return`${o}/user_management/sessions/logout?session_id=${t}`}function sn(o,e){if(!e.has("code"))return!1;const{protocol:n,host:i,pathname:r}=window.location,s=`${n}//${i}${r}`;return s===o||s===`${o}/`}async function an(){const o=cn(),e=await ln(o);return{codeVerifier:o,codeChallenge:e}}function cn(){const o=crypto.getRandomValues(new Uint32Array(96));return Kt(o)}async function ln(o){const e=await un(o);return Kt(e)}function Kt(o){return btoa(Array.from(new Uint8Array(o),e=>String.fromCharCode(e)).join("")).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function un(o){const t=new TextEncoder().encode(o);return window.crypto.subtle.digest("SHA-256",t)}var dn=class ke{constructor(){this.locked=new Map,this.addToLocked=(e,t)=>{let n=this.locked.get(e);n===void 0?t===void 0?this.locked.set(e,[]):this.locked.set(e,[t]):t!==void 0&&(n.unshift(t),this.locked.set(e,n))},this.isLocked=e=>this.locked.has(e),this.lock=e=>new Promise((t,n)=>{this.isLocked(e)?this.addToLocked(e,t):(this.addToLocked(e),t())}),this.unlock=e=>{let t=this.locked.get(e);if(t===void 0||t.length===0){this.locked.delete(e);return}let n=t.pop();this.locked.set(e,t),n!==void 0&&setTimeout(n,0)}}static getInstance(){return ke.instance===void 0&&(ke.instance=new ke),ke.instance}};function se(){return dn.getInstance()}var Ke="browser-tabs-lock-key",Se={key:async o=>{throw new Error("Unsupported")},getItem:async o=>{throw new Error("Unsupported")},clear:async()=>window.localStorage.clear(),removeItem:async o=>{throw new Error("Unsupported")},setItem:async(o,e)=>{throw new Error("Unsupported")},keySync:o=>window.localStorage.key(o),getItemSync:o=>window.localStorage.getItem(o),clearSync:()=>window.localStorage.clear(),removeItemSync:o=>window.localStorage.removeItem(o),setItemSync:(o,e)=>window.localStorage.setItem(o,e)};function Ze(o){return new Promise(e=>setTimeout(e,o))}function Ge(o){const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";let t="";for(let n=0;n<o;n++){const i=Math.floor(Math.random()*e.length);t+=e[i]}return t}function hn(){return Date.now().toString()+Ge(15)}var Zt=class L{constructor(e){this.acquiredIatSet=new Set,this.storageHandler=void 0,this.id=hn(),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),this.storageHandler=e,L.waiters===void 0&&(L.waiters=[])}async acquireLock(e,t=5e3){let n=Date.now()+Ge(4);const i=Date.now()+t,r=`${Ke}-${e}`,s=this.storageHandler===void 0?Se:this.storageHandler;for(;Date.now()<i;){if(await Ze(30),s.getItemSync(r)===null){const h=`${this.id}-${e}-${n}`;await Ze(Math.floor(Math.random()*25)),s.setItemSync(r,JSON.stringify({id:this.id,iat:n,timeoutKey:h,timeAcquired:Date.now(),timeRefreshed:Date.now()})),await Ze(30);let m=s.getItemSync(r);if(m!==null){let a=JSON.parse(m);if(a.id===this.id&&a.iat===n)return this.acquiredIatSet.add(n),this.refreshLockWhileAcquired(r,n),!0}}else L.lockCorrector(this.storageHandler===void 0?Se:this.storageHandler),await this.waitForSomethingToChange(i);n=Date.now()+Ge(4)}return!1}async refreshLockWhileAcquired(e,t){setTimeout(async()=>{if(await se().lock(t),!this.acquiredIatSet.has(t)){se().unlock(t);return}const n=this.storageHandler===void 0?Se:this.storageHandler;let i=n.getItemSync(e);if(i!==null){let r=JSON.parse(i);r.timeRefreshed=Date.now(),n.setItemSync(e,JSON.stringify(r)),se().unlock(t)}else{se().unlock(t);return}this.refreshLockWhileAcquired(e,t)},1e3)}async waitForSomethingToChange(e){await new Promise(t=>{let n=!1,i=Date.now();const r=50;let s=!1;function c(){if(s||(window.removeEventListener("storage",c),L.removeFromWaiting(c),clearTimeout(h),s=!0),!n){n=!0;let m=r-(Date.now()-i);m>0?setTimeout(t,m):t(null)}}window.addEventListener("storage",c),L.addToWaiting(c);let h=setTimeout(c,Math.max(0,e-Date.now()))})}static addToWaiting(e){this.removeFromWaiting(e),L.waiters!==void 0&&L.waiters.push(e)}static removeFromWaiting(e){L.waiters!==void 0&&(L.waiters=L.waiters.filter(t=>t!==e))}static notifyWaiters(){if(L.waiters===void 0)return;[...L.waiters].forEach(t=>t())}async releaseLock(e){return await this.releaseLock__private__(e)}async releaseLock__private__(e){const t=this.storageHandler===void 0?Se:this.storageHandler,n=`${Ke}-${e}`;let i=t.getItemSync(n);if(i===null)return;let r=JSON.parse(i);r.id===this.id&&(await se().lock(r.iat),this.acquiredIatSet.delete(r.iat),t.removeItemSync(n),se().unlock(r.iat),L.notifyWaiters())}static lockCorrector(e){const t=Date.now()-5e3,n=e,i=[];let r=0;for(;;){let c=n.keySync(r);if(c===null)break;i.push(c),r++}let s=!1;for(let c=0;c<i.length;c++){const h=i[c];if(h.includes(Ke)){let m=n.getItemSync(h);if(m!==null){let a=JSON.parse(m);(a.timeRefreshed===void 0&&a.timeAcquired<t||a.timeRefreshed!==void 0&&a.timeRefreshed<t)&&(n.removeItemSync(h),s=!0)}}}s&&L.notifyWaiters()}};Zt.waiters=void 0;var mn=Zt,pn="api.workos.com",It="workos_organization_id";async function fn(o,e={}){if(!o)throw new Yo;const{apiHostname:t=pn,https:n=!0,port:i,redirectUri:r=window.origin,devMode:s=location.hostname==="localhost"||location.hostname==="127.0.0.1",onBeforeAutoRefresh:c=()=>!document.hidden,onRedirectCallback:h=v=>{},onRefresh:m,onRefreshFailure:a}=e,l=o,u=r,d=`${n?"https":"http"}://${t}${i?`:${i}`:""}`,p=!s;let w="INITIAL";const k=()=>{switch(w){case"INITIAL":case"AUTHENTICATING":return!0;case"ERROR":return!1;case"AUTHENTICATED":const v=N.getItem(j.accessToken),P=N.getItem(j.expiresAt);if(!v||!P)return!0;const W=10*1e3;return P-W<Date.now()}};async function y(v={}){return _({...v,type:"sign-in"})}async function I(v={}){return _({...v,type:"sign-up"})}async function _({type:v,state:P,context:W,invitationToken:z,passwordResetToken:K}){const{codeVerifier:ne,codeChallenge:Z}=await an();window.sessionStorage.setItem(j.codeVerifier,ne);const ze=tn(d,{clientId:l,redirectUri:u,screenHint:v,context:W,codeChallenge:Z,codeChallengeMethod:"S256",invitationToken:z,passwordResetToken:K,state:P?JSON.stringify(P):void 0});window.location.assign(ze)}function f(){const v=N.getItem(j.user);return v||null}function C(){return N.getItem(j.accessToken)}async function V(){if(k())try{await oe()}catch(P){throw P instanceof Ve?new _t:P}const v=C();if(!v)throw new _t;return v}const E=()=>{setTimeout(()=>{k()&&c()?oe().catch(v=>{console.error(v)}).then(E):E()},1e3)};async function $(){if(w!=="INITIAL")return;const v=new URLSearchParams(window.location.search);if(sn(r,v))await de();else try{await oe(),E()}catch{}}async function de(){if(w!=="INITIAL")return;const v=new URL(window.location.href),P=v.searchParams.get("code"),W=v.searchParams.get("state"),z=W?JSON.parse(W):void 0;w="AUTHENTICATING";const K=window.sessionStorage.getItem(j.codeVerifier);if(P)if(K)try{const Z=await Bo({baseUrl:d,clientId:l,code:P,codeVerifier:K,useCookie:p});Z&&(w="AUTHENTICATED",E(),vt(Z,{devMode:s}),m&&m(Z),h({state:z,...Z}))}catch(Z){w="ERROR",console.error(Z)}else w="ERROR",console.error(`Couldn't exchange code.

An authorization_code was supplied for a login which did not originate at the application. This could happen for various reasons:

* This could have been an attempted Login CSRF attack. You were not affected.
* The developer may not have configured a Login Initiation endpoint.
* Was this an Impersonation attempt? Impersonation support is coming soon.`);const ne=new URL(window.location.toString());ne.search="",window.sessionStorage.removeItem(j.codeVerifier),window.history.replaceState({},"",ne)}const ve="WORKOS_REFRESH_SESSION";async function oe({organizationId:v}={}){const P=w,W=new mn;try{if(w="AUTHENTICATING",await W.acquireLock(ve)){if(v)sessionStorage.setItem(It,v);else{const K=C();K?v=st(K)?.org_id:v=sessionStorage.getItem(It)??void 0}const z=await Qo({baseUrl:d,clientId:l,refreshToken:nn({devMode:s}),organizationId:v,useCookie:p});w="AUTHENTICATED",vt(z,{devMode:s}),m&&m(z)}else console.warn("Couldn't acquire refresh lock"),w=P}catch(z){throw console.error(z),z instanceof Ve&&(bt({devMode:s}),P!=="INITIAL"&&a&&a({signIn:y})),w="ERROR",z}finally{await W.releaseLock(ve)}}function xe(){const v=rn(d);v&&(bt({devMode:s}),window.location.assign(v))}return await $(),{signIn:y,signUp:I,getUser:f,getAccessToken:V,signOut:xe}}let ee,Ee;function Ht(){return!Me(Ye)}function gn(o){Ee=o}function wn(){if(Ee)return Ee;if(!(!ee||!navigator.onLine))return ee.getAccessToken().catch(()=>{Ft()})}function Jt(o){window.history.replaceState({},document.title,o)}function Ft(){window.location=G}function Xt(o=D){if(top!==self){top.location=F;return}if(Re.disableLoginPrompt){ee.signIn({state:o});return}Jt(F);const e=new qe;e.on("click:login",()=>{ee.signIn({state:o})}),e.render()}function kn(o){const{clientId:e,rwClientId:t}=Ye;return t&&(o===x||localStorage.getItem(x))?t:e}async function yn(o,e){const t={redirectUri:location.origin+ue,onRedirectCallback:({user:n,state:i})=>{if(!n){Xt(i);return}i===F&&(i=D),i===x&&(i=D,localStorage.setItem(x,1)),Jt(i),o()}};return fn(kn(e),Pe(t,Ye.createClientOptions))}async function _n(o){const e=location.pathname;if(ee=await yn(o,e),e!==ue){if(e===G){Ee=null,ee.signOut();return}if(!await ee.getUser()){Xt(e);return}o()}}const vn=Object.freeze(Object.defineProperty({__proto__:null,auth:_n,getToken:wn,logout:Ft,setToken:gn,should:Ht},Symbol.toStringTag,{value:"Module"}));let ae;function Ae(){return At()?Eo:ae||(jt()&&(ae=Io),zt()&&(ae=Mo),Ht()&&(ae=vn),ae)}function bn(o){Ae().setToken(o)}function In(){return Ae().getToken()}function Sn(){Ae().logout()}St.reply("auth",{logout:Sn,setToken:bn,getToken:In});async function Pn(o){Ae().auth(o)}export{Pn as auth};
